Қайырлы күн, құрметті студенттер! Сізді зертханалық жұмысты талдау сессиясында көргеніме қуаныштымын. Зертханалық жұмыстың тақырыбы дерекқорды Amazon RDS дерекқор сервисіне көшіру болып табылады. Ендеше, бастайық. Зертханалық жұмысты талдауды AWS Management Console басты парақшасынан бастаймыз. Бірінші тапсырмаға көшейік. Мұнда дерекқор инстансын жасау үшін Amazon RDS сервисіне бару керек. Amazon RDS сервисінің негізгі парақшасына кірген соң, Create database батырмасын басамыз. Кіріс деректерді енгізу үшін арнайы парақшаға өтеміз. Әдіс ретінде Standard Create таңдау керек. Қозғалтқыш ретінде MariaDB таңдау керек. Templates орналасқан жерде Dev/Test опциясын таңдау керек. DB instance identifier - CafeDatabase. Төменде дерекқор пайдаланушысы туралы деректерді енгізу керек. Пайдаланушы admin деп аталады. Зертханалық жұмыстың тапсырмалары парақшасынан құпия сөзді көшіріп, осы өріске қоямыз. Инстанс түрі ретінде t3.micro таңдаңыз. Тапсырманың ішінде t2.micro таңдау керек екендігі көрсетілгенін атап өткім келеді, бірақ бұл топ қазір қол жетімсіз және ескірген болып саналады. Сондықтан, жаңа топты таңдаймыз, бұл t3 және инстанстың өлшемі micro. Келесі бөлім сақтаумен байланысты. Біздің жағдайда бұл General Purpose SSD (gp2) және өлшем ретінде 20 ГБ көрсету қажет. Келесі бөлім - Availability and Durability. Do not create a standby instance опциясын таңдауымыз керек. Яғни, Multi-AZ deployment опциясын қоспаймыз, өйткені бұл зертханалық жұмыстың аясында қажет емес. Connectivity өрісінде VPC ретінде Lab VPC көрсетілуі керек. Subnet group ретінде lab-db-subnet-group таңдаңыз, бұл дерекқор инстансы орналасатын private subnet group. Security group ретінде жасалған dbSG security тобын таңдаймыз және әдепкі қауіпсіздік тобынан құсбелгіні алып тастау қажет болады. Availability zone үшін us-east-1a таңдаңыз. Қосымша конфигурацияны өзгерту қажет емес, TCP 3306 порты арқылы қосыламыз. Monitoring бөлімінде Enable Enhanced monitoring опциясынан құсбелгісін алып тастаймыз, себебі бұл зертханалық жұмыстың аясында қажет емес және дерекқордың өзі әлдеқайда жылдам жасалады. Жақсы, парақшаның төменгі жағына жылжып, дерекқор инстансы үшін айына шамамен алынған шығынды көреміз. Инстансқа бөлек және 20 гигабайт сақтау орны бөлек төленеді. Жалпы алғанда, айына 15 доллардан аз болады. Жақсы, бәрін енгіздік, енді Create database батырмасын басу керек. Дерекқорлар тізімі бар парақшаға бағытталамыз. Дәл қазір біз жасаған жалғыз дерекқорды көре аласыз, Status - Creating. Оның толық жасалып, белсенді болуын күтудің қажеті жоқ. Келесі тапсырмаға көшуге болады. Келесі тапсырманың бөлігі ретінде Amazon EC2 сервисіне көшу керек. Сервистерді іздеу жолағын пайдалану керек, EC2 деп теруді бастау керек. Бірінші сілтеме - бізге қажет сілтеме. Әрі қарай, Amazon EC2 сервисі парақшасында сол жақ шарлау мәзірін пайдаланып, Instances опциясын таңдаңыз. Біз инстанстар тізімі бар парақшаға бағытталамыз. CafeServer деп аталатын жалғыз инстанс болады. Бұл қосымша, веб-сервер орнатылған және деректер базасы орналасқан EC2 сервері, біз оны бөлек сервиске ауыстырамыз. Мұнда біз жалпыға ортақ IP мекенжайын көшіріп, веб-бағдарламаға өту үшін веб-браузердегі жаңа қойындыға осы IP мекенжайын /cafe деп енгізуіміз керек. Келесі парақша ашылады. Біз қолданбаның функционалдығын тексеруіміз керек, сондықтан Menu қойындысына өтуіміз керек. Мұнда кез келген позиция үшін нөлден үлкен мөлшерді таңдап, төменгі жағындағы Submit order батырмасын басу керек. Біздің жағдайда біз 1 долларға 3 пончикке тапсырыс бердік және ол барлығы $3 болды. Бұл дұрыс. Енді тапсырыстар журналы парақшасын ашайық және біз 25 тапсырыс нөмірін көреміз. Бұл жерде де көрсетіледі. Бұл қолданбаның қазір дұрыс жұмыс істеп тұрғанын көрсетеді. Енді келесі тапсырмаға көшеміз және мұнда EC2 инстансына қосылуымыз керек. Ол үшін Session Manager сервисін қолданамыз. Ол Systems Manager сервисінде орналасқан. Біз сервистерді іздеу жолағына Systems Manager деп енгізуді бастаймыз, содан кейін сол жақтағы шарлау мәзірін пайдалана аламыз немесе бізге қажет сервистің атын енгізе бастаймыз, бұл Session Manager және ол Features бөлімінде пайда болады. Келесі әрекеттерді орындап, Session Manager сілтемесіне өтейік. Мұнда Session Manager сервисінің негізгі парақшасына өткенде, Start Session батырмасын басу керек. Біз CafeServer үшін қазіргі уақытта жалғыз опция болып табылатын Target Instances көреміз. Оны таңдап, Start Session батырмасын басу керек. Мұны басқаннан кейін веб-браузерде жаңа қойынды ашылады және Terminal терезесін көресіз. Мұнда bash shell ашу үшін бірінші команда ретінде bash деп енгізу керек. Әрі қарай, root пайдаланушы ретінде командаларды енгізуді бастау үшін sudo su командасын енгізу керек. Содан кейін root пайдаланушыдан EC2 пайдаланушысына ауысуымыз керек. Ол үшін su ec2-user командасын енгізіп, тексеру керек. Егер whoami командасын енгізсек, жауапта қазіргі уақытта пайдаланып жатқан пайдаланушыны көреміз. Егер EC2 User көрсетілсе, бәрі дұрыс. Әрі қарай жүрейік. Енді EC2 User негізгі папкасына ауысайық. Ол үшін cd командасын, яғни Change Directory, cd /home/ec2-user/ жолын енгізу керек. Егер pwd енгізсеңіз, ағымдағы директорий осы жерде көрсетіледі және сіз дұрыс жолда екеніңізді көресіз. Енді EC2 машинасында орнатылған дерекқорлардың күйін тексеруіміз керек. Ол үшін service mariadb status командасын енгізу керек. Сіз ауқымды хабарламаны көресіз және бұл хабарламада жасыл түспен active (running) көресіз, бұл дерекқордың қазір белсенді екенін көрсетеді. Сондай-ақ, mysql --version командасын енгізсеңіз, MariaDB MySQL қозғалтқышын пайдаланатынын көресіз. Енді дерекқорға қосылуымыз керек. Ол үшін дерекқор пайдаланушысының құпия сөзін алу керек. Бұл деректерді Parameter store-да сақтаймыз. AWS Management Console-дегі сервисті іздеу жолағына Parameter store енгізейік, Features бөлімінде қажетті сілтемені көреміз және оны басамыз. 7 параметрді көресіз, әрқайсысы белгілі бір ақпаратқа жауапты. Бізді /cafe/dbPassword қызықтырады. Осы параметрді ашайық және value мәнінде root дерекқор пайдаланушысының құпия сөзін көресіз. Оны көшіріп алып, EC2 инстансына қосылатын сессияға оралайық. Мұнда дерекқорға қосылу үшін mysql -u root -p командасын енгізу керек. Enter басқан кезде, құпия сөз сұралады. Көшірілген құпия сөзді қою керек. Егер бәрін дұрыс орындасаңыз, MariaDB дерекқор промпты ашылады және мұнда командаларды енгізуге болады. Келесі командаларды енгізейік. Ең алдымен, show databases осы дерекқордағы дерекқорлар тізімін көресіз, сонымен қатар ішінде бізді қызықтыратын cafe_db дерекқоры бар. Әрі қарай, осы дерекқордағы кестелермен жұмыс істей алатындай use cafe_db командасын енгізуіміз керек. Бізге қажетті дерекқорды таңдап алғаннан кейін, show tables командасын енгізе аламыз және сол деректер қорындағы барлық кестелерді көреміз. Бізде 4 кесте бар. Енді select all from order командасын енгізейік. Сіз осы қосымша арқылы жасалған барлық тапсырыстарды көресіз. Бар болғаны 25 тапсырыс бар, ең соңғысы - біз бірге жасаған тапсырыс. Біз, сондай-ақ, select all from order item сұрауын енгізе аламыз және әрбір тапсырыс үшін қандай өнімдердің қандай мөлшерде және қандай сомаға таңдалғанын көресіз. Жақсы, біздің дерекқор жұмыс істейді. Барлық деректер орнында. Енді дерекқордың дампын жасау үшін mysqldump командасын енгізе аламыз. Барлық деректер CafeDbDump.sql файлына тасымалданады. Enter басқаннан кейін, құпия сөзді енгізу сұралады және қате болмаса, бұл дерекқор дампының сәтті жасалғанын білдіреді. Енді файлдың шынымен пайда болғанын тексерейік. ls командасын енгізейік, сонда CafeDbDump.sql файлы пайда болғанын көресіз. Оның мазмұнына қарасақ, алдымен сәйкес құрылымның кестелерін құру командалары іске қосылғанын көресіз, содан кейін деректер енгізілген жерде insert сұрауларын көресіз. Жақсы, келесі тапсырмаға көшеміз. Мұнда дерекқор сәтті жасалғанына көз жеткізуіміз керек. Ол үшін Amazon RDS сервисіне өтіңіз. Біз күйдің Available екеніне көз жеткізуіміз керек, егер солай болса, зертханалық жұмыстың парақшасына өтеміз және мұнда сұрақтар бар парақшаға өтуіміз керек. Ол үшін Details батырмасын басыңыз, ашылмалы тізімде Show батырмасын басыңыз және қалқымалы терезеде Access the multiple choice questions сілтемесін басу керек. Сұрақтар парақшасында барлығы 4 сұрақты көресіз, олардың барлығына қазір жауап беруіміз керек. Бірінші сұрақ: Amazon RDS дерекқор инстансы қайда іске қосылды? Сіз дұрыс және most specific барынша нақты, яғни мүмкіндігінше егжей-тегжейлі опцияларды таңдауыңыз керек екенін ескеріңіз. Яғни, мысалы, дерекқор инстансы AWS ішінде орналасқан опция дұрыс, бірақ жеткілікті түрде егжей-тегжейлі емес. Жарайды, қандай жауап нұсқалары бар екенін көрейік. Бірінші нұсқада оның аймақтық деңгейде екендігі айтылады. Тағы бір нұсқа - ол availability zone деңгейінде, сәл дәлірек, бірақ оны тексеру керек. Үшінші нұсқа - оның edge location орналасқанын айтады және соңғы опция - барлық опциялар дұрыс. Енді дерекқорлар тізімі бар парақшаға оралайық және Region and AZ бағанына қарайық, біздің дерекқор us-east-1a availability zone-ға жататынын көреміз. Бұл дұрыс және мүмкіндігінше егжей-тегжейлі болғандықтан, екінші жауап дұрыс екенін көрсетеді. Енді екінші сұрақты қарастырайық. Дерекқор инстансында тіркелген жалпы IP мекенжайы бар ма? Дерекқор мәліметтері парақшасына оралайық және онда қандай ақпарат бар екенін көрейік. Бізде Endpoint және белгілі бір порт бар екенін көреміз. Endpoint жалпыға ортақ IP мекенжайы емес және Endpoint болуы бұл дерекқорға Интернеттен кіруге болатынын білдірмейді. Сондықтан бұл сұраққа Жоқ деп жауап береміз. Үшінші сұрақ келесідей. RDS инстансы орналасқан subnet үшін Name tag мәнін көрсетіңіз. Дерекқор мәліметтері парақшасында көрсетілген ақпаратқа назар аудару керек, сонымен қатар VPC-де қандай subnets бар екенін бөлек қарау керек. Жауап нұсқаларын көріп отырғанымыздай, Public subnet, Private subnet 1 және Private subnet 2 бар. Бұл біздің VPC-дегі барлық қолжетімді subnets. Дерекқор туралы мәліметтер парақшасын ашайық. Біз оның us-east-1a availability zone-да орналасқанын көреміз. Сондай-ақ, екі subnets бар тізім көрсетілгенін көреміз. Осы subnet-терді subnets тізімінен табайық. Ол үшін VPC сервисін ашу керек. Сол жақ шарлау мәзірінде Subnets сілтемесіне өтіп, бізді қызықтыратын Subnets-терді табыңыз. Name tag Private subnet 1 және Private subnet 2 деп толтырылғанын көреміз. Біздің дерекқор инстансы қай subnet-те орналасқанын қалай түсінеміз? Жауап қарапайым. Әрбір subnet қай availability zone-да орналасқанын тексеру қажет. Ол үшін осы кестені оңға айналдыру керек және Private subnet 1 - availability zone us-east-1a және Private subnet 2 - availability zone us-east-1b көреміз. Осылайша, дұрыс жауап - Private subnet 1. Төртінші сұрақты қарастырайық. Мұнда RDS инстансына қанша security group rules тіркелгені сұралады. Бұл әрекетті орындау үшін, RDS инстансының мәліметтері бар парақшаға оралыңыз және сәл төмен айналдыру керек. Security group rules деген жеке бөлім бар. Бізде бір rule бар екенін көреміз. Ол бүкіл Интернетке outbound трафикке мүмкіндік береді. Жақсы. Бұл сұраққа осылай жауап береміз. Жауаптың бірінші нұсқасы – 1 мәні. Біз келесі тапсырмаға көшеміз және мұнда EC2 инстансынан RDS инстансына қосылуымыз керек. Ең алдымен, RDS инстансының endpoint көшіріп, терминал парақшасына оралуымыз керек. Мұнда сәйкес команданы енгізу керек. Пайдаланушы admin және құпия сөз - RDS инстансын жасау кезінде ең басында көрсеткен құпия сөз екенін ескеріңіз. Enter басқаннан кейін, парольді енгізу сұралады. Көшірілген құпия сөзді қойып, не болатынын көресіз. Команда осылай ұзақ тұрады. Біраз уақыттан кейін күту уақыты қатесі пайда болады. Бұл кейбір мәселелердің бар екенін көрсетеді және мәселе пайдаланушыда немесе құпия сөзде емес екенін көрсетеді. Мәселе қай жерде болуы мүмкін екенін ойлау керек. Бірінші ойға келетін нәрсе - олар бір VPC-де, бірақ әртүрлі subnets-те орналасқанын ескере отырып, EC2 инстансынан RDS инстансына желі арқылы рұқсат шынымен бар ма. EC2 инстансы public subnet-те, ал RDS инстансы private subnet-те орналасқан. Осылайша, RDS инстансының security тобын тексерейік. Security тобына сілтемені Connectivity and security қойындысынан және сәйкес VPC security groups өрісінен таба аласыз. Кірген бойда Inbound rules қойындысында кіріс трафикке рұқсат беретін бірде-бір ереже орнатылмағанын көреміз. Оны түзетіп, Edit inbound rules батырмасын басыңыз. Мұнда Add rule батырмасын басып, Type өрісіне MYSQL/Aurora протоколын енгізу керек, сонда порт автоматты түрде енгізіледі. Source ретінде Custom көрсетіңіз. Біз бүкіл Интернетті көрсете алмаймыз, өйткені бұл қауіпсіздік тұрғысынан қауіпті және дұрыс емес. Сондықтан біз security тобына кіруді қамтамасыз ете аламыз және бұл security тобы EC2 инстансына байланысты. Осылайша, EC2 инстансына оралуымыз керек, оны таңдап, Security қойындысында ол байланыстырылған security тобын көреміз. Толығымен ID есте сақтаудың қажеті жоқ, тек соңғы екі таңбаны есте сақтаңыз жеткілікті, бұл c5. Біз дерекқордың security тобын өңдеу парақшасына қайта ораламыз және Source таңдаған бойда келесі өріс белсендіріледі, SG енгізуді бастаймыз және осы AWS аккаунтында қолжетімді security топтарының тізімі көрсетіледі. Біз c5-ке аяқталатынын таңдауымыз керек. Біздің жағдайда басқа ID болады, бірақ идеясы осындай. Сондай-ақ, бұл best practice және жеке менің ұсынысым ретінде әрқашан қосымша Description өрісін толтыру керек, өйткені бұл жазбаларды бір рет жасайсыз және біраз уақыттан кейін қайтып келген кезде мұны не үшін жасағаныңызды еске түсіру мүмкін емес. Ал кішігірім түсініктеме болған кезде, сіз оны жазған-жазбағаныңызды өте оңай еске түсіре аласыз, оның үстіне бұл мәтіннің мазмұнынан оның не үшін жасалғанын түсінуге болады. EC2 SG деп енгізейік, содан кейін Save rules батырмасын басыңыз. Жақсы, енді терминал терезесіне оралайық және келесі команданы енгізіп көріңіз nmap -Pn және RDS инстансының endpoint-ы. Портты тексеру орындалады және біз TCP протоколы бойынша 3306 TCP порты ашық екенін ең соңында үлкен хабарламада көреміз. Бұл желі арқылы қажетті құқықтарды бергенімізді білдіреді, енді алдыңғы команданы пайдаланып RDS инстансына қосылуға тырысайық. Егер бәрін дұрыс жасасақ, біз қосыла аламыз. Енді осы RDS инстансында қандай дерекқорлар бар екенін көрейік. Ол үшін show databases командасын енгізу керек. Мұнда 5 дерекқор бар екенін және cafe_db дерекқоры жоқ екенін көріп тұрсыз. Барлығы дұрыс, солай болуы керек, бұл дерекқор бос болғандықтан, қазір ештеңе жоқ. Енді осы промптан шығып, bash shell дерекқордың дампын импорттау командасын енгізейік. Мұны жасағаннан кейін құпия сөзді енгізу сұралады, оны енгіземіз және қате болмаса, бұл дамптың RDS инстансына сәтті импортталғанын көрсетеді. Енді инстансымызға қайта қосылуға тырысайық және show databases командасын енгізейік. Біздің cafeDB қолданба дерекқорымыз пайда болғанын көреміз, енді оны таңдап, қандай кестелер бар екенін көрейік. Барлық қажетті кестелердің бар екенін көреміз. Сонымен қатар Order кестесінің мазмұнын қарастырайық, бізде 25 жазба бар екенін көреміз және соңғы жазба біз бірге жасаған тапсырыс. Жақсы. Енді келесі тапсырмаға көшеміз. Бұл тапсырмада біз параметрлерімізге өзгертулер енгізуіміз керек, себебі қолданба осы параметрлерді пайдаланып жұмыс істейді. Мұнда дерекқорға қатысты параметрлер бар, олар dbPassword және dbUrl. Оларды сәйкес мәндерге жаңартайық. Ең алдымен, dbPassword параметріне өзгертулер енгіземіз, оны ашу керек. Жоғарғы оң жақтағы Edit батырмасын басып, жаңа мәнді енгізіңіз. Содан кейін парақшаның төменгі жағындағы Save changes батырмасын басу керек. Мұны орындағаннан кейін, dbUrl параметрімен сол әрекеттерді орындау керек және мұнда RDS инстансының endpoint енгізу керек. Өзгертулерді сақтаймыз, EC2 инстансына қосылыммен терминалға ораламыз және осы жерде эксперименттің тазалығы үшін жергілікті дерекқорды тоқтатамыз. Ол үшін келесі команданы енгізіп, сәйкес жауапты қараңыз. Енді қосымшаны ашып көрейік. Сілтеме өзгеріссіз қалады, өйткені біз веб- қосымшаны және веб-серверді өзгерткен жоқпыз. Menu қойындысын ашқанда, қатені көреміз. Қажетті өзгерістерді қайда жасамағанымыз туралы ойланайық. Видеоны тоқтатып, жауап беріп көріңіз. Жақсы, дұрыс жауап бере алдыңыз деп үміттенемін. Дұрыс жауап - бізде дерекқорларға қатысты басқа параметр бар, ол dbUser. Естеріңізде болса, жергілікті дерекқорда мастер пайдаланушы root болып табылады және RDS инстансы үшін біз admin деп аталатын мастер пайдаланушыны жасадық. Сондықтан тиісті өзгерістерді қазірден енгізуіміз керек. Осы әрекетті орындағаннан кейін Menu парақшасына оралып, оны жаңартайық. Біз өнімдердің тізімін көреміз және енді веб-қосымшаның жұмысын тексеруіміз керек. Ыстық шоколадтың бір мөлшерін таңдап, тапсырыс қалдырайық. Біз тапсырысымыз бар парақшаға бағытталамыз, бұл тапсырыс нөмірі 26. Барлық қажетті деректер дұрыс көрсетілді. Енді тапсырыстар журналы парақшасын ашайық. Біз бірге жасаған 25 және 26 тапсырыстарының екеуі де дұрыс көрсетілгенін көреміз. Жақсы, біз зертханалық жұмыстағы барлық тапсырмаларды орындадық. Осы жерге жеткен болсаңыз, құттықтаймын. Енді автоматты бағалауды іске қосамыз. Ол үшін зертханалық жұмыс парақшасына қайта оралып, Submit батырмасын басу керек. Мұнда автоматты бағалауды бастағымыз келетінін растауымыз керек және біраз уақыттан кейін бұл екі минутқа созылуы мүмкін, барлық скрипттер жұмыс істеп бітеді және оң жақта бағаңызды көресіз. Егер ең көп ұпай жинасаңыз, құттықтаймын, сіз барлығын дұрыс орындадыңыз. Бір жерде ұпайыңыз жеткіліксіз болса, қай тапсырмада екенін қараңыз, бұл тапсырмаға оралып, оны қайта орындап көріңіз. Жақсы, осымен зертханалық жұмыс аяқталды. Барлық жүйелерден дұрыс шығу өте маңызды. Бұл, ең алдымен, AWS Management Console-ге қатысты. Жоғарғы оң жақтағы пайдаланушы атын, содан кейін Sign out батырмасын басу керек. Зертханалық жұмысты да дұрыс аяқтауымыз керек. Бұл әрекетті орындау үшін, End lab батырмасын басыңыз, зертханалық жұмысты аяқтағанымызды растаңыз және AWS Academy парақшасын жабуға болатындығы туралы хабарды күту керек. Жақсы, құттықтаймын, біз зертханалық жұмысты талдауды аяқтадық. Сіз AWS сервистерін жақсырақ түсіндіңіз деп үміттенемін. Назарларыңызға рахмет. Келесі белсенділіктерде кездескенше.