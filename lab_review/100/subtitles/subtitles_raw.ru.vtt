WEBVTT

00:00:00.000 --> 00:00:03.240
Добрый день, уважаемые студенты!

00:00:03.240 --> 00:00:07.200
Я рад вас всех видеть на сессии разбора лабораторной

00:00:07.200 --> 00:00:08.200
работы.

00:00:08.200 --> 00:00:11.980
Тема сегодняшней лабораторной работы – это миграция

00:00:11.980 --> 00:00:16.200
базы данных в сервис баз данных Amazon RDS.

00:00:16.200 --> 00:00:17.280
Итак, давайте начнем.

00:00:17.280 --> 00:00:24.040
Начинаем мы разбор лабораторной работы с главной страницы

00:00:24.040 --> 00:00:26.040
AWS Management Console.

00:00:26.040 --> 00:00:27.640
Переходим к первому заданию.

00:00:27.640 --> 00:00:32.400
Здесь нам необходимо перейти в сервис Amazon RDS для того,

00:00:32.400 --> 00:00:35.360
чтобы создать instance базы данных.

00:00:35.360 --> 00:00:37.680
Как только мы оказываемся на главной странице сервиса

00:00:37.680 --> 00:00:41.540
Amazon RDS, нам необходимо нажать на кнопку Create database.

00:00:41.540 --> 00:00:45.640
Мы перейдем на специальную страницу для ввода вкладных

00:00:45.640 --> 00:00:46.640
данных.

00:00:46.640 --> 00:00:50.840
Здесь нам необходимо выбрать метод как Standard Create.

00:00:50.840 --> 00:00:55.960
Далее как движок необходимо выбрать MariaDB.

00:00:55.960 --> 00:01:00.480
Там где темплейты, необходимо выбрать опцию DevTest.

00:01:00.480 --> 00:01:06.160
DB instance identifier у нас будет cafe database.

00:01:06.160 --> 00:01:10.280
Чуть ниже необходимо ввести данные об пользователе

00:01:10.280 --> 00:01:11.280
баз данных.

00:01:11.280 --> 00:01:16.160
Пользователь будет называться admin.

00:01:16.160 --> 00:01:21.880
Пароль мы копируем и вставляем со страницы задания лабораторной

00:01:21.880 --> 00:01:22.880
работы.

00:01:22.880 --> 00:01:28.400
Как тип инстенса выбираем T3 micro.

00:01:28.400 --> 00:01:31.760
Здесь хотел бы отметить, в рамках задания указано,

00:01:31.760 --> 00:01:35.600
что необходимо выбрать T2 micro, но это семейство сейчас

00:01:35.600 --> 00:01:38.560
недоступно и оно считается устаревшим.

00:01:38.560 --> 00:01:45.120
Поэтому мы выбираем более свежее поколение, это T3

00:01:45.120 --> 00:01:52.080
и тот же самый размер инстенса micro.

00:01:52.080 --> 00:01:56.680
Следующая секция это секция связанная с хранилищем.

00:01:56.680 --> 00:02:01.840
В нашем случае это General Purpose SSD GP2 и как размер необходимо

00:02:01.840 --> 00:02:05.720
будет указать 20 гигабайтов.

00:02:05.720 --> 00:02:08.560
Следующая секция availability and durability.

00:02:08.560 --> 00:02:11.880
Нам необходимо выбрать опцию Do not create a standby instance.

00:02:11.880 --> 00:02:15.440
То есть мы не будем включать опцию Multi-AZ deployment, так

00:02:15.440 --> 00:02:20.520
как в рамках лабораторной работы это не нужно.

00:02:20.520 --> 00:02:25.400
Там где connectivity необходимо указать как VPC, LabVPC.

00:02:25.400 --> 00:02:29.520
Как subnet group выбираем LabDB subnet group это private subnet

00:02:29.520 --> 00:02:35.800
group, там где будет располагаться инстанц-пазы данных.

00:02:35.800 --> 00:02:38.720
Как security группа мы выбираем созданную security группу

00:02:38.720 --> 00:02:44.360
dbsg и здесь необходимо будет убрать галочку с дефолтовой

00:02:44.360 --> 00:02:45.960
security группы.

00:02:45.960 --> 00:02:51.960
Как availability зону выбираем US East 1A.

00:02:51.960 --> 00:02:54.560
Где дополнительная конфигурация ничего менять не нужно

00:02:54.560 --> 00:02:58.400
мы подключаемся по TCP порту 3306.

00:02:58.400 --> 00:03:02.960
В секции monitoring необходимо будет убрать галочку enable

00:03:02.960 --> 00:03:06.200
enhanced monitoring, так как это не нужно в рамках лабораторной

00:03:06.200 --> 00:03:10.800
работы и когда мы убираем галочку сама база данных

00:03:10.800 --> 00:03:12.400
будет создаваться намного быстрее.

00:03:12.400 --> 00:03:17.600
Отлично, мы прокручиваем до конца страницы видим

00:03:17.600 --> 00:03:21.440
примерную стоимость в месяц инстанца базы данных.

00:03:21.440 --> 00:03:25.560
Здесь идет разбивка отдельно оплачивается instance и отдельно

00:03:25.560 --> 00:03:29.000
оплачивается 20 гигабайтов хранилища.

00:03:29.000 --> 00:03:33.880
В итоге это все выходит в месяц меньше 15 долларов.

00:03:33.880 --> 00:03:37.680
Ок, мы все ввели, нам необходимо сейчас нажать на кнопку

00:03:37.680 --> 00:03:40.360
create database.

00:03:40.360 --> 00:03:46.960
Нас направляет на страницу со списком баз данных.

00:03:46.960 --> 00:03:51.000
Сейчас вы видите единственная база данных которую мы

00:03:51.000 --> 00:03:53.960
сейчас создали status creating.

00:03:53.960 --> 00:03:57.840
Нам нет необходимости ждать когда она полностью

00:03:57.840 --> 00:03:59.640
создастся и будет активна.

00:03:59.640 --> 00:04:01.680
Мы можем переходить к следующему заданию.

00:04:01.680 --> 00:04:05.000
В рамках следующего задания нам необходимо перейти

00:04:05.000 --> 00:04:08.320
на сервис амазон и ситу.

00:04:08.320 --> 00:04:11.000
Нам необходимо воспользоваться строковой поиска сервисов,

00:04:11.000 --> 00:04:12.560
начать вводить и ситу.

00:04:12.560 --> 00:04:15.640
Первая ссылка это та которая нам нужна.

00:04:15.640 --> 00:04:21.040
Далее уже на странице сервиса амазон и ситу воспользуемся

00:04:21.040 --> 00:04:25.040
левым навигационным меню и выберем опцию instances.

00:04:25.040 --> 00:04:27.760
Нас направит на страницу со списком инстанцев.

00:04:27.760 --> 00:04:31.280
Там будет единственный instance с названием кафе

00:04:31.280 --> 00:04:32.280
сервер.

00:04:32.280 --> 00:04:36.760
Это тот и ситу сервер на котором установлено приложение

00:04:36.760 --> 00:04:41.760
веб сервер и находится база данных, которые мы

00:04:41.760 --> 00:04:43.960
будем переносить на отдельный сервис.

00:04:43.960 --> 00:04:49.240
Здесь нам необходимо скопировать публичный IP адрес и в новой

00:04:49.240 --> 00:04:54.480
вкладке в веб браузере ввести этот IP адрес слеш кафе

00:04:54.480 --> 00:04:57.320
чтобы перейти на веб приложение.

00:04:57.320 --> 00:04:59.360
Откроется следующая страница.

00:04:59.360 --> 00:05:03.080
Нам необходимо проверить работоспособность приложения,

00:05:03.080 --> 00:05:07.080
поэтому необходимо перейти на вкладку меню.

00:05:07.080 --> 00:05:11.760
Здесь необходимо выбрать для любой позиции количество

00:05:11.760 --> 00:05:16.480
больше нуля и в самом низу нажать на кнопку submit order.

00:05:16.480 --> 00:05:23.200
В нашем случае мы заказали 3 пончика по цене 1 доллар

00:05:23.200 --> 00:05:24.880
и всего вышло 3 доллара.

00:05:24.880 --> 00:05:27.120
Все верно.

00:05:27.120 --> 00:05:32.600
Давайте теперь откроем страницу со истории заказов и мы

00:05:32.600 --> 00:05:35.360
должны увидеть наш заказ под номером 25.

00:05:35.360 --> 00:05:37.620
Он здесь также отображается.

00:05:37.620 --> 00:05:42.960
Это говорит о том, что приложение сейчас корректно работает.

00:05:42.960 --> 00:05:46.200
Мы переходим к следующему заданию и здесь нам необходимо

00:05:46.200 --> 00:05:48.640
подключиться к нашему EC2 инстанцу.

00:05:48.640 --> 00:05:52.480
Для этого воспользуемся сервисом Session Manager.

00:05:52.480 --> 00:05:56.560
Оно находится в сервисе Systems Manager.

00:05:56.560 --> 00:05:58.760
Мы можем в строке поиска сервисов начать вводить

00:05:58.760 --> 00:06:04.120
Systems Manager и дальше воспользоваться навигационным меню слева,

00:06:04.120 --> 00:06:07.880
либо начать вводить имя необходимого нам сервиса,

00:06:07.880 --> 00:06:13.960
это Sessions Manager, и он у нас отобразится в секции features.

00:06:13.960 --> 00:06:16.520
Давайте сделаем следующим образом и перейдем по ссылке

00:06:16.520 --> 00:06:18.880
Session Manager.

00:06:18.880 --> 00:06:23.480
Здесь, когда мы перейдем на главную страницу сервиса

00:06:23.480 --> 00:06:27.460
Session Manager, необходимо нажать на кнопку Start Session.

00:06:27.460 --> 00:06:30.360
Мы увидим Target Instance на текущий момент.

00:06:30.360 --> 00:06:32.600
Это один-единственный вариант кафе Server.

00:06:32.600 --> 00:06:36.280
Необходимо его выбрать и нажать на кнопку Start Session.

00:06:36.280 --> 00:06:39.600
Как только вы это нажимаете, открывается новая вкладка

00:06:39.600 --> 00:06:44.000
в веб-браузере и вы видите окно терминала.

00:06:44.000 --> 00:06:47.480
Здесь необходимо первой командой ввести bash для

00:06:47.480 --> 00:06:50.080
того, чтобы открылся bash shell.

00:06:50.080 --> 00:06:58.320
Далее необходимо вбить команду sudo su, чтобы начать

00:06:58.320 --> 00:07:01.640
вводить команды в роли root пользователя.

00:07:01.640 --> 00:07:05.880
Далее нам необходимо от root пользователя уже перейти

00:07:05.880 --> 00:07:08.240
к пользователю EC2 User.

00:07:08.240 --> 00:07:15.400
Для этого вводим команду su EC2 User и необходимо сделать

00:07:15.400 --> 00:07:16.400
проверку.

00:07:16.400 --> 00:07:21.160
Если мы введем команду whoami, в ответе увидим пользователя,

00:07:21.160 --> 00:07:22.680
под которым мы сейчас сидим.

00:07:22.680 --> 00:07:26.200
Если отображается EC2 User, значит все верно.

00:07:26.200 --> 00:07:27.260
Двигаемся дальше.

00:07:27.260 --> 00:07:31.240
Сейчас нам необходимо перейти на домашнюю папку пользователя

00:07:31.240 --> 00:07:32.240
EC2 User.

00:07:32.240 --> 00:07:38.920
Для этого необходимо ввести команду cd, то есть Change Directory,

00:07:38.920 --> 00:07:41.840
путь home EC2 User.

00:07:41.840 --> 00:07:48.280
Если вы ведете pwd, то здесь отобразится текущая директория

00:07:48.280 --> 00:07:56.720
и вы увидите, что вы находитесь по верному пути.

00:07:56.720 --> 00:08:01.440
Теперь нам необходимо проверить состояние баз данных, установленной

00:08:01.440 --> 00:08:03.040
на EC2 машине.

00:08:03.040 --> 00:08:06.800
Для этого необходимо ввести команду service maria-db status.

00:08:06.800 --> 00:08:15.480
Вы увидите большое сообщение и в этом сообщении увидите

00:08:15.480 --> 00:08:19.800
зеленым active running, что говорит о том, что база данных сейчас

00:08:19.800 --> 00:08:20.880
активна.

00:08:20.880 --> 00:08:29.080
Если вы введете также команду mysql--version, вы увидите, что

00:08:29.080 --> 00:08:37.400
моя директория DB использует директор mysql.

00:08:37.400 --> 00:08:39.920
Теперь нам необходимо подключиться к базе данных.

00:08:39.920 --> 00:08:45.120
Для этого нужно добраться до пароля пользователя

00:08:45.120 --> 00:08:46.120
баз данных.

00:08:46.120 --> 00:08:50.280
Эти данные у нас хранятся в параметр store.

00:08:50.280 --> 00:08:54.480
Давайте в строке поиска сервисов в AWS Management Console

00:08:54.480 --> 00:08:57.920
введем параметр store, в секции features увидим необходимую

00:08:57.920 --> 00:09:00.280
нам ссылку и перейдем по нему.

00:09:00.280 --> 00:09:05.320
Вы увидите 7 созданных параметров, каждый отвечает за что-то

00:09:05.320 --> 00:09:06.320
определенное.

00:09:06.320 --> 00:09:09.000
Нас интересует кафе DB password.

00:09:09.000 --> 00:09:12.880
Давайте откроем этот параметр и в значении value вы увидите

00:09:12.880 --> 00:09:17.000
пароль от root пользователя баз данных.

00:09:17.000 --> 00:09:25.600
Давайте ее скопируем и вернемся обратно к сессии подключения

00:09:25.600 --> 00:09:27.040
к EC2 инстанцу.

00:09:27.040 --> 00:09:30.720
Здесь нам необходимо ввести команду подключения к базе

00:09:30.720 --> 00:09:34.200
данных это mysql-u root-p.

00:09:34.200 --> 00:09:37.100
Как только вы нажмете enter у вас запросит пароль.

00:09:37.100 --> 00:09:40.240
Вам необходимо будет вставить скопированный пароль.

00:09:40.240 --> 00:09:45.200
Если вы все сделали верно откроется промт баз данных

00:09:45.200 --> 00:09:50.000
MariaDB и здесь вы уже можете вводить команды.

00:09:50.000 --> 00:09:51.680
Давайте введем следующие команды.

00:09:51.680 --> 00:09:55.840
Первым делом show databases вы увидите список баз данных

00:09:55.840 --> 00:09:59.960
в этой базе данных и также внутри находится интересующая

00:09:59.960 --> 00:10:02.640
нас база данных кафе DB.

00:10:02.640 --> 00:10:05.780
Далее нам необходимо ввести команду use-cafedeb для того

00:10:05.780 --> 00:10:08.840
чтобы мы могли работать с таблицами в этой базе

00:10:08.840 --> 00:10:10.720
данных.

00:10:10.720 --> 00:10:14.040
Как только мы выбрали нужную нам базу данных мы можем

00:10:14.040 --> 00:10:17.020
ввести команду show tables и увидим все таблицы которые

00:10:17.020 --> 00:10:18.400
есть в этой базе данных.

00:10:18.400 --> 00:10:20.080
У нас 4 таблицы.

00:10:20.080 --> 00:10:25.160
Давайте теперь введем команду select all from order.

00:10:25.160 --> 00:10:30.240
Вы увидите все заказы сделанные через это приложение.

00:10:30.240 --> 00:10:33.720
Всего 25 заказов и самый последний это тот заказ

00:10:33.720 --> 00:10:35.240
который мы сделали вместе с вами.

00:10:35.240 --> 00:10:43.180
Также мы можем ввести запрос select all from order item и вы увидите

00:10:43.180 --> 00:10:47.780
для каждого заказа какие товары в каком количестве

00:10:47.780 --> 00:10:49.600
и на какую сумму были выбраны.

00:10:49.600 --> 00:10:55.960
Отлично у нас база данных работает.

00:10:55.960 --> 00:10:57.120
Все данные на месте.

00:10:57.120 --> 00:11:03.720
Теперь мы можем ввести команду mysqldump для того чтобы создать

00:11:03.720 --> 00:11:06.760
дамп базы данных.

00:11:06.760 --> 00:11:14.160
Все данные они перенесутся в файл cafedebdump.sql.

00:11:14.160 --> 00:11:17.360
Как только вы нажмете на enter вас также запросят ввести

00:11:17.360 --> 00:11:21.240
пароль и в случае если вы не увидите ошибки это говорит

00:11:21.240 --> 00:11:24.100
о том что дамп базы данных был успешно создан.

00:11:24.100 --> 00:11:25.960
Давайте теперь проверим что файл действительно

00:11:25.960 --> 00:11:26.960
появился.

00:11:26.960 --> 00:11:33.280
Введем команду ls и вы увидите что файл cafedebdump.sql появился.

00:11:33.280 --> 00:11:38.280
Если мы посмотрим его содержание то вы увидите вначале

00:11:38.280 --> 00:11:42.000
запускаются команды создания таблиц соответствующей

00:11:42.000 --> 00:11:51.080
структуры и после уже увидите запросы insert где вводятся

00:11:51.080 --> 00:11:52.080
данные.

00:11:52.080 --> 00:12:00.120
Отлично мы переходим к следующему заданию.

00:12:00.120 --> 00:12:03.480
Здесь нам необходимо будет убедиться в том что база

00:12:03.480 --> 00:12:05.120
данных успешно создалась.

00:12:05.120 --> 00:12:08.320
Для этого переходим к сервису amazon rds.

00:12:08.320 --> 00:12:12.240
Необходимо убедиться что статус available если это

00:12:12.240 --> 00:12:16.840
так мы переходим на страницу с лабораторной работы и

00:12:16.840 --> 00:12:19.840
здесь необходимо добраться до страницы с вопросами.

00:12:19.840 --> 00:12:24.800
Для этого нажимаем на кнопку details в выпадающем списке

00:12:24.800 --> 00:12:29.600
нажимаем на кнопку show и в всплывающем окне необходимо

00:12:29.600 --> 00:12:35.580
будет нажать на ссылку access the multiple choice questions.

00:12:35.580 --> 00:12:38.360
На странице с вопросами вы всего увидите четыре

00:12:38.360 --> 00:12:42.280
вопроса на все из них нам необходимо сейчас ответить.

00:12:42.280 --> 00:12:48.200
Первый вопрос у нас спрашивает где запущен instance базы данных

00:12:48.200 --> 00:12:50.400
amazon rds.

00:12:50.400 --> 00:12:53.120
Следует обратить внимание что необходимо выбрать

00:12:53.120 --> 00:12:56.960
опции которые являются верны и most specific то есть

00:12:56.960 --> 00:12:58.280
максимально детализированы.

00:12:58.280 --> 00:13:07.360
То есть вариант например что instance базы данных находится

00:13:07.360 --> 00:13:11.280
в AWS он верный но недостаточно детализирован.

00:13:11.280 --> 00:13:14.040
Ок давайте посмотрим какие варианты ответов есть.

00:13:14.040 --> 00:13:16.120
Первый вариант утверждает что он находится на уровне

00:13:16.120 --> 00:13:17.280
региона.

00:13:17.280 --> 00:13:19.960
Другой вариант что он на уровне availability зоны чуть

00:13:19.960 --> 00:13:22.400
точнее но нужно проверить так ли это.

00:13:22.400 --> 00:13:24.800
Третий вариант говорит о том что находится на edge

00:13:24.800 --> 00:13:29.400
location и последний вариант все варианты верны.

00:13:29.400 --> 00:13:33.120
Давайте теперь вернемся на страницу со списком баз

00:13:33.120 --> 00:13:37.840
данных и посмотрим на столбец region and az мы видим что наша

00:13:37.840 --> 00:13:43.000
база данных относится к availability зоне us east 1a.

00:13:43.000 --> 00:13:46.640
Это говорит о том что правильным ответом является второй

00:13:46.640 --> 00:13:50.000
так как он верный и максимально детализирован.

00:13:50.000 --> 00:13:52.680
Давайте теперь посмотрим на второй вопрос.

00:13:52.680 --> 00:13:59.440
Здесь у нас спрашивают есть ли у instance баз данных

00:13:59.440 --> 00:14:02.000
привязанный публично ip адрес.

00:14:02.000 --> 00:14:05.920
Давайте вернемся на страницу с деталями баз данных и

00:14:05.920 --> 00:14:08.480
посмотрим какая же информация здесь есть.

00:14:08.480 --> 00:14:11.960
Мы видим что у нас есть endpoint и определенный порт.

00:14:11.960 --> 00:14:15.760
Endpoint не является публичным ip адресом и наличие endpoint

00:14:15.760 --> 00:14:18.980
не говорит о том что извне из интернета можно к этой

00:14:18.980 --> 00:14:20.500
базе данных обратиться.

00:14:20.500 --> 00:14:24.360
Поэтому мы отвечаем на этот вопрос no.

00:14:24.360 --> 00:14:26.480
Третий вопрос звучит следующим образом.

00:14:26.480 --> 00:14:33.000
Укажите значение name тага для сабнета на котором

00:14:33.000 --> 00:14:36.240
расположен RDS instance.

00:14:36.240 --> 00:14:40.640
Следует обратить внимание что указано на странице

00:14:40.640 --> 00:14:43.600
с деталями базы данных а также посмотреть отдельно

00:14:43.600 --> 00:14:47.840
какие сабнеты есть у vpc.

00:14:47.840 --> 00:14:50.160
Как варианты ответов мы видим есть паблик сабнет

00:14:50.160 --> 00:14:52.440
private subnet 1 и private subnet 2.

00:14:52.440 --> 00:14:56.680
Это все имеющиеся сабнеты в нашем vpc.

00:14:56.680 --> 00:15:02.760
Давайте откроем страницу с деталями нашей базы данных.

00:15:02.760 --> 00:15:07.480
Мы видим что она находится в availability zone us-east1a.

00:15:07.480 --> 00:15:11.240
Также видим что сабнеты указан в список из двух

00:15:11.240 --> 00:15:12.240
сабнетов.

00:15:12.240 --> 00:15:16.360
Давайте попробуем эти сабнеты найти в списке сабнетов.

00:15:16.360 --> 00:15:19.600
Для этого необходимо открыть сервис vpc.

00:15:19.600 --> 00:15:26.440
В левом навигационном меню перейти на ссылку subnets и

00:15:26.440 --> 00:15:28.640
найти интересующие нас сабнеты.

00:15:28.640 --> 00:15:32.640
Мы видим что name тага заполнен как private subnet 1 и private subnet

00:15:32.640 --> 00:15:33.640
2.

00:15:33.640 --> 00:15:38.400
Как нам понять в каком из сабнетов находится наш

00:15:38.400 --> 00:15:40.680
instance базы данных?

00:15:40.680 --> 00:15:41.680
Ответ прост.

00:15:41.680 --> 00:15:44.520
Необходимо проверить в какой availability zone находится

00:15:44.520 --> 00:15:46.240
каждый из сабнетов.

00:15:46.240 --> 00:15:50.280
Для этого необходимо прокрутить правее эту таблицу и мы

00:15:50.280 --> 00:15:58.600
увидим что private subnet 1 находится в availability zone us-east1a и private

00:15:58.600 --> 00:16:03.080
subnet 2 находится в availability zone us-east1b.

00:16:03.080 --> 00:16:06.640
Таким образом правильным ответом является второй

00:16:06.640 --> 00:16:09.160
private subnet 1.

00:16:09.160 --> 00:16:11.240
Давайте посмотрим на четвертый вопрос.

00:16:11.240 --> 00:16:13.640
Здесь у нас спрашивает какое количество security

00:16:13.640 --> 00:16:19.080
групп рулов привязано к нашему RDS instance.

00:16:19.080 --> 00:16:23.000
Для этого обратно мы переходим на страницу с деталями

00:16:23.000 --> 00:16:27.440
нашего RDS instance и необходимо прокрутить чуть ниже.

00:16:27.440 --> 00:16:31.960
Есть отдельная секция с security групп рулами.

00:16:31.960 --> 00:16:34.880
Мы видим что у нас есть один единственный рул.

00:16:34.880 --> 00:16:38.880
Он разрешает outbound трафик на весь интернет.

00:16:38.880 --> 00:16:39.880
Отлично.

00:16:39.880 --> 00:16:45.240
Таким образом мы отвечаем на этот вопрос.

00:16:45.240 --> 00:16:50.960
Первый вариант ответа значение 1.

00:16:50.960 --> 00:16:54.000
Мы переходим к следующему заданию и здесь нам необходимо

00:16:54.000 --> 00:16:58.800
подключиться от EC2 instance к RDS instance.

00:16:58.800 --> 00:17:01.760
Первым делом нам необходимо скопировать endpoint нашего

00:17:01.760 --> 00:17:07.720
RDS instance и вернуться к странице с терминалом.

00:17:07.720 --> 00:17:10.360
Здесь необходимо ввести соответствующую команду.

00:17:10.360 --> 00:17:14.400
Обратите внимание что пользователем является админ и пароль тот

00:17:14.400 --> 00:17:17.000
который мы указывали в самом начале при создании

00:17:17.000 --> 00:17:20.400
RDS instance.

00:17:20.400 --> 00:17:22.880
Как только нажмете enter попросят ввести пароль.

00:17:22.880 --> 00:17:26.600
Вы вставите скопированный пароль и посмотрите что

00:17:26.600 --> 00:17:29.600
случится.

00:17:29.600 --> 00:17:31.920
Команда долго будет стоять таким образом.

00:17:31.920 --> 00:17:38.200
Через некоторое время выйдет ошибка таймаута.

00:17:38.200 --> 00:17:41.840
Это говорит о том что есть некоторые проблемы и нам

00:17:41.840 --> 00:17:45.200
дается подсказка что проблема не в пользователе и проблема

00:17:45.200 --> 00:17:46.200
не в пароле.

00:17:46.200 --> 00:17:50.160
Необходимо подумать где же может быть проблема.

00:17:50.160 --> 00:17:52.520
Первым то что приходит на ум это действительно

00:17:52.520 --> 00:17:59.860
ли есть доступ по сети от EC2 instance к RDS instance с учетом

00:17:59.860 --> 00:18:04.000
того что они находятся в одном VPC но в разных сабнетах.

00:18:04.000 --> 00:18:09.280
EC2 instance находится в паблик сабнете, а RDS instance находится

00:18:09.280 --> 00:18:11.280
в private сабнете.

00:18:11.280 --> 00:18:19.840
Таким образом давайте проверим у instance RDS security группу.

00:18:19.840 --> 00:18:23.120
Вы можете найти ссылку на security группу во вкладке

00:18:23.120 --> 00:18:29.240
connectivity and security и соответствующее поле VPC security groups.

00:18:29.240 --> 00:18:32.760
Как только мы на нее перейдем во вкладке inbound rules мы увидим

00:18:32.760 --> 00:18:38.200
что не задано ни одного правила которое разрешало бы входящий

00:18:38.200 --> 00:18:39.200
трафик.

00:18:39.200 --> 00:18:44.120
Давайте это исправим и нажмем на кнопку edit inbound rules.

00:18:44.120 --> 00:18:52.680
Здесь необходимо нажать на кнопку add rule и в поле

00:18:52.680 --> 00:18:59.880
type ввести mysql aurora протокол и порт она ставится автоматически.

00:18:59.880 --> 00:19:02.340
Как source указываем custom.

00:19:02.340 --> 00:19:05.400
Мы не можем указать весь интернет так как это небезопасно

00:19:05.400 --> 00:19:09.200
с точки зрения безопасности, некорректно.

00:19:09.200 --> 00:19:15.760
Поэтому мы можем предоставить доступ к security группе,

00:19:15.760 --> 00:19:20.440
а эта security группа привязана к EC2 instance.

00:19:20.440 --> 00:19:27.560
Таким образом нам необходимо вернуться к нашему EC2 instance,

00:19:27.560 --> 00:19:30.880
выбрать его и во вкладке security мы увидим security группу

00:19:30.880 --> 00:19:32.840
к которой она привязана.

00:19:32.840 --> 00:19:35.520
Полностью ID запоминать не нужно, достаточно запомнить

00:19:35.520 --> 00:19:41.200
последние два символа это C5.

00:19:41.200 --> 00:19:43.920
Возвращаемся обратно на страницу редактирования

00:19:43.920 --> 00:19:47.860
security группы базы данных и как только мы выбираем

00:19:47.860 --> 00:19:51.840
source активируется следующее поле, начнем вводить SG и

00:19:51.840 --> 00:19:54.920
отобразится список security групп доступных на этом

00:19:54.920 --> 00:19:55.920
AWS аккаунте.

00:19:55.920 --> 00:19:59.000
Нам нужно выбрать ту которая заканчивается на C5.

00:19:59.000 --> 00:20:04.240
В вашем случае будет другой ID, но идею вы поняли.

00:20:04.240 --> 00:20:08.680
Также является best practice и рекомендация от меня лично

00:20:08.680 --> 00:20:12.760
всегда дополнять опциональное поле description так как вы

00:20:12.760 --> 00:20:18.200
создаёте эти записи один раз правило и когда вы возвращаетесь

00:20:18.200 --> 00:20:21.300
через некоторое время практически нереально вспомнить для

00:20:21.300 --> 00:20:22.680
чего вы это делали.

00:20:22.680 --> 00:20:26.680
А когда есть небольшой комментарий вы можете очень

00:20:26.680 --> 00:20:31.460
легко вспомнить вы её писали или нет более того по содержанию

00:20:31.460 --> 00:20:34.080
этого текста понять для чего она была создана.

00:20:34.080 --> 00:20:37.960
Давайте введем EC2 SG, после этого нажмем на кнопку

00:20:37.960 --> 00:20:40.960
save rules.

00:20:40.960 --> 00:20:44.640
Отлично давайте теперь вернёмся обратно к окну терминала

00:20:44.640 --> 00:20:51.080
и попробуем ввести следующую команду nmap-pn и endpoint нашего

00:20:51.080 --> 00:20:53.520
RDS инстанца.

00:20:53.520 --> 00:20:59.440
Отработает проверка портов и мы увидим в большом сообщении

00:20:59.440 --> 00:21:05.600
в самом конце что порт 3306 TCP по протоколу TCP открыт.

00:21:05.600 --> 00:21:12.320
Это говорит о том что мы по сети предоставили необходимые

00:21:12.320 --> 00:21:15.920
права теперь попробуем подключиться к нашему

00:21:15.920 --> 00:21:21.200
инстанцу RDS используя предыдущую команду.

00:21:21.200 --> 00:21:23.760
Если мы все сделали правильно мы сможем подключиться.

00:21:23.760 --> 00:21:26.480
Давайте теперь посмотрим какие базы данных есть

00:21:26.480 --> 00:21:28.520
в этом инстанции RDS.

00:21:28.520 --> 00:21:32.100
Для этого необходимо ввести команду show databases.

00:21:32.100 --> 00:21:38.400
Вы видите здесь 5 баз данных и здесь нет базы данных

00:21:38.400 --> 00:21:39.400
cafeDB.

00:21:39.400 --> 00:21:43.680
Все верно так и должно быть так как эта база данных

00:21:43.680 --> 00:21:48.120
она пустая сейчас там ничего нет.

00:21:48.120 --> 00:21:55.520
Давайте теперь выйдем с этого промпта и с bash shell

00:21:55.520 --> 00:21:59.760
введем команду для импорта дампы базы данных.

00:21:59.760 --> 00:22:02.440
Как только мы это сделаем попросят ввести пароль

00:22:02.440 --> 00:22:05.660
мы ее введем и если мы не увидим ошибки это говорит

00:22:05.660 --> 00:22:10.560
о том что дамп был успешно импортирован в наш RDS

00:22:10.560 --> 00:22:11.560
инстанс.

00:22:11.560 --> 00:22:13.600
Давайте теперь обратно попробуем подключиться

00:22:13.600 --> 00:22:17.780
к нашему инстанцу и введем команду show databases.

00:22:17.780 --> 00:22:23.280
Мы видим что база данных нашего приложения cafeDB

00:22:23.280 --> 00:22:26.400
появилась давайте теперь ее выберем и посмотрим

00:22:26.400 --> 00:22:28.120
какие таблицы там есть.

00:22:28.120 --> 00:22:30.480
Мы видим все необходимые таблицы там есть.

00:22:30.480 --> 00:22:35.280
Также посмотрим содержание таблицы order мы видим что

00:22:35.280 --> 00:22:38.840
у нас есть 25 записей и последняя запись это тот

00:22:38.840 --> 00:22:40.760
заказ который мы с вами вместе сделали.

00:22:40.760 --> 00:22:44.400
Отлично.

00:22:44.400 --> 00:22:47.800
Теперь мы двигаемся к следующему заданию.

00:22:47.800 --> 00:22:53.880
В этом задании нам необходимо произвести изменения в

00:22:53.880 --> 00:22:56.960
наших параметрах так как приложение работает используя

00:22:56.960 --> 00:22:58.200
эти параметры.

00:22:58.200 --> 00:23:01.320
Здесь у нас есть параметры связанные с базой данных

00:23:01.320 --> 00:23:04.080
это dbpassword и dburl.

00:23:04.080 --> 00:23:07.200
Давайте их обновим на соответствующие значения.

00:23:07.200 --> 00:23:11.800
Первым делом сделаем изменения в параметре dbpassword необходимо

00:23:11.800 --> 00:23:13.440
ее открыть.

00:23:13.440 --> 00:23:16.800
Верху справа нажать на кнопку edit и ввести новое

00:23:16.800 --> 00:23:17.800
значение.

00:23:17.800 --> 00:23:20.040
После чего внизу страницы необходимо нажать на кнопку

00:23:20.040 --> 00:23:21.720
save changes.

00:23:21.720 --> 00:23:24.680
Как только мы это сделаем те же самые действия необходимо

00:23:24.680 --> 00:23:28.980
произвести с параметром dburl и здесь необходимо ввести

00:23:28.980 --> 00:23:31.120
endpoint инстанца rds.

00:23:31.120 --> 00:23:37.120
Сохраняем изменения возвращаемся к терминалу с подключением

00:23:37.120 --> 00:23:42.240
к инстанцу и здесь для чистоты эксперимента остановим

00:23:42.240 --> 00:23:43.640
локальную базу данных.

00:23:43.640 --> 00:23:46.900
Для этого введем следующую команду и увидим соответствующий

00:23:46.900 --> 00:23:48.080
ответ.

00:23:48.080 --> 00:23:51.160
Теперь попробуем открыть приложение.

00:23:51.160 --> 00:23:55.960
Ссылка остается той же так как мы веб приложение

00:23:55.960 --> 00:23:57.960
и веб сервер не меняли.

00:23:57.960 --> 00:24:02.640
Попробуем открыть вкладку меню и увидим ошибку.

00:24:02.640 --> 00:24:08.720
Давайте подумаем где же мы не произвели не произвели

00:24:08.720 --> 00:24:11.420
необходимые изменения.

00:24:11.420 --> 00:24:16.040
Вы можете сейчас остановить видео и попробовать ответить.

00:24:16.040 --> 00:24:22.320
Отлично, я надеюсь вы смогли правильно ответить.

00:24:22.320 --> 00:24:24.720
Правильным ответом является то что у нас есть еще один

00:24:24.720 --> 00:24:28.080
параметр связанный с базами данных это dbuser.

00:24:28.080 --> 00:24:33.200
Если вы помните в локальной базе данных мастер пользователем

00:24:33.200 --> 00:24:38.920
является root, а для инстанца rds мы создавали мастера

00:24:38.920 --> 00:24:42.280
пользователя под названием admin.

00:24:42.280 --> 00:24:45.120
Поэтому нам необходимо ввести сейчас соответствующие

00:24:45.120 --> 00:24:46.120
изменения.

00:24:46.120 --> 00:24:48.600
После того как мы это сделаем возвращаемся обратно на

00:24:48.600 --> 00:24:51.800
страницу с меню и попробуем обновить страницу.

00:24:51.800 --> 00:24:56.160
Мы увидим список товаров и сейчас нам необходимо

00:24:56.160 --> 00:24:59.820
проверить работу веб приложения.

00:24:59.820 --> 00:25:04.200
Выберем горячий шоколад в одном количестве и попробуем

00:25:04.200 --> 00:25:05.200
оставить заявку.

00:25:05.200 --> 00:25:10.160
Нас направят на страницу с нашим заказом это заказ

00:25:10.160 --> 00:25:12.200
номер 26.

00:25:12.200 --> 00:25:14.960
Все необходимые данные корректно отобразились.

00:25:14.960 --> 00:25:18.260
Давайте теперь попробуем открыть страницу с историей

00:25:18.260 --> 00:25:19.260
заказов.

00:25:19.260 --> 00:25:23.580
Мы увидим что и 25 и 26 заказ который мы с вами вместе

00:25:23.580 --> 00:25:26.120
сделали они корректно отображаются.

00:25:26.120 --> 00:25:33.360
Отлично на этом мы завершили все задания в рамках лабораторной

00:25:33.360 --> 00:25:34.360
работы.

00:25:34.360 --> 00:25:37.120
Если вы добрались до этого места я вас поздравляю.

00:25:37.120 --> 00:25:40.560
Сейчас мы запустим автоматическое оценивание.

00:25:40.560 --> 00:25:44.000
Для этого необходимо вернуться обратно на страницу лабораторной

00:25:44.000 --> 00:25:47.120
работы и нажать на кнопку submit.

00:25:47.120 --> 00:25:50.600
Здесь нам необходимо подтвердить что мы хотим запустить автоматическое

00:25:50.600 --> 00:25:54.840
оценивание и через некоторое время это может занять до

00:25:54.840 --> 00:25:55.840
двух минут.

00:25:55.840 --> 00:26:00.400
Отработают все скрипты и с правой стороны вы увидите

00:26:00.400 --> 00:26:01.920
свою оценку.

00:26:01.920 --> 00:26:04.680
Если вы набрали максимальное количество баллов я вас

00:26:04.680 --> 00:26:07.540
поздравляю вы молодцы все сделали корректно.

00:26:07.540 --> 00:26:12.520
Если же где-то не достает баллы посмотрите в каком

00:26:12.520 --> 00:26:17.160
задании у вас не хватает баллы необходимо вернуться

00:26:17.160 --> 00:26:20.000
к этому заданию и попробовать сделать ее еще раз.

00:26:20.000 --> 00:26:26.040
Отлично на этом мы завершаем лабораторную работу.

00:26:26.040 --> 00:26:28.960
Очень важно корректно выйти со всех систем.

00:26:28.960 --> 00:26:33.000
В первую очередь это относится к AWS Management консоли.

00:26:33.000 --> 00:26:36.680
Необходимо в верхней правой части нажать на имя пользователя

00:26:36.680 --> 00:26:39.200
и далее нажать на кнопку sign out.

00:26:39.200 --> 00:26:43.400
Если мы говорим про страницу с лабораторной работы нам

00:26:43.400 --> 00:26:46.120
необходимо завершить корректно лабораторную работу.

00:26:46.120 --> 00:26:49.920
Для этого нажимаем на кнопку end lab подтверждаем что мы

00:26:49.920 --> 00:26:53.220
завершаем лабораторную работу и необходимо дождаться

00:26:53.220 --> 00:27:00.440
сообщения о том что мы можем закрывать страницу AWS Academy.

00:27:00.440 --> 00:27:04.440
Отлично я вас поздравляю мы с вами завершили разбор

00:27:04.440 --> 00:27:06.000
лабораторной работы.

00:27:06.000 --> 00:27:10.080
Я очень надеюсь что вы получили более полное представление

00:27:10.080 --> 00:27:12.640
о сервисах AWS.

00:27:12.640 --> 00:27:13.960
Спасибо за внимание.

00:27:13.960 --> 00:27:42.200
Увидимся с вами на следующих наших активностях.