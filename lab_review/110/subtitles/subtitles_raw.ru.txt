 Добрый день, уважаемые студенты! Я рад вас всех видеть на очередной сессии разбора лабораторной работы. Тема сегодняшней лабораторной работы – это создание VPC. Итак, давайте начнем. Начинаем мы с вами разбор лабораторной работы с главной страницы AWS Management Console. Переходим к выполнению первого задания. Здесь нам необходимо перейти в сервис Amazon VPC. Далее, используя левое навигационное меню, перейти к списку VPC в AWS Account. Существующие VPC использовать не будем, а создадим новый. Для этого нажмем на кнопку Create VPC. Здесь нам необходимо выбрать опцию VPC only, так как мы будем создавать все необходимые компоненты по одному по отдельности. В будущем вы можете воспользоваться опцией VPC and more и указать все детали дополнительных компонентов. Тогда вы за одно действие создадите связку из нескольких сервисов. В поле Name необходимо ввести LabVPC. Как CIDR блок мы вводим то значение, которое дано в рамках лабораторной работы. Это 10.0.0.0.16. Обратите внимание, что в секции Text появилась пара с ключом Name и со значением LabVPC, которые мы ввели чуть выше. На этом мы ввели все необходимые значения. Теперь нажмем на кнопку Create VPC. Как только мы это нажмем, мы увидим соответствующее сообщение, что VPC была успешно создана. Также нас направят на основную страницу ресурса. Здесь нам необходимо сделать дополнительную настройку, а именно нажать на кнопку Actions в выпадающем меню выбрать опцию Edit VPC Settings и здесь активировать опцию Enable DNS Host Names. Это значит, что для всех ресурсов, создаваемых в рамках этого VPC, будет привязываться соответствующий DNS. Нужно поставить галочку и нажать на кнопку Save. Отлично, мы создали VPC, теперь можем переходить к созданию сабнетов. Для этого воспользуемся левым навигационным меню и выберем опцию Subnets. Как только вы перейдете на страницу со списком сабнетов, мы увидим, что у нас достаточно большое количество сабнетов в временном созданном AWS аккаунте, но тем не менее мы не будем их использовать. Нам необходимо создать сабнеты с нуля. Для этого нажмем на кнопку Create Subnet. Здесь обязательно нужно будет первым шагом выбрать VPC, это Lab VPC. Далее, в следующей секции необходимо будет ввести как имя Public Subnet, а для Availability Zone необходимо выбрать первую Availability Zone, в нашем случае это US East 1A, и как CedarBlock указать то значение, которое дано в задании лабораторной работы. Необходимо проскроллить до конца страницы и нажать на кнопку Create Subnet. Здесь есть один нюанс с Public Subnet. Мы хотим, чтобы для всех ресурсов, создаваемых в этом сабнете, автоматически присваивались публичные IP-адреса. Для этого необходимо выбрать наш сабнет, нажать на кнопку Actions и выбрать опцию Edit Subnet Settings. Здесь есть галочка Enable Auto Assign Public IPv4 Address. Необходимо поставить галочку и в нижней части страницы нажать на кнопку Save. Как только вы это сделаете, мы можем переходить к созданию второго сабнета. Для этого еще раз нажмем на кнопку Create Subnet и нас направить на страницу ввода входных данных. Здесь мы выбираем тот же Lab VPC, как Name указываем Private Subnet, как Availability Zone выбираем то же значение US East 1A и вводим соответствующий CedarBlock. Как только мы это все сделаем, необходимо будет прокрутить до конца страницы и нажать на кнопку Create Subnet. Отлично, мы создали все необходимые сабнеты и переходим к следующему заданию. На следующем задании нам необходимо будет создать интернет-гейтвей. Для этого также воспользуемся навигационным меню слева и выберем опцию Internet Gateways. На этой странице вы увидите список интернет-гейтвеев на этом AWS аккаунте. Нам необходимо создать новый, поэтому мы нажимаем на кнопку Create Internet Gateway. Здесь необходимо ввести только название Internet Gateway, в нашем случае Lab IJV, IJV от Internet Gateway. После этого необходимо нажать на кнопку Create Internet Gateway. Как только вы создадите интернет-гейтвей, вас направят на основную страницу ресурса и здесь вы увидите кнопку, что есть возможность сразу привязать ее к VPC. Если же по тем или иным причинам вы это сообщение не видите, вы также можете воспользоваться кнопкой Actions. И первый пункт это Attach to VPC. Давайте это сделаем. И после того, как мы нажмем на кнопку Attach to VPC, нас направят на соответствующую страницу. Здесь необходимо будет выбрать Lab VPC и сохранить изменения. Как только мы это сделаем, на основной странице интернет-гейтвея мы увидим state Attached, а также ссылку на наш Lab VPC в поле VPC ID. Отлично, мы на этом завершили это задание. Переходим к следующему. Сейчас будем настраивать наши road tables. Давайте перейдем на road tables, воспользовавшись левым навигационным меню. Как только откроется страница со списком road tables, мы увидим, что у нас уже есть дефолт в road tables. Он автоматически привязывается ко всем сабнетам в нашем VPC. И давайте найдем дефолт в road tables, относящийся к Lab VPC. Как только вы это сделаете, в столбце Name есть соответствующая кнопка. И используя эту кнопку, мы можем ввести значение для тега с ключом Name. Давайте введем private road table. Как только мы это сделаем, необходимо сохранить и выбрать наш road table. Далее необходимо открыть вкладку Roads, и вы увидите, что там есть routing rule по умолчанию, который дает возможность обмениваться информацией, ресурсами внутри VPC. Теперь нам необходимо создать public road table. Для этого необходимо в верхней правой части страницы нажать на кнопку Create road table. Нас направят на страницу для ввода входных данных. Здесь необходимо как Name ввести public road table, и выбрать в качестве VPC наш Lab VPC. И нажать на кнопку Create road table. Как только вы это сделаете, нам необходимо произвести некоторые изменения в public road table. Для этого необходимо перейти во вкладку Roads и нажать на кнопку Edit roads. Здесь мы будем добавлять routing rule, чтобы у этого subnet появился доступ к интернету. Для этого необходимо нажать на кнопку Add road и в новой строчке ввести следующие значения. Для subnet destination необходимо указать обозначение интернета, это IP-адрес со всеми нулями, слеш ноль. Как target необходимо указать интернет-гейтвей, который мы создали ранее. После чего необходимо нажать на кнопку Save changes. Как только мы это сделали, нам необходимо вспомнить и не забывать, что road table это отдельный независимый самостоятельный ресурс. И чтобы он начал действовать, нам необходимо его привязать к нашему subnet. Поэтому мы на основной странице public road table переходим во вкладку subnet associations. Видим, что этот road table ни с чем не привязан. Поэтому нажимаем на кнопку Edit subnet associations. Как только мы ее нажмем, вы увидите список всех существующих subnet. Для private subnet ничего делать не нужно, так как мы изменили дефолтовый road table и переименовали его в private road table. А здесь необходимо для кастомного road table, необходимо выбрать public subnet и сохранить изменения. Как только вы это сделаете, мы фактически превратим наш subnet в public subnet. И у всех ресурсов в этом subnet появится доступ в интернет. На этом мы завершаем это задание и переходим к следующему. В следующем задании нам необходимо будет настроить security группу для нашего приложения. Чтобы это сделать, нам необходимо в левом навигационном меню выбрать опцию security groups. Мы окажемся на странице со списком security group, созданных в этом AWS аккаунте. Нам необходимо создать новый, поэтому нажимаем на кнопку Create security group. Здесь необходимо ввести как security group name AppSg, как description необходимо ввести allow HTTP traffic и как VPC выбрать lab VPC. Давайте прокрутим чуть ниже и заполним секцию inbound rules. Для этого необходимо нажать на кнопку add rule, появится новая строчка. Здесь необходимо как тип выбрать HTTP. Следующие два поля заполнятся автоматически и для поля source необходимо будет выбрать опцию anywhere IPv4. В этом случае автоматически проставится обозначение интернета, это IP-адрес со всеми нулями, slash 0. Также рекомендуется заполнять поле description, хоть оно и опциональное. Давайте сюда введем allow web access. В этом случае при следующем обращении к security группе и просмотру существующих рулов вы точно поймете для чего и возможно даже кто создавал конкретный рул. Как только мы введем эти изменения, давайте нажмем на кнопку create security group в нижней части страницы, чтобы создать нашу security группу. Как только мы это сделаем, мы можем переходить к созданию application сервера. Для этого нам необходимо перейти в сервис EC2. Мы можем воспользоваться строкой поиска сервисов и начать вводить EC2. Первая ссылка это та ссылка, которая нам нужна. Как только мы оказались на главной странице сервиса EC2, нам необходимо нажать на кнопку launch instance и перейти на соответствующую страницу для ввода входных данных. Как name необходимо указать app server, далее как операционную систему указываем Amazon Linux и оставляем значение по умолчанию Amazon Linux 2 AMI-HVM. Прокрутим чуть ниже. Для секции instance type нам необходимо выбрать T2 micro, далее как TPR необходимо выбрать из выпадающего списка WOK. И нам определенно нужно будет вносить изменения в настройке сети, поэтому в секции network settings необходимо нажать на кнопку edit. Как только мы это сделаем, как VPC необходимо выбрать lab VPC, далее как subnet необходимо выбрать public subnet и в поле ниже необходимо для security группы выбрать опцию select existing security group. Как только мы это сделаем, в выпадающем меню у нас будет возможность выбрать security группу, которую мы создали на предыдущем шаге. Отлично, все остальные значения остаются по умолчанию, нам необходимо прокрутить в самой низ страницы и развернуть секцию advanced settings. Здесь необходимо привязать специально созданную IAM роль к нашему EC2 инстанцу, поэтому в поле IAM instance profile выберем из выпадающего списка значение inventory uproll. Прокрутим в самой низ страницы и здесь необходимо из лабораторного задания скопировать набор команд и вставить в поле user data, после чего мы можем нажать на кнопку launch instance в правой части экрана. Запустится процесс создания инстанца, появится на следующей странице ссылка на instance, давайте на нее нажмем. Как только сервер запустится, еще нужно подождать некоторое время, когда она пройдет системные проверки и status check столбец поменяет свое значение. Вы можете воспользоваться кнопкой для обновления, либо обновлять всю страницу кнопкой F5. Через менее чем две минуты столбец status check поменяет значение 2 из 2 и все проверки пройдены. После этого мы можем выбрать наш сервер и в метаданах скопировать публичный IPv4 адрес. Необходимо скопировать это значение и открыть эту веб-страницу в отдельной веб-странице в вашем браузере. Как только вы это сделаете, откроется приложение. Здесь будет сказано о том, что необходимо сконфигурировать настройки для подключения к базе данных. В рамках этой лабораторной работы мы не будем подключаться к базе данных и если вы увидели это сообщение, значит мы сделали все настройки корректно и приложение работает. На этом мы завершили все задания. Теперь нам нужно запустить скрипт для автопроверки. Поэтому мы возвращаемся на страницу лабораторной работы и здесь необходимо нажать на кнопку submit. Выйдет всплывающее окно, которое просит нас подтвердить это действие. Да, мы нажимаем на кнопку yes и необходимо подождать некоторое время и дождаться результатов проверки. Как только проверка закончится, с правой стороны экрана появится набранное количество баллов. Если вы набрали максимальное количество баллов, я вас поздравляю, вы все сделали верно. Если же нет, вы всегда можете посмотреть в нижней части, на каком из заданий не хватает баллов. Далее вернуться к этому заданию и попробовать ее выполнить еще раз. После чего вы можете запустить оценивание еще раз. За дополнительные запуски автооценивания баллы не отнимаются. Отлично, теперь нам необходимо выйти правильно со всех систем. Первым делом возвращаемся в AWS Management консоль, нажимаем на имя пользователя в верхней правой части и в выпадающем списке нажимаем на кнопку sign out. Далее возвращаемся на страницу с лабораторной работы и необходимо здесь нам завершить лабораторную работу. Для этого нажимаем на кнопку end lab и подтверждаем это действие. Как только мы это сделаем, появится всплывающее окно и вы должны увидеть сообщение о том, что вы можете закрывать это окно и страницу с лабораторной работы. Отлично, мы с вами завершили разбор лабораторной работы. Я надеюсь, вы получили более полное представление о сервисе VPC и связанных с ней сервисах и компонентах. Спасибо за внимание, увидимся с вами на следующих наших активностях.
