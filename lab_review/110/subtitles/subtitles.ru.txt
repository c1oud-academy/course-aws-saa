Добрый день, уважаемые студенты! Рад вас видеть на очередной сессии разбора лабораторной работы. Тема сегодняшней лабораторной работы – это создание VPC. Итак, давайте начнем. Начинаем мы с вами разбор лабораторной работы с главной страницы AWS Management Console. Переходим к выполнению первого задания. Здесь нам необходимо перейти в сервис Amazon VPC. Далее, используя левое навигационное меню, перейти к списку VPC в AWS Account. Существующие VPC использовать не будем, а создадим новый. Для этого нажмем на кнопку Create VPC. Здесь нам необходимо выбрать опцию VPC only, так как мы будем создавать все необходимые компоненты по одному по отдельности. В будущем вы можете воспользоваться опцией VPC and more и указать все детали дополнительных компонентов. Тогда вы за одно действие создадите связку из нескольких сервисов. В поле Name необходимо ввести Lab VPC. Как CIDR блок мы вводим то значение, которое дано в рамках лабораторной работы. Это 10.0.0.0.16. Обратите внимание, что в секции Tags появилась пара с ключом Name и со значением Lab VPC, которые мы ввели чуть выше. На этом мы ввели все необходимые значения. Теперь нажмем на кнопку Create VPC. Как только мы это нажмем, мы увидим соответствующее сообщение, что VPC была успешно создана. Также нас направят на основную страницу ресурса. Здесь нам необходимо сделать дополнительную настройку, а именно нажать на кнопку Actions, в выпадающем меню выбрать опцию Edit VPC Settings и здесь активировать опцию Enable DNS Hostnames. Это значит, что для всех ресурсов, создаваемых в рамках этого VPC, будет привязываться соответствующий DNS. Нужно поставить галочку и нажать на кнопку Save. Отлично, мы создали VPC, теперь можем переходить к созданию subnets. Для этого воспользуемся левым навигационным меню и выберем опцию Subnets. Как только вы перейдете на страницу со списком subnets, мы увидим, что у нас достаточно большое количество subnets во временно созданном AWS аккаунте, но мы не будем их использовать. Нам необходимо создать subnets с нуля. Для этого нажмем на кнопку Create Subnet. Здесь обязательно нужно будет первым шагом выбрать VPC, это Lab VPC. Далее, в следующей секции необходимо будет ввести как имя Public Subnet, а для Availability Zone необходимо выбрать первую Availability Zone, внашемслучае это us-east-1a, и как CIDR Block указать то значение, которое дано в задании лабораторной работы. Необходимо проскроллить до конца страницы и нажать на кнопку Create Subnet. Здесь есть один нюанс с Public Subnet. Мы хотим, чтобы для всех ресурсов, создаваемых в этом subnet, автоматически присваивались публичные IP-адреса. Для этого необходимо выбрать наш subnet, нажать на кнопку Actions и выбрать опцию Edit Subnet Settings. Здесь есть галочка Enable Auto-Assign Public IPv4 Address. Необходимо поставить галочку и в нижней части страницы нажать на кнопку Save. Как только вы это сделаете, мы можем переходить к созданию второго subnet. Для этого еще раз нажмем на кнопку Create Subnet и нас направить на страницу ввода входных данных. Здесь мы выбираем тот же Lab VPC, как Name указываем Private Subnet, как Availability Zone выбираем то же значение us-east-1a и вводим соответствующий CIDR Block. Как только мы это все сделаем, необходимо будет прокрутить до конца страницы и нажать на кнопку Create Subnet. Отлично, мы создали все необходимые subnets и переходим к следующему заданию. На следующем задании нам необходимо будет создать Internet gateway. Для этого также воспользуемся навигационным меню слева и выберем опцию Internet Gateways. На этой странице вы увидите список Internet gateways на этом AWS аккаунте. Нам необходимо создать новый, поэтому мы нажимаем на кнопку Create Internet Gateway. Здесь необходимо ввести только название Internet Gateway, в нашем случае Lab IGW, Internet Gateway. После этого необходимо нажать на кнопку Create Internet Gateway. Как только вы создадите Internet gateway, вас направят на основную страницу ресурса и здесь вы увидите кнопку, что есть возможность сразу привязать ее к VPC. Если же по тем или иным причинам вы это сообщение не видите, вы также можете воспользоваться кнопкой Actions. И первый пункт - это Attach to VPC. Давайте это сделаем. И после того, как мы нажмем на кнопку Attach to VPC, нас направят на соответствующую страницу. Здесь необходимо будет выбрать Lab VPC и сохранить изменения. Как только мы это сделаем, на основной странице Internet gateway мы увидим State Attached, а также ссылку на наш Lab VPC в поле VPC ID. Отлично, мы на этом завершили это задание. Переходим к следующему. Сейчас будем настраивать наши route tables. Давайте перейдем на Route tables, воспользовавшись левым навигационным меню. Как только откроется страница со списком route tables, мы увидим, что у нас уже есть дефолтовый route table. Он автоматически привязывается ко всем subnets в нашем VPC. И давайте найдем дефолтовый route table, относящийся к Lab VPC. Как только вы это сделаете, в столбце Name есть соответствующая кнопка. И используя эту кнопку, мы можем ввести значение для тега с ключом Name. Давайте введем Private route table. Далее необходимо сохранить и выбрать наш route table. Далее необходимо открыть вкладку Routes, и вы увидите, что там есть routing rule по умолчанию, который дает возможность обмениваться информацией, ресурсами внутри VPC. Теперь нам необходимо создать public route table. Для этого необходимо в верхней правой части страницы нажать на кнопку Create route table. Нас направят на страницу для ввода входных данных. Здесь необходимо как Name ввести Public route table, и выбрать в качестве VPC наш Lab VPC. И нажать на кнопку Create route table. Как только вы это сделаете, нам необходимо произвести некоторые изменения в public route table. Для этого необходимо перейти во вкладку Routes и нажать на кнопку Edit routes. Здесь мы будем добавлять routing rule, чтобы у этого subnet появился доступ к интернету. Для этого необходимо нажать на кнопку Add route и в новой строчке ввести следующие значения. Для столбца Destination указать обозначение интернета, это IP-адрес со всеми нулями, слеш ноль. Как Target необходимо указать Internet gateway, который мы создали ранее. После чего необходимо нажать на кнопку Save changes. Как только мы это сделали, нам необходимо вспомнить и не забывать, что route table это отдельный независимый самостоятельный ресурс. И чтобы он начал действовать, нам необходимо его привязать к нашему subnet. Поэтому мы на основной странице Public route table переходим во вкладку Subnet associations. Видим, что этот route table ни с чем не привязан. Поэтому нажимаем на кнопку Edit subnet associations. Как только мы ее нажмем, вы увидите список всех существующих subnet. Для private subnet ничего делать не нужно, так как мы изменили дефолтовый route table и переименовали его в private route table. А здесь необходимо для кастомного route table выбрать public subnet и сохранить изменения. Как только вы это сделаете, мы фактически превратим наш subnet в public subnet. И у всех ресурсов в этом subnet появится доступ в интернет. На этом мы завершаем это задание и переходим к следующему. В следующем задании нам необходимо будет настроить security группу для нашего приложения. Чтобы это сделать, нам необходимо в левом навигационном меню выбрать опцию Security groups. Мы окажемся на странице со списком security group, созданных в этом AWS аккаунте. Нам необходимо создать новый, поэтому нажимаем на кнопку Create security group. Здесь необходимо ввести как Security group name App-SG, как Description необходимо ввести Allow HTTP traffic и как VPC выбрать Lab VPC. Давайте прокрутим чуть ниже и заполним секцию Inbound rules. Для этого необходимо нажать на кнопку Add rule, появится новая строчка. Здесь необходимо как Type выбрать HTTP. Следующие два поля заполнятся автоматически и для поля Source необходимо будет выбрать опцию Anywhere-IPv4. В этом случае автоматически проставится обозначение интернета, это IP-адрес со всеми нулями, слэш 0. Также рекомендуется заполнять поле Description, хоть оно и опциональное. Давайте сюда введем Allow web access. В этом случае при следующем обращении к security группе и просмотру существующих рулов вы точно поймете для чего и возможно даже кто создавал конкретный рул. Как только мы введем эти изменения, давайте нажмем на кнопку Create security group в нижней части страницы, чтобы создать нашу security группу. Как только мы это сделаем, мы можем переходить к созданию Application server. Для этого нам необходимо перейти в сервис EC2. Мы можем воспользоваться строкой поиска сервисов и начать вводить EC2. Первая ссылка это та ссылка, которая нам нужна. Как только мы оказались на главной странице сервиса EC2, нам необходимо нажать на кнопку Launch instance и перейти на соответствующую страницу для ввода входных данных. Как Name необходимо указать App server, далее как операционную систему указываем Amazon Linux и оставляем значение по умолчанию Amazon Linux 2 AMI (HVM). Прокрутим чуть ниже. Для секции Instance type нам необходимо выбрать t2.micro, далее как Key pair name необходимо выбрать из выпадающего списка vockey. И нам определенно нужно будет вносить изменения в настройке сети, поэтому в секции Network settings необходимо нажать на кнопку Edit. Как только мы это сделаем, как VPC необходимо выбрать Lab VPC, далее как Subnet выбрать Public subnet и в поле ниже необходимо для security группы выбрать опцию Select existing security group. Как только мы это сделаем, в выпадающем меню у нас будет возможность выбрать security группу, которую мы создали на предыдущем шаге. Отлично, все остальные значения остаются по умолчанию, нам необходимо прокрутить в самый низ страницы и развернуть секцию Advanced settings. Здесь необходимо привязать специально созданную IAM роль к нашему EC2 инстансу, поэтому в поле IAM Instance Profile выберем из выпадающего списка значение Inventory-App-Role. Прокрутим в самый низ страницы и здесь необходимо из лабораторного задания скопировать набор команд и вставить в поле Userdata, после чего мы можем нажать на кнопку Launch instance в правой части экрана. Запустится процесс создания инстанса, появится на следующей странице ссылка на инстанс, давайте на нее нажмем. Как только сервер запустится, еще нужно подождать некоторое время, когда она пройдет системные проверки и status check столбец поменяет свое значение. Вы можете воспользоваться кнопкой для обновления, либо обновлять всю страницу кнопкой F5. Через менее чем две минуты столбец status check поменяет значение 2 из 2 и все проверки пройдены. После этого мы можем выбрать наш сервер и в метаданных скопировать публичный IPv4 адрес. Необходимо скопировать это значение и открыть эту веб-страницу в отдельной веб-странице в браузере. Как только вы это сделаете, откроется приложение. Здесь будет сказано, что необходимо сконфигурировать настройки для подключения к базе данных. В рамках этой лабораторной работы мы не будем подключаться к базе данных и если вы увидели это сообщение, значит мы сделали все настройки корректно и приложение работает. На этом мы завершили все задания. Теперь нам нужно запустить скрипт для автопроверки. Поэтому мы возвращаемся на страницу лабораторной работы и здесь необходимо нажать на кнопку Submit. Выйдет всплывающее окно, которое просит нас подтвердить это действие. Да, мы нажимаем на кнопку Yes и необходимо подождать некоторое время и дождаться результатов проверки. Как только проверка закончится, с правой стороны экрана появится набранное количество баллов. Если вы набрали максимальное количество баллов, я вас поздравляю, вы все сделали верно. Если же нет, вы всегда можете посмотреть в нижней части, на каком из заданий не хватает баллов. Далее вернуться к этому заданию и попробовать ее выполнить еще раз. После чего вы можете запустить оценивание еще раз. За дополнительные запуски автооценивания баллы не отнимаются. Отлично, теперь нам необходимо выйти правильно со всех систем. Первым делом возвращаемся в AWS Management Console, нажимаем на имя пользователя в верхней правой части и в выпадающем списке нажимаем на кнопку Sign out. Далее возвращаемся на страницу лабораторной работы и необходимо здесь нам завершить лабораторную работу. Для этого нажимаем на кнопку End lab и подтверждаем это действие. Как только мы это сделаем, появится всплывающее окно и вы должны увидеть сообщение о том, что вы можете закрывать это окно и страницу с лабораторной работы. Отлично, мы с вами завершили разбор лабораторной работы. Я надеюсь, вы получили более полное представление о сервисе VPC и связанных с ней сервисах и компонентах. Спасибо за внимание, увидимся с вами на следующих наших активностях.