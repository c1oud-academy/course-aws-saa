 Добрый день, уважаемые студенты! Я рад вас видеть на очередной сессии разбора лабораторной работы. Тема лабораторной работы – это знакомство с сервисом Amazon Elastic File System или вкратце Amazon EFS. Итак, давайте начнем. Начинаем мы с вами лабораторную работу с основной страницы лабораторной работы VWS Academy. Для этого необходимо нажать на кнопку Start Lab. В всплывающем окне вы увидите состояние лабораторной работы и в начале он будет в состоянии In Creation. Как только она перейдет в состояние Ready, вы можете закрывать это всплывающее окно и переходить в AWS Management Console. Для этого необходимо там же возле кнопки Start Lab нажать на кнопку AWS. Как только мы перешли на главную страницу AWS Management Console, мы можем начать выполнение наших заданий. Первое задание необходимо создать Security группу. Для этого необходимо в строке поиска сервисов начать вводить EC2. В строке выдачи выбрать нужный нам сервис и на главной странице сервиса EC2 в левом навигационном меню нажать на вкладку Security Groups. Как только вы на нее нажмете, вы увидите список существующих Security Group в этом AWS аккаунте. Давайте выберем Security группу с названием EFS Client. Скопируем ее Security Group ID, она нам понадобится и нажмем на кнопку Create Security Group. Как только мы ее нажмем, мы перейдем на страницу создания Security группы. Здесь необходимо будет вести некоторые данные. Первым делом необходимо указать Security группный. Давайте сюда напишем EFS Mount Target согласно заданию. Как description напишем Inbound NFC access from EFS Clients. И как VPC выберем Lab VPC. Ниже в секции Inbound Rules необходимо будет нажать на кнопку Add Rule. Появится строчка, здесь необходимо будет как Type выбрать NFC. Автоматически вставится протокол TCP, Port Range 2049, то что нам нужно. И как Source необходимо выбрать Custom. Как только вы это сделаете, активируется следующее поле. И там необходимо будет вставить ID Security группы. Либо прокрутить в выпадающем списке и найти нужную нам Security группы с именем EFS Client. Как только мы это сделаем, необходимо прокрутить до конца страницы и нажать на кнопку Create Security Group. Мы готовы к созданию EFS файловой системы. Для этого необходимо перейти на этот сервис. Давайте начнем вводить EFS в строку поиска сервисов и перейдем на этот сервис. Мы окажемся на основной странице сервиса EFS. Так как в этом AWS аккаунте не имеется созданных файловых систем. Вы увидите страницу с видеоматериалом, с небольшой информацией об этом сервисе. Также будет кнопка Create File System. Давайте на нее нажмем. Увидите следующую страницу. Здесь нам необходимо будет нажать на кнопку Customize, чтобы открыть расширенные настройки создания файловой системы. Она состоит из четырех шагов. В первом шаге нам необходимо будет для поля Enable Automatic Backups галочку убрать. Для Lifecycle Management нужно будет выбрать опцию None и прокрутить вниз страницы. Здесь как ключ тега Name необходимо будет указать значение My First EFS File System и нажать на кнопку Next. Мы окажемся на второй странице. Здесь необходимо будет как VPC выбрать Lab VPC. Вы увидите, что создается Mount Target для каждой Availability зоны. Так как в Lab VPC у нас две Availability зоны. Мы увидим US East 1A и US East 1B. Также вы увидите, что привязаны Security группы дефолтные. Они нам не нужны, поэтому необходимо будет нажать на кнопку X для каждой из Security группы. И после чего для каждой Availability зоны выбрать Security группу, созданную нами ранее. Она называется EFS Mount Target. Как только вы ее выбрали, необходимо будет нажать на кнопку Next. На третьей странице мы ничего менять не будем. Оставляем все по умолчанию. Еще раз нажимаем на кнопку Next. На четвертой странице мы видим все введенные нами входные данные. Необходимо будет прокрутить саму нисть страницы и нажать на кнопку Create. Как только вы это сделали, начнется процесс создания EFS файловой системы. Она занимает некоторое время. В среднем это 2-3 минуты. Поэтому нам необходимо будет периодически обновлять страницу, используя соответствующую кнопку. Либо обновлять всю страницу, используя кнопку F5. Кому как удобнее. Как только EFS создастся, вы увидите соответствующее сообщение в зеленом уведомлении. А также увидите, что состояние статус EFS файловой системы сменился на Available. Мы с вами переходим к следующему заданию. Теперь нам нужно подключиться к EC2 инстанцию через SSH. Для этого на основной странице лаборатурной работы необходимо будет нажать на кнопку Details. В всплывающем списке нажать на кнопку Show. Отобразится отдельное всплывающее окно. И здесь нам необходимо будет скачать PPK Private Key. Если вы работаете с Windows операционной системой. Если же вы используете MacOS либо Linux операционную систему. В вашем случае нужно будет скачать PEM Private Key, который находится рядом. Как только мы скачали, нам необходимо будет открыть программу PuTTY. Если ее у вас нет, вам нужно будет ее скачать по ссылке в лаборатурной работе. Вы можете найти через поисковик и скачать эту программу. Устанавливать ее не нужно. Как только вы ее запускаете, она сразу доступна к работе. Здесь нам необходимо будет в программе в левом навигационном меню добраться до вкладки Credentials. Она находится в основной вкладке Connection, далее SSH, дальше ALF. После этого вы увидите вкладку в самом нижнем уровне Credentials. Давайте на нее нажмем. Вы увидите три поля. Первое поле, это то поле, которое нас интересует. Private Key, File for Authentication. Необходимо будет нажать на браузер и далее указать путь до этого файла. И нажать на вкладку Session в левом навигационном меню. Как только вы окажете здесь, рекомендуется сохранить это подключение, чтобы постоянно не указывать путь до Private Key. Для этого в поле Saved Sessions необходимо будет задать название нового подключения. Я написал AWS Academy и нажал на кнопку Save. Далее нам необходимо будет найти Public IP-адрес нашего инстанца. Вы также ее видели в окне, где вы скачивали Private Key, IP и ситу инстанца. Если она там не отображается, вы можете ее найти в AWS Management Console. Для этого необходимо перейти в сервис EC2, в левом навигационном меню нажать на вкладку Instances. И вы увидите один единственный инстанс, называется EFS Client. Давайте ее выберем и в метаданных этого инстанца вы увидите Public IP-адрес. Необходимо будет ее сохранить и дальше уже ввести в PUTTI. Здесь также вы видите, что при открытии программы PUTTI у вас отображается список существующих сессий. И в этом случае необходимо будет выбрать AWS Academy и нажать на кнопку Load. После этого загрузятся все настройки, в том числе и путь до Private Key. Как только вы нажали на кнопку Load, вам необходимо будет заполнить поле с IP-адресом сервера и далее нажать на кнопку Open. Как только вы ее нажмете, если это первое подключение, то выйдет соответствующее уведомление о том, что это подключение может быть небезопасным. В нашем случае мы знаем, куда мы подключаемся, поэтому нажимаем на кнопку Accept. Нас пускает дальше и у вас запросит имя пользователя, под которым вы подключаетесь. Для Linux операционных систем внутри EC2 стандартным пользователем является EC2 Dash User. Давайте ее введем, нажмем Enter. Как только вы это сделаете, вы увидите Welcome сообщение и увидите Prompt, где вы уже можете вводить ваши команды. Давайте начнем вводить команды из следующего задания. Нам необходимо создать папку EFS, для этого введем sudo mkdir efs. Папка создается. Далее нам необходимо будет вернуться в AWS Management консоль, перейти на сервис EFS. Как это сделать вы уже знаете. Как только вы перейдете на основную страницу сервиса Amazon EFS, вы увидите одну единственную файловую систему, необходимо будет ее выбрать и провалиться в детали этой файловой системы. Откроется соответственно страница этой файловой системы, все метаданные, которые нам могут понадобиться, текущее состояние, а также вверху справа вы увидите кнопку Attach. Давайте на нее нажмем, вы увидите всплывающее окно с различными вариантами команд для монтирования этой файловой системы в EC2 Instance. Оно персонально уже заполнено для вашего EFS, вам достаточно скопировать ее. В нашем случае мы используем команду для NFS клиента и необходимо будет ее ввести в наши SSH сессии. Как только вы это сделаете, можно будет проверить, действительно ли подключение к файловой системе прошло успешно путем ввода команды sudo df. Как только вы это сделаете, отобразится список всех файловых систем, вы увидите, что есть строчка, которая содержит EFS.useastone.amazon.aws.com Также вы видите, что он примонтирован к нашей папке, она находится по пути home, EC2 User наш пользователь и папка EFS. Отлично. Давайте теперь введем несколько команд для того, чтобы проверить работоспособность EFS. Воспользуемся инструментом FIO, про который мы говорили в обзоре лабораторной работы. И мы ее введем, начнется процесс, она займет некоторое время, порядка 10 минут, для того, чтобы создать файл размером 10 гигабайтов в нашем EFS. Как только отработает команда, вы увидите детали запуска этого теста, нас интересует строчка, которая начинается на write, мы видим, что IE равно 10240 мегабайтов, то есть мы создали файл размером 10 гигабайтов. Далее мы видим agrb, это среднее количество байтов, которые мы записывали в секунду, в нашем случае это 103 мегабайта в секунду. Примерно те же значения мы видим для minb и maxb, это минимальная и максимальная скорость записи, которая была во время наших тестов. Отлично. Давайте теперь воспользуемся сервисом CloudWatch для того, чтобы проверить, действительно ли мы с такой скоростью передавали, что мы можем увидеть из AWS Management Console. Для этого в строке поиска сервисов начнем вводить CloudWatch, можете также вводить любую последовательность букв в рамках этого названия. Я обычно для сервисов состоящих из двух слов начинаю вводить со второго слова, в этом случае большая вероятность того, что не придется вводить целиком все слово. Поэтому если написать what, вы увидите нужную ссылку. Давайте на нее перейдем. Как только вы окажетесь на основной странице CloudWatch, в левом навигационном меню нужно будет выбрать metrics и дальше выбрать вкладку all metrics. Перейдете на соответствующую страницу, здесь необходимо будет выбрать метрики, связанные с EFS, далее выбрать file system metrics и вы увидите 8 различных метрик, связанных с нашей файловой системой. Давайте выберем метрику permitted throughput, это какое количество мегабайтов, с какой скоростью мы записывали на наш EFS. Как только вы ее выберете отобразится график, если он не отобразился, подождите 2-3 минуты, после этого обновите страницу. Вы можете также мышкой выделить определенный период времени на графике и он ее приблизит. Как только мы это сделаем, мы видим, что график ровный, скорость она не менялась, если навести на любую точку, мы видим она нам показывает 104800, это значит примерно 105 мегабайтов была скорость записи. Если мы перейдем обратно на список metrics и выберем уже другую метрику, в нашем случае data right iobytes, и уберем галочку с предыдущей, то отобразится другой график. Здесь нам необходимо будет перейти на вкладку Graphs Metrics, для столца статистик выбрать сумм, для период выбрать минут, и в верхней части страницы выбрать один час, то есть мы увидим метрики за последний час. Вы видите некоторый график, давайте попробуем выбрать пиковое значение, у меня два пиковых значения не совпадают, выбираю любую и вижу следующее значение, это 6300000. Что оно значит? Оно значит, что в пиковое время мы записали такое количество килобайтов или 6300000 байтов за одну минуту. Для этого как раз таки мы как статистик выбирали сумм и как период минут, то есть все те метрики, которые пришли связанные с количеством input output операции в байтах, они агрегируются до одной минуты и все эти значения они суммируются. Теперь что нам необходимо сделать? Мы это значение можем поделить на 60 для того, чтобы посмотреть какая скорость была в секунду. Если вы это сделаете, то вы получите значение те же 105 мегабайтов, которые показали наши тесты в SSH сессии. Отлично, я вас поздравляю, мы завершили все задания в рамках лабораторной работы, теперь попробуем запустить процесс оценивания. Для этого необходимо нажать на кнопку submit, далее выйдет сообщение о том, что действительно ли мы хотим запустить этот процесс, нажимаем yes и через какое-то время, когда отработают все тесты, мы увидим наши результаты. В моем случае я набрал 15 баллов из 15, все задания были выполнены корректно, мы видим три задания, которые оценивались. Я напоминаю, что если вы набрали не максимальный балл, вы можете посмотреть в каком задании была ошибка, ее выполнить еще раз и запустить процесс оценивания еще раз. Никаких штрафных баллов не выдается, поэтому в случае успешного выполнения вы увидите обновленную оценку. Останавливать лабораторную работу в этом случае нет необходимости. Отлично, на этом мы завершаем, нам необходимо выйти правильно со всех систем, начнем с AWS Management Console, в верхней правой части нажмем на название пользователя, дальше в выпадающем списке нажмем на кнопку sign out и выйдем с AWS Management Console. Дальше возвращаемся на страницу лабораторной работы, здесь необходимо также успешно завершить эту лабораторную работу, поэтому необходимо нажать на кнопку end lab. Мы подтверждаем, что мы хотим завершить лабораторную работу и как только вы увидите сообщение о том, что мы можем закрывать эту страницу, что процесс удаления ресурсов инициирован, вы можете закрыть эту страницу и закрыть всю страницу с лабораторной работы. На этом я очень надеюсь, что вы получили более полное представление о сервисе EFS. Если будут вопросы, вы эти вопросы задавайте. Спасибо за внимание, увидимся с вами на следующих наших активностях.
