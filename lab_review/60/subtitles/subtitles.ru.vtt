WEBVTT

00:00:00.000 --> 00:00:07.000
Добрый день, уважаемые студенты! Рад вас видеть
на очередной сессии разбора лабораторной работы.

00:00:07.000 --> 00:00:15.000
Тема лабораторной работы – знакомство с сервисом
Amazon Elastic File System или вкратце Amazon EFS.

00:00:15.000 --> 00:00:25.000
Давайте начнем. Начинаем лабораторную работу с
основной страницы лабораторной работы AWS Academy.

00:00:25.000 --> 00:00:31.530
Для этого необходимо нажать на кнопку 
Start Lab. В всплывающем окне вы увидите

00:00:31.554 --> 00:00:38.000
состояние лабораторной работы и в
начале он будет в состоянии In Creation.

00:00:38.000 --> 00:00:41.988
Как только она перейдет в
состояние Ready, вы можете закрывать

00:00:42.012 --> 00:00:46.000
это всплывающее окно и переходить
в AWS Management Console.

00:00:46.000 --> 00:00:51.000
Для этого необходимо там же возле
кнопки Start Lab нажать на кнопку AWS.

00:00:51.000 --> 00:00:55.100
Как только мы перешли на
главную страницу AWS Management

00:00:55.124 --> 00:00:59.000
Console, мы можем начать
выполнение наших заданий.

00:00:59.000 --> 00:01:03.000
Первое задание - необходимо
создать Security group.

00:01:03.000 --> 00:01:08.000
Для этого необходимо в строке
поиска сервисов начать вводить EC2.

00:01:08.000 --> 00:01:15.141
В строке выдачи выбрать нужный нам
сервис и на главной странице сервиса

00:01:15.165 --> 00:01:22.000
EC2 в левом навигационном меню
нажать на вкладку Security Groups.

00:01:22.000 --> 00:01:29.000
Как только вы на нее нажмете, вы увидите список
существующих Security Group в этом AWS аккаунте.

00:01:29.000 --> 00:01:35.000
Давайте выберем Security
Group с названием EFS Client.

00:01:35.000 --> 00:01:44.000
Скопируем Security Group ID, она понадобится
и нажмем на кнопку Create Security Group.

00:01:44.000 --> 00:01:53.000
Как только мы ее нажмем, мы перейдем
на страницу создания Security Group.

00:01:53.000 --> 00:01:59.000
Здесь необходимо вести некоторые данные. Первым
делом необходимо указать Security Group Name.

00:01:59.000 --> 00:02:03.000
Давайте сюда напишем EFS
Mount Target согласно заданию.

00:02:03.000 --> 00:02:13.000
Как Description напишем Inbound NFC access
from EFS Clients. И как VPC выберем Lab VPC.

00:02:13.000 --> 00:02:19.000
Ниже в секции Inbound Rules необходимо
будет нажать на кнопку Add Rule.

00:02:19.000 --> 00:02:24.000
Появится строчка, здесь необходимо
будет как Type выбрать NFC.

00:02:24.000 --> 00:02:29.000
Автоматически вставится протокол
TCP, Port Range 2049, то что нам нужно.

00:02:29.000 --> 00:02:36.000
И как Source выбрать Custom. Как только вы
это сделаете, активируется следующее поле.

00:02:36.000 --> 00:02:43.000
И там необходимо будет
вставить Security Group ID.

00:02:43.000 --> 00:02:51.000
Либо прокрутить в выпадающем списке и найти
нужную нам Security Group с именем EFS Client.

00:02:51.000 --> 00:02:58.988
Далее, необходимо прокрутить до конца
страницы и нажать на кнопку Create Security Group.

00:02:59.012 --> 00:03:07.000
Мы готовы к созданию EFS файловой 
системы. Необходимо перейти на этот сервис.

00:03:07.000 --> 00:03:15.000
Давайте начнем вводить EFS в строку
поиска сервисов и перейдем на этот сервис.

00:03:15.000 --> 00:03:21.000
Мы окажемся на основной
странице сервиса Amazon EFS.

00:03:21.000 --> 00:03:27.000
Так как в этом AWS аккаунте не
имеется созданных файловых систем,

00:03:27.000 --> 00:03:36.000
вы увидите страницу с видеоматериалом, с
небольшой информацией об этом сервисе.

00:03:36.000 --> 00:03:43.000
Также будет кнопка Create File System. Давайте 
на нее нажмем. Увидите следующую страницу.

00:03:43.000 --> 00:03:47.577
Здесь нам необходимо будет нажать
на кнопку Customize, чтобы открыть

00:03:47.601 --> 00:03:53.000
расширенные настройки создания файловой 
системы. Она состоит из четырех шагов.

00:03:53.000 --> 00:04:01.000
В первом шаге нам необходимо будет для
поля Enable Automatic Backups галочку убрать.

00:04:01.000 --> 00:04:08.000
Для Lifecycle Management нужно будет
выбрать опцию None и прокрутить вниз страницы.

00:04:08.000 --> 00:04:17.234
Здесь как ключ тега Name необходимо будет
указать значение My First EFS File System и нажать

00:04:17.258 --> 00:04:27.000
на кнопку Next. Мы окажемся на второй странице.
Здесь необходимо будет как VPC выбрать Lab VPC.

00:04:27.000 --> 00:04:34.000
Вы увидите, что создается Mount
Target для каждой Availability zone.

00:04:34.000 --> 00:04:42.000
Так как в Lab VPC у нас две Availability zone,
мы увидим us-east-1a и us-east-1b.

00:04:42.000 --> 00:04:46.000
Также вы увидите, что привязаны
дефолтные Security Group.

00:04:46.000 --> 00:04:52.000
Они нам не нужны, поэтому необходимо будет
нажать на кнопку X для каждой из Security Group.

00:04:52.000 --> 00:05:00.000
И после чего для каждой Availability zone
выбрать Security Group, созданную нами ранее.

00:05:00.000 --> 00:05:08.000
Она называется EFS Mount Target. Как только вы
ее выбрали, необходимо нажать на кнопку Next.

00:05:08.000 --> 00:05:15.000
На третьей странице ничего менять не будем.
Оставляем по умолчанию. Нажимаем на кнопку Next.

00:05:15.000 --> 00:05:20.000
На четвертой странице мы видим
все введенные нами входные данные.

00:05:20.000 --> 00:05:26.000
Необходимо будет прокрутить в самый
низ страницы и нажать на кнопку Create.

00:05:26.000 --> 00:05:32.000
Как только вы это сделали, начнется
процесс создания EFS файловой системы.

00:05:32.000 --> 00:05:36.000
Процесс занимает некоторое время.
В среднем это 2-3 минуты.

00:05:36.000 --> 00:05:41.828
Поэтому нам необходимо будет периодически
обновлять страницу, используя соответствующую

00:05:41.852 --> 00:05:47.000
кнопку, либо обновлять всю страницу,
используя кнопку F5, кому как удобнее.

00:05:51.000 --> 00:05:58.000
Как только EFS создастся, вы увидите
соответствующее сообщение в зеленом уведомлении.

00:05:58.000 --> 00:06:07.000
А также увидите, что статус EFS
файловой системы сменился на Available.

00:06:09.000 --> 00:06:11.000
Мы с вами переходим
к следующему заданию.

00:06:11.000 --> 00:06:16.000
Теперь нам нужно подключиться
к EC2 инстансу через SSH.

00:06:16.000 --> 00:06:22.000
Для этого на основной странице лабораторной
работы необходимо будет нажать на кнопку Details.

00:06:22.000 --> 00:06:28.000
В всплывающем списке нажать на кнопку Show.
Отобразится отдельное всплывающее окно.

00:06:28.000 --> 00:06:40.000
Здесь необходимо скачать PPK Private Key, если
вы работаете с Windows операционной системой.

00:06:40.000 --> 00:06:46.000
Если же вы используете MacOS
либо Linux операционную систему,

00:06:46.000 --> 00:06:53.000
в вашем случае нужно будет скачать
PEM Private Key, который находится рядом.

00:06:54.000 --> 00:06:59.000
Как только мы скачали, нам необходимо
будет открыть программу PuTTY.

00:06:59.000 --> 00:07:05.000
Если ее у вас нет, вам нужно будет ее
скачать по ссылке в лабораторной работе.

00:07:05.000 --> 00:07:12.000
Вы можете найти через поисковик и скачать
эту программу. Устанавливать ее не нужно.

00:07:12.000 --> 00:07:16.000
Как только вы ее запускаете,
она сразу доступна к работе.

00:07:17.000 --> 00:07:24.000
Здесь необходимо в левом навигационном
меню добраться до вкладки Credentials.

00:07:24.000 --> 00:07:30.000
Она находится в основной вкладке
Connection, далее SSH, дальше Auth.

00:07:30.000 --> 00:07:35.000
После этого вы увидите вкладку в
самом нижнем уровне Credentials.

00:07:35.000 --> 00:07:40.000
Давайте на нее нажмем. Вы увидите три поля.
Первое поле - это то поле, которое нас интересует,

00:07:40.000 --> 00:07:49.000
Private Key file for authentication. Необходимо
нажать на Browse... и указать путь до этого файла.

00:07:49.000 --> 00:07:54.000
И нажать на вкладку Session
в левом навигационном меню.

00:07:54.000 --> 00:07:59.996
Как только вы окажете здесь,
рекомендуется сохранить это

00:08:00.020 --> 00:08:07.000
подключение, чтобы постоянно
не указывать путь до Private Key.

00:08:07.000 --> 00:08:15.000
Для этого в поле Saved Sessions необходимо
будет задать название нового подключения.

00:08:15.000 --> 00:08:25.000
Я написал aws-academy
и нажал на кнопку Save.

00:08:25.000 --> 00:08:31.000
Далее, нам необходимо будет найти
Public IP address нашего инстанса.

00:08:31.000 --> 00:08:40.000
Вы также ее видели в окне, где вы
скачивали Private Key, IP EC2 инстанса.

00:08:40.000 --> 00:08:45.000
Если она там не отображается, вы
можете ее найти в AWS Management Console.

00:08:45.000 --> 00:08:52.000
Для этого необходимо перейти в сервис EC2, в левом
навигационном меню нажать на вкладку Instances.

00:08:52.000 --> 00:08:56.000
И вы увидите один единственный
инстанс, называется EFS Client.

00:08:56.000 --> 00:09:04.000
Давайте его выберем и в метаданных
этого инстанса вы увидите Public IP address.

00:09:04.000 --> 00:09:12.000
Необходимо будет его сохранить
и дальше уже ввести в PuTTY.

00:09:12.000 --> 00:09:22.000
Здесь также вы видите, что при открытии программы
PuTTY отображается список существующих сессий.

00:09:22.000 --> 00:09:27.000
И в этом случае необходимо будет выбрать
aws-academy и нажать на кнопку Load.

00:09:27.000 --> 00:09:33.000
После этого загрузятся все настройки,
в том числе и путь до Private Key.

00:09:33.000 --> 00:09:38.407
Как только вы нажали на кнопку
Load, вам необходимо будет

00:09:38.431 --> 00:09:45.000
заполнить поле с IP-адресом
сервера и далее нажать на кнопку Open.

00:09:45.000 --> 00:09:48.926
Как только вы ее нажмете, если
это первое подключение, то выйдет

00:09:48.950 --> 00:09:54.000
соответствующее уведомление о том, что
это подключение может быть небезопасным.

00:09:54.000 --> 00:09:59.000
В нашем случае мы знаем, куда мы подключаемся,
поэтому нажимаем на кнопку Accept.

00:09:59.000 --> 00:10:08.000
Нас пропускают дальше и у вас запросит имя
пользователя, под которым вы подключаетесь.

00:10:08.000 --> 00:10:15.000
Для Linux операционных систем внутри EC2
стандартным пользователем является ec2-user.

00:10:15.000 --> 00:10:22.644
Давайте ее введем, нажмем Enter. Как только вы
это сделаете, увидите Welcome сообщение и Prompt,

00:10:22.668 --> 00:10:30.000
где вы уже можете вводить ваши команды. Давайте
начнем вводить команды из следующего задания.

00:10:30.000 --> 00:10:36.000
Нам необходимо создать папку EFS, для
этого введем sudo mkdir efs. Папка создается.

00:10:36.000 --> 00:10:43.000
Далее нам необходимо будет вернуться в
AWS Management Console, перейти на сервис EFS.

00:10:43.000 --> 00:10:52.526
Как это сделать вы знаете. Как только вы перейдете
на основную страницу сервиса Amazon EFS, вы

00:10:52.550 --> 00:11:03.000
увидите одну файловую систему, необходимо
ее выбрать и открыть детали файловой системы.

00:11:03.000 --> 00:11:08.488
Откроется соответственно страница этой
файловой системы, все метаданные, которые нам

00:11:08.512 --> 00:11:14.000
могут понадобиться, текущее состояние, а
также вверху справа вы увидите кнопку Attach.

00:11:14.000 --> 00:11:20.370
Давайте на нее нажмем, вы увидите
всплывающее окно с различными

00:11:20.394 --> 00:11:28.000
вариантами команд для монтирования
этой файловой системы в EC2 Instance.

00:11:28.000 --> 00:11:33.000
Оно персонально уже заполнено для
вашего EFS, вам достаточно скопировать ее.

00:11:33.000 --> 00:11:43.000
В нашем случае мы используем команду для NFS
Client и необходимо ее ввести в нашей SSH сессии.

00:11:43.000 --> 00:11:49.960
Как только вы это сделаете, можно
будет проверить, действительно ли

00:11:49.984 --> 00:11:58.000
подключение к файловой системе прошло
успешно путем ввода команды sudo df.

00:11:58.000 --> 00:12:05.988
Как только вы это сделаете, отобразится
список всех файловых систем, вы

00:12:06.012 --> 00:12:14.000
увидите, что есть строчка, которая
содержит efs.us-east-1.amazonaws.com.

00:12:14.000 --> 00:12:21.988
Также вы видите, что он примонтирован
к нашей папке, он находится

00:12:22.012 --> 00:12:30.000
по пути /home/ec2-user/efs наш
пользователь и папка EFS. Отлично.

00:12:30.000 --> 00:12:42.000
Давайте теперь введем несколько команд для
того, чтобы проверить работоспособность EFS.

00:12:42.000 --> 00:12:50.000
Воспользуемся инструментом fio, про который
мы говорили в обзоре лабораторной работы.

00:12:50.000 --> 00:12:55.988
Как только мы ее введем, начнется
процесс, займет некоторое время, порядка

00:12:56.012 --> 00:13:02.000
10 минут, для того, чтобы создать файл
размером 10 гигабайтов в нашем EFS.

00:13:02.000 --> 00:13:11.172
Как только отработает команда, вы увидите детали
запуска этого теста, нас интересует строчка, которая

00:13:11.196 --> 00:13:20.000
начинается на WRITE, мы видим, что io=10240MB,
то есть мы создали файл размером 10 гигабайтов.

00:13:20.000 --> 00:13:27.613
Далее мы видим agrb, это среднее
количество байтов, которые мы

00:13:27.637 --> 00:13:36.000
записывали в секунду, в нашем
случае это 103 мегабайта в секунду.

00:13:36.000 --> 00:13:43.009
Примерно те же значения мы видим
для minb и maxb, это минимальная и

00:13:43.033 --> 00:13:51.000
максимальная скорость записи, которая
была во время наших тестов. Отлично.

00:13:51.000 --> 00:13:56.583
Давайте теперь воспользуемся сервисом CloudWatch
для того, чтобы проверить, действительно

00:13:56.607 --> 00:14:02.000
ли мы с такой скоростью передавали, что мы
можем увидеть из AWS Management Console.

00:14:02.000 --> 00:14:06.988
Для этого в строке поиска сервисов
начнем вводить CloudWatch, можете

00:14:07.012 --> 00:14:12.000
также вводить любую последовательность
букв в рамках этого названия.

00:14:12.000 --> 00:14:17.488
Я обычно для сервисов состоящих из двух
слов начинаю вводить со второго слова,

00:14:17.512 --> 00:14:23.000
в этом случае большая вероятность того,
что не придется вводить целиком все слово.

00:14:23.000 --> 00:14:29.000
Поэтому если написать wat, вы увидите 
нужную ссылку. Давайте на нее перейдем.

00:14:29.000 --> 00:14:34.156
Как только вы окажетесь на основной
странице CloudWatch, в левом навигационном

00:14:34.180 --> 00:14:39.000
меню нужно будет выбрать Metrics
и дальше выбрать вкладку All metrics.

00:14:39.000 --> 00:14:46.526
На соответствующую странице необходимо будет
выбрать метрики, связанные с EFS, далее выбрать

00:14:46.550 --> 00:14:54.000
File system metrics и вы увидите 8 различных
метрик, связанных с нашей файловой системой.

00:14:54.000 --> 00:15:00.335
Давайте выберем метрику
PermittedThroughput, это какое количество

00:15:00.359 --> 00:15:06.000
мегабайтов, с какой скоростью
мы записывали на наш EFS.

00:15:06.000 --> 00:15:09.144
Как только вы ее выберете
отобразится график, если он не

00:15:09.168 --> 00:15:13.000
отобразился, подождите 2-3
минуты, после этого обновите страницу.

00:15:13.000 --> 00:15:20.000
Вы можете также мышкой выделить определенный
период времени на графике и он ее приблизит.

00:15:20.000 --> 00:15:32.988
Как только мы это сделаем, мы видим, что
график ровный, скорость не менялась, если навести

00:15:33.012 --> 00:15:46.000
на любую точку, мы видим 104800, это значит
примерно 105 мегабайтов была скорость записи.

00:15:46.000 --> 00:15:54.970
Если мы перейдем обратно на список
метрик и выберем уже другую метрику, в нашем

00:15:54.994 --> 00:16:05.000
случае DataWriteIOBytes, и уберем галочку с
предыдущей, то отобразится другой график.

00:16:05.000 --> 00:16:13.488
Здесь необходимо перейти на вкладку Graphed
Metrics, для столбца Statistic выбрать Sum, Period

00:16:13.512 --> 00:16:22.000
выбрать 1 minute, в верхней части страницы выбрать
один час, мы увидим метрики за последний час.

00:16:22.000 --> 00:16:29.657
Вы видите некоторый график, давайте
попробуем выбрать пиковое значение, у меня два

00:16:29.681 --> 00:16:38.000
пиковых значения, они совпадают, выбираю
любую и вижу следующее значение, это 6300000.

00:16:38.000 --> 00:16:45.595
Что это значит? Это значит, что 
в пиковое время мы записали

00:16:45.619 --> 00:16:54.000
такое количество килобайтов
или 6300000 байтов за одну минуту.

00:16:54.000 --> 00:16:58.992
Для этого как раз таки мы
как Statistic выбирали Sum и как

00:16:59.016 --> 00:17:04.009
Period - 1 minute, то есть все
те метрики, которые пришли

00:17:04.033 --> 00:17:09.192
связанные с количеством input
output операции в байтах, они

00:17:09.216 --> 00:17:15.000
агрегируются до одной минуты и
все эти значения они суммируются.

00:17:15.000 --> 00:17:19.988
Теперь что нам необходимо сделать?
Мы это значение можем поделить

00:17:20.012 --> 00:17:25.000
на 60 для того, чтобы посмотреть
какая скорость была в секунду.

00:17:25.000 --> 00:17:38.000
Вы получите значение те же 105 мегабайтов,
которые показали наши тесты в SSH сессии.

00:17:38.000 --> 00:17:43.058
Отлично, я вас поздравляю, мы
завершили все задания в рамках

00:17:43.082 --> 00:17:49.000
лабораторной работы, теперь
попробуем запустить процесс оценивания.

00:17:49.000 --> 00:17:57.686
Необходимо нажать на кнопку Submit, выйдет
сообщение, действительно ли мы хотим запустить

00:17:57.710 --> 00:18:06.000
этот процесс, нажимаем Yes и когда
отработают все тесты, мы увидим наши результаты.

00:18:06.000 --> 00:18:09.690
В моем случае, я набрал 15
баллов из 15, все задания были

00:18:09.714 --> 00:18:14.000
выполнены корректно, мы видим
три задания, которые оценивались.

00:18:14.000 --> 00:18:21.074
Я напоминаю, что если вы набрали не
максимальный балл, вы можете посмотреть в каком

00:18:21.098 --> 00:18:28.000
задании была ошибка, выполнить еще
раз и запустить процесс оценивания еще раз.

00:18:28.000 --> 00:18:36.000
Штрафных баллов не выдается, в случае успешного
 выполнения вы увидите обновленную оценку.

00:18:36.000 --> 00:18:42.000
Останавливать лабораторную работу
в этом случае нет необходимости.

00:18:42.000 --> 00:18:46.732
Отлично, на этом мы завершаем,
нам необходимо выйти правильно со

00:18:46.756 --> 00:18:51.488
всех систем, начнем с AWS
Management Console, в верхней правой

00:18:51.512 --> 00:18:56.358
части нажмем на название пользователя,
дальше в выпадающем списке

00:18:56.382 --> 00:19:01.000
нажмем на кнопку Sign out и
выйдем с AWS Management Console.

00:19:01.000 --> 00:19:06.522
Дальше возвращаемся на страницу лабораторной
работы, здесь необходимо также успешно

00:19:06.546 --> 00:19:12.000
завершить эту лабораторную работу,
поэтому необходимо нажать на кнопку End lab.

00:19:12.000 --> 00:19:16.268
Мы подтверждаем, что мы хотим
завершить лабораторную работу и

00:19:16.292 --> 00:19:20.988
как только вы увидите сообщение
о том, что мы можем закрывать эту

00:19:21.012 --> 00:19:25.283
страницу, что процесс удаления
ресурсов инициирован, вы можете

00:19:25.307 --> 00:19:30.000
закрыть эту страницу и закрыть
всю страницу с лабораторной работы.

00:19:30.000 --> 00:19:38.076
На этом я очень надеюсь, что вы получили более
полное представление о сервисе EFS. Если будут

00:19:38.100 --> 00:19:46.000
вопросы, задавайте. Спасибо за внимание,
увидимся с вами на следующих наших активностях!