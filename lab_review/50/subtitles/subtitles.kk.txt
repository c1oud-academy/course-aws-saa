Қайырлы күн, құрметті студенттер! Зертханалық жұмысты талдау сессиясында көргеніме қуаныштымын. Зертханалық жұмыстың тақырыбы – біздің бизнес кейсіміз, яғни кафеміз үшін статикалық веб-сайт құру. Бұл зертханалық жұмыс Challenge Lab болып табылады, сондықтан тапсырмада азырақ мәліметтер берілген. Енді барлық қажетті мәліметтерді ескере отырып, бірге орындап көрейік. Ендеше, бастайық. Зертханалық жұмысты талдауға кірісейік. Зертханалық жұмыстың негізгі парақшасын ашуымыз керек. Мұнда Start Lab батырмасын басайық, содан кейін қалқымалы терезе ашылады. Lab Status In Creation күйінен Ready күйіне ауысқанша күту керек. Содан кейін бұл парақшаны жауып, AWS батырмасын басамыз. Осы батырманы басқаннан кейін AWS Management Console негізгі парақшасына қайта бағытталамыз. Мұнда алдымен веб-сайтымыздың мазмұнын қамтитын zip архивін жүктеп алуымыз керек, оны компьютерде жергілікті түрде ашып, S3 бакетіне жүктеп салуға дайындаймыз. AWS Management Console ораламыз және мұнда Amazon S3 сервисін ашу керек. Ол үшін сервисті іздеу жолағына S3 деп енгізуді бастайық. Нәтижелерде қажетті сілтемені көреміз және оны басамыз. Amazon S3 сервисінің негізгі парақшасына өткеннен кейін бізде жүйелік бакет бар екенін көреміз. Оған мән бермейміз, бізге жаңасын құру керек. Сондықтан экранның оң жағындағы Create Bucket батырмасын басу керек. Оның атауы yelzhan-lab-review-50 болсын. Сіз кез келген басқа атауды жаза аласыз, ең бастысы, бұл S3 бакет атауы жаһандық бірегей болуы керек екенін есте сақтаңыз. Аймақ ретінде North Virginia таңдауыңыз керек. Бұл S3 бакеті жалпыға ортақ қолжетімділік үшін, атап айтқанда веб-сайтты орналастыру үшін пайдаланылатынын есте ұстаймыз. Сондықтан, Object Ownership бөлімінде ACLs Enabled параметрін таңдап, Object Ownership бөлімінде Bucket Owner Preferred белгіленгеніне көз жеткізіңіз. Әрі қарай, аздап төмен айналдырып, Block All Public Access опциясының құсбелгісін алып тастауыңыз керек. Төменде жалпы қолжетімділікті беретінімізді растап, құсбелгіні қоюымыз керек. Парақшаның ең төменгі жағына өтіп, Create Bucket батырмасын басыңыз. Бакеттердің тізімі бар парақшаға бағытталамыз. Бакет сәтті жасалғанын көрсететін жасыл өңі бар хабарды көресіз. Енді сол S3 бакетінің негізгі парақшасына өту үшін бакеттің атын шертейік. Содан кейін Properties қойындысын басуымыз керек. Мұнда төменге қарай жылжып, Static Website Hosting опциясын белсендіреміз. Қазіргі уақытта оның өшірілгенін көреміз, сондықтан Edit батырмасын басу керек. Сәйкес парақша ашылады. Enable опциясын таңдау керек. Содан кейін Hosting Type ретінде Host a Static Website таңдаймыз. Index Document ретінде index.html көрсетеміз. Error Document ретінде error.html көрсетіңіз және Save Changes батырмасын басыңыз. Мұны жасағаннан кейін Static Website Hosting опциясын белсендірдік, енді веб-сайтымыздың мазмұнын жүктеп салуымыз керек. Ол үшін Objects қойындысына өтіп, Upload батырмасын басыңыз. Бізде жеке файлдардан басқа папкалар да болғандықтан, Add Files және Add Folder батырмаларын пайдаланып, барлық қажетті файлдарды қоса аламыз. Сіз бұл файлдардың тізімін көресіз, жалпы салмағы шамамен 22 мегабайт болатын 10 объект бар. Егер бәрі сәйкес келсе, парақшаның төменгі жағындағы Upload батырмасын басу керек. Оны басқаннан кейін веб-парақшамыз қалай көрсетілетінін тексеруіміз керек. Properties қойындысын ашып, аздап төмен жылжып, Static Website Hosting бөліміне өту керек. Bucket website endpoint сол жерде орналасқан, оны көшіріп, браузердің жаңа қойындысында ашу керек. Оны ашқаннан кейін 403 қатесі пайда болғанын көреміз. Себебі, объектілерге әлі де жалпыға ортақ қолжетімділікті рұқсат бермегенбіз. Келесі тапсырмаға көшпес бұрын, енді тест сұрағына жауап беруіміз керек. Ол үшін зертханалық жұмыстың парақшасында Details батырмасын басыңыз. Ашылмалы тізім пайда болады, Show батырмасын басуыңыз керек. Қалқымалы терезеде мәтінді басыңыз, бұл Access the multiple choice questions сілтемесі. Бөлек қойынды ашылады, оны жабудың қажеті жоқ, оны зертханалық жұмыстың соңына дейін ашық ұстаймыз. Ал енді бірінші сұраққа жауап беруіміз керек. Бірінші сұрақ келесідей. Үшінші тапсырманы орындағаннан кейін веб-сайтыңызды браузердің бөлек қойындысында көре алдыңыз ба? Біз оны көре алмадық, сондықтан No, the files are not publicly accessible опциясын таңдаймыз. Submit батырмасын басып, жалғастырайық. Веб-сайтты көрсету үшін жалпыға қолжетімділікті қамтамасыз етуіміз керек. Бұл әрекетті орындау үшін, S3 бакетіміздің Objects қойындысында барлық объектілерді таңдап, Actions батырмасын басыңыз. Және ең соңғы пункт - Make public using ACL опциясын табамыз. Оны басу керек, содан кейін объектілерімізді жалпыға қолжетімді еткіміз келетінін растау керек. Мұны жасағаннан кейін веб-сайт парақшасына оралып, парақшаны жаңартсаңыз, веб-сайтымызды көреміз. Жақсы. Енді тәжірибе жасап, суреттері бар папканы қайтадан жүктеп алайық. Оны жүктеп алғаннан кейін, веб-сайтымызды ашып көрейік. Суреттердің бұзылғанын көруге болады, себебі қайта жүктеп салу папка мен файлдарға жалпы қолжетімділікті әдепкі мәнге өзгертті, яғни олар қорғалған және жеке болды. Оларды қайта көрсету үшін алдыңғы әрекетті қайта жасау керек. Бірақ бұл ыңғайсыз, сондықтан бизнес жағдайымызға сәйкес, София Bucket Policy жазуды шешті. Оны жазу үшін S3 бакетінің Permissions қойындысын ашып, Bucket Policy бөліміне өтуіміз керек. Оны қазір өзгертетін боламыз. Ол үшін Edit батырмасын басыңыз, сәйкес терезе ашылады. Мұнда AWS құжаттамасын оқып, сәйкес policy табу керек болды. Дұрыс жауап келесі құжат болып табылады. Мұнда Principal жұлдызша екенін, яғни ол кез келген анонимді Интернет пайдаланушысы екенін белгілейміз. Келесі - Effect: Allow, яғни тек Get Object әрекетіне рұқсат береміз, яғни бұл оқу режимі. Ал Resource ретінде бакет /* көрсетеміз, осылайша өзгертулер бакет ішіндегі объектілерге ғана әсер етеді. Жақсы. Парақшаның төменгі жағына жылжып, Save Changes батырмасын басыңыз. Келесі парақшада Bucket Policy сәтті өзгертілгені туралы хабарды көреміз. Бұл хабардың жасыл фоны бар. Сондай-ақ, бакет атауының жанындағы қызыл Publicly Accessible құсбелгісін көреміз. Жақсы. Енді веб-сайт парақшасын жаңартып көрейік. Міне, суреттеріміздің қайта оралғанын және бәрі дұрыс көрсетілетінін көреміз. Енді келесі тапсырмаға көшеміз. S3 бакетіндегі объектілердің кездейсоқ өшірілуден және кездейсоқ қайта жазылуынан қосымша қауіпсіздікті қамтамасыз етуіміз керек. Ол үшін Bucket versioning қосу керек. Properties қойындысындағы Bucket versioning бөліміне өтейік. Қазір оның өшірілгенін көріп отырмыз. Мұны өзгерту үшін Edit батырмасын басу керек. Бізде екі нұсқа бар екенін көріп отырмыз. Бұл Suspend немесе Enable. Ол қазір біз үшін қосылмағандықтан, Suspend нұсқасы логикалық тұрғыдан сәйкес емес. Енді versioning қосуымыз керек. Оны қосқаннан кейін өшіре алмайтыныңызды еске саламын. Жалғыз нұсқа кідірту болып табылады. Бұл жағдайда жаңа нұсқалар жасалмайды. Қажет болса, versioning қайта қосуға болады. Жақсы! Enable опциясын таңдап, парақшаның төменгі жағындағы Save changes батырмасын басыңыз. Енді versioning қалай жұмыс істейтінін тексеруіміз керек. Жергілікті компьютерде index.html файлымызды кез келген мәтіндік редакторда ашыңыз. Бізге bgcolor="aquamarine" екі мәнді және bgcolor="orange" бір мәнін табу керек болды. Бұл мәндерді тиісінше bgcolor="gainsboro" мәніне және bgcolor="orange" мәнін bgcolor="cornsilk" мәніне ауыстырыңыз. Мұны орындағаннан кейін, бакеттегі объектілер тізіміне өтейік, жаңартылған index.html файлын жүктеп салу үшін Upload батырмасын басыңыз. Оны жүктегеннен кейін веб-сайт парақшасын жаңартқаннан кейін парақшаның төменгі жағындағы блоктардың фоны өзгергенін көреміз. Жақсы. Енді index.html объектісінің негізгі парақшасын ашуымыз керек, содан кейін Versions қойындысын ашып, versioning шынымен қосылғанына көз жеткізуіміз керек. Қазіргі уақытта бізде екі нұсқа бар, ал қазіргісі біз жүктеп алған соңғы нұсқа. Енді тест сұрақтарымызға оралып, екінші сұраққа жауап беруіміз керек. Сұрақ мынадай болды. Қорғауды барынша арттыруға және S3 бакетіндегі объектілердің кездейсоқ жойылуын болдырмауға көмектесетін опцияны таңдаңыз. Қандай опциялар бар екенін көрейік. Бірінші - Cross-Region Replication. Бұл сәл сәйкес емес, ол деректерімізді тек басқа бакетке көшіреді, ал бұл файлдарды ағымдағы бакеттен жоюға болады. Тағы бір опция - Multi-Factor Authentication, MFA. Бұл дұрыс жауап, белгілейік. Неліктен ол дұрыс? Себебі, S3 бакетіндегі объектілерді жою кезінде MFA верификациясын байланыстыра аламыз. Бұл қалай болады? IAM User AWS Management Console қосылады, CLI арқылы болсын. Әрі қарай, MFA құрылғысын растау үшін уақытша жасалған кілтті енгізіңіз. Әдетте бұл виртуалды MFA құрылғысы, содан кейін пайдаланушы біраз уақыт MFA қажет болған әрекеттерді орындай алатыны белгіленеді. Бұл тексеру жою кезінде орын алады. Егер MFA сәтсіз болса, ол бұл объектілерді жоя алмайды. Тіпті MFA қосылмаған пайдаланушылар MFA арқылы қорғалған объектілерді жоя алмайды. Үшінші опция - Cross-Origin Resource Sharing CORS. Бұл екі веб-сайттың бір-бірімен өзара әрекеттесуіне көбірек қатысты, яғни қауіпсіздікке қатысты емес. Атап айтқанда, S3 бакетіндегі объектілерді жоюға қатысты қауіпсіздік емес. Ал төртіншісі – Bucket Policy. Бұл да біздің жағдайда сәйкес нұсқа емес. Жақсы. Екінші опцияны дұрыс деп белгілеп, Submit батырмасын басып, әрі қарай жалғастырайық. Келесі тапсырмаға көшеміз. Мұнда S3 бакетінде сақтау шығындарын оңтайландыру керек. Ол үшін Lifecycle Rules баптаймыз. Алдымен Management қойындысына өту керек. Бірінші бөлім - бізге қажет бөлім. Ол Lifecycle Rules деп аталады. Бізде ешқандай ережелер жасалмағанын көреміз, сондықтан Create Lifecycle Rule батырмасын басайық. Біз енгізу деректерін енгізуіміз керек тиісті парақшаға қайта бағытталамыз. Rule Name ретінде move-to-ia, яғни Infrequent Access көрсете аламыз. Choose a Rule Scope ретінде, Apply to all objects in the Bucket опциясын таңдаңыз, яғни ол бакеттегі барлық объектілерге қолданылады. Және растау жолағында белгілеу керек. Lifecycle Rule Actions ретінде екінші опцияны таңдауымыз керек. Бұл объектілердің ағымдағы емес нұсқаларын басқа Storage Class жылжытатынымызды білдіреді. Төмендегі келесі бөлімде осы сақтау класы туралы мәліметтерді беруіміз керек. Біздің жағдайда бұл Standard-IA, оған 30 күннен кейін ауысады. Осымен барлық қажетті деректерді енгіздік. Парақшаның төменгі жағына жылжып, Create Rule батырмасын басу керек. Lifecycle Rules тізімі бар парақшаға бағытталамыз. Жасалған Rule көрсетілгенін көреміз. Ол белсенді. Енді екіншісін жасауыңыз керек. Create Lifecycle Rule батырмасын басыңыз. Ұқсас парақша ашылады. Бұл жағдайда Rule Name ретінде delete-rule енгіземіз. Сондай-ақ, бұл бакеттегі барлық объектілерге қатысты екенін ескеріңіз және осы таңдауды растаңыз. Lifecycle Rule Actions үшін объектілердің барлық ағымдағы емес нұсқаларын жою керектігін айтатын үшінші опцияны таңдайық. Төменде осы Ереженің күшіне енетін күндер санын көрсету қажет. Бұл 365 күн. Осымен қажетті деректер енгізілді. Парақшаның төменгі жағында Create Rule батырмасын басыңыз. Жақсы! Тізімде біз жасаған екі рулды көресіз. Олардың екеуі де белсендірілген. Жалғастырайық. Келесі тапсырмаға көшейік. Мұнда Cross-Region replication теңшеу үшін басқа аймақта басқа бакет жасау керек. Amazon S3 сервисінің негізгі парақшасын ашыңыз. Create Bucket батырмасын басып, қажетті деректерін енгізіңіз. Мұнда Bucket Name көрсетеміз. Мен yelzhan-replication-destination-bucket деп көрсеттім. Ол бірегей. Аймақ ретінде Oregon көрсетіңіз. Бұл us-west-2. Төменде versioning қосамыз. Оны жасау үшін парақшаның ең төменгі жағындағы Create Bucket батырмасын басыңыз. Бакет сәтті жасалғанын көрсететін жасыл хабарламаны көреміз. Сондай-ақ, бакеттердің тізімінде бұрын жасалған негізгі бакет бар екенін көреміз. Ол North Virginia аймағында орналасқан. Біз екінші бакеттің жасалғанын көреміз. Ол Oregon аймағында орналасқан. Жақсы! Әрі қарай жүрейік. Енді негізгі S3 бакетінде Replication Rules баптау керек. Мұны істеу үшін S3 бакеті негізгі парақшасын ашыңыз, Management қойындысына өтіп, Replication Rules бөліміне өтіңіз. Қазір ережелер жоқ, Create Replication Rule батырмасын басамыз. Бөлек парақша ашылады. Бұл парақшада енгізу деректерін енгізу талап етіледі. Replication Rule Name ретінде replication-rule-1 көрсетеміз. Сіз кез келген басқа атауды көрсете аласыз. Status Enabled болады. Мұнда ештеңе өзгермейді. Source Bucket ретінде Choose a Rule Scope бөліміндегі Apply to all objects in the Bucket опциясын таңдауымыз керек. Осылайша, негізгі S3 бакетінде орналасқан барлық объектілер екінші S3 бакетіне көшіріледі. Әрі қарай, Destination ретінде Choose a Bucket in this Account опциясын таңдап, екінші жасалған S3 бакетін таңдауыңыз керек. Менің жағдайымда бұл yelzhan-replication-destination-bucket. Оны таңдағаннан кейін бұл бакеттің аймағы Destination Region бөлімінде көрсетіледі. Біздің жағдайда бұл Oregon. Барлығы дұрыс. Әрі қарай жүрейік. IAM role бөлімі репликация әрекеттерін орындайтын роль болып табылады. Зертханалық жұмыстың аясында біз үшін роль жасалып қойған. Сондықтан, Choose from existing IAM roles таңдаңыз және тізімнен CafeRole таңдаңыз. Осымен қажетті деректерді енгіздік. Парақшаның төменгі жағында Save батырмасын басыңыз. Жақсы. Енді сәйкес қойындыда S3 бакеті бар парақшаға бағытталамыз. Replication Rules тізімінде жасаған ереже бар екенін көреміз, ол Enabled күйде. Жақсы. Енді Replication Bucket бөліміне өтіп, қазір қанша объект бар екенін тексерейік. Қазір ол жерде ешқандай объект жоқ екенін көріп отырмыз. Ал енді тест сұрақтары жазылған парақшаға өтіп, үшінші сұраққа жауап беруіміз керек. Үшінші сұрақ. Негізгі бакеттегі объектілерді репликация жасалынатын бакетте көрдіңіз бе? Біз «жоқ» деп жауап береміз, өйткені файлдар пайда болмады және жауабымызды жібереміз. Енді мен бұл файлдардың неге ол жерде пайда болмағаны туралы түсініктеме берейін. Бәрі оңай. Шын мәнінде, файлдарымызды жүктеп салған кезде, Replication әлі іске қосылмаған болатын. Ол іске қосылған сәттен бастап, енді негізгі бакеттегі барлық өзгерістер Destination Bucket-те де пайда болады. Тексеріп көрейік. Ол үшін index.html файлында жергілікті түрде кез келген өзгертулер енгіземіз. Менің өзгертулерімді мына жерден көре аласыз. Содан кейін негізгі S3 бакетіне ораламыз және Upload батырмасын басыңыз. Әрі қарай, Add Files батырмасын басып, жаңартылған index.html таңдап, Open батырмасын басып, жүктеп алуды растаңыз. Егер index.html объектісі үшін нұсқалар тізімін ашсақ, бізде үш нұсқа бар екенін көреміз. Соңғы жүктеп алу - бұл файлдың ағымдағы нұсқасы. Енді, егер Cross-Region Replication арналған Destination Bucket болып табылатын екінші S3 бакетін ашсақ, бізде бір объект бар екенін көреміз. Бұл index.html. Бұл - Cross-Region Replication іске қосқаннан кейін жүктеп алған осы файлдың соңғы нұсқасы. Енді не істейміз? Негізгі S3 бакетінде index.html соңғы нұсқасын жоямыз. Ол үшін тізімнен соңғы нұсқаны таңдап, Delete батырмасын басыңыз. Объектілер тізімін растайтын бөлек парақша ашылады. Permanently Delete Objects? өрісінде бұл жоюды растап, permanently delete деп жазуыңыз керек. Delete Objects батырмасы іске қосылады. Басайық, ол алдыңғы парақшаға апарады. Мұнда екі нұсқа қалғанын көреміз. Алдыңғы нұсқа ағымдағы нұсқаға айналды. Жақсы. Енді екінші S3 бакетін ашып, парақшаны жаңартсақ, index.html әлі де бар екенін, жаңа нұсқалар қосылмағанын көреміз. Қазіргі уақытта index.html файлының үшінші нұсқасын көріп отырмыз. Енді тест сұрақтары бар парақшаны ашып, төртінші сұраққа жауап беріп көрейік. Сұрақ келесідей. Негізгі S3 бакетіндегі файл нұсқасын жойғаннан кейін, Destination Bucket-те объект жойылды ма? Біздің жағдайда жауап No. Неліктен бұл орын алғаны туралы түсініктеме берейін. Әдепкі бойынша, Delete маркерлер Replication Bucket-ке көшірілмейді. Сондықтан негізгі бакетте орын алған жою Replication, яғни Destination Bucket-ке әсер етпеді. Delete маркерлерді де Destination Bucket-іне тасымалдағыңыз келсе, қосымша қадамдарды орындап, осы опцияны қосуыңыз керек. Жақсы. Құттықтаймын. Осымен зертханалық жұмыстың барлық тапсырмаларын орындадық. Енді автоматты бағалау скриптін іске қосып, барлық тапсырмаларды дұрыс орындағанымызға көз жеткізуіміз керек. Ол үшін зертханалық тапсырмасы бар парақшада Submit батырмасын басу керек. Оны басқаннан кейін автоматты бағалауды бастағымыз келетінін растауыңыз керек. Мұнда біраз уақыт күтуіміз керек. Менің жағдайымда мен ең көп ұпай жинадым, 29-дан 29, бұл барлық тапсырмалардың дұрыс орындалғанын білдіреді. Жақсы. Енді барлық жүйелерді қауіпсіз түрде өшіруіміз керек. AWS аккаунтынан бастаймыз. Жоғарғы оң жақ бұрыштағы пайдаланушы атын басып, ашылмалы тізімдегі Sign out батырмасын басу керек. Мұны бірнеше рет жасадық, бірақ оны қайта-қайта ескеремін. Зертханалық жұмысының парақшасына ораламыз. Мұнда End lab батырмасын басып, зертханалық жұмысты аяқтағанымызды растауымыз керек және уақытша жасалған ресурстарды жою процесі басталғаны туралы хабарламаны көруіміз керек. Бұл терезені жауып, AWS Academy-ден шыға аламыз. Жақсы. Құттықтаймын. Осымен зертханалық жұмысты талдауды аяқтадық. Сізді қызықтыратын барлық сұрақтарға жауап бердік деп үміттенемін. Егер сізде әлі де сұрақтарыңыз болса, жазыңыз. Жауап беруге қуаныштымыз. Назарларыңызға рахмет. Келесі белсенділіктерде кездескенше.