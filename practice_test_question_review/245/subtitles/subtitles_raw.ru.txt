 Добрый день, уважаемые студенты! Мы с вами начинаем разбор вопроса практистеста. Согласно вопросу, компания настроила свою инфраструктуру в VPC с идроблоком следующим. Она таким образом подключается к локальному дата-центру. У вас есть следующее требование. Есть лямбда функция, которая обрабатывает некоторый объем криптовалютных транзакций каждую минуту и сохраняет результаты в EFS. После того как вы все настроили, подключили лямбда функцию к VPC, Solution Architect замечает, что в некоторые моменты времени, в течение дня, увеличивается количество ошибок на стороне лямбды с EC2 ошибкой, EC2 Rottled Exception и вам нужно выбрать два возможных варианта ответа, которые приводят к этой ошибке. На этом слайде вы видите все варианты ответов, также видите, что второй и четвертый является верными. Я бы хотел отметить, что этот вопрос является достаточно сложным. Он требует понимания взаимодействия нескольких AWS сервисов и в этом случае мы попробуем применить некоторую хитрость. То есть, зная некоторые основные моменты, связанные с AWS, мы можем исключить некоторые варианты ответов заведомо неверные. Таким образом оставить два либо три варианта ответов, которые могут быть верными и с этим увеличить вероятность того, что мы правильно ответим на этот вопрос. Такой подход к ответу он не запрещается, это нормально и вы как Solutions Architect должны уметь использовать все ваши знания для решения конкретной задачи. Итак, давайте пройдемся по каждому из неверных вариантов ответа и попробуем их с объяснением исключить. Первый вариант ответа говорит о том, что на стороне Security группы, подключенной к нашей Lambda функции, не достают некоторых рулов, а именно Outbound рулов. Согласно вопросу мы видим, что Lambda отрабатывает успешно, она обрабатывает все запросы и соответственно успешно записывает результаты на EFS. Только в некоторые моменты в течение дня выходят ошибки. Это говорит о том, что в целом сетап верный и мы упираемся в пиковые моменты, в некоторые другое ограничение, а с точки зрения выдачи доступов и прав все нормально. Таким образом первый вариант мы можем исключить. То же самое относится к пятому варианту, где рекомендуется посмотреть IAM-роль, подключенные к Lambda и удостовериться все ли необходимые права выданы. Так как Lambda функция работает успешно и только в некоторые моменты не работает, а роль наша она выдана и настроена в самом начале и в течение работы Lambda она не меняется. Таким образом этот вариант тоже мы можем исключить. Если мы говорим про третий вариант ответа, он утверждает, что у VPC нет NAT Gateway. NAT Gateway, вспомним, нужен для того, чтобы наши ресурсы в private subnet через public subnet могли подключаться к интернету. NAT Gateway либо NAT Instance они находятся в public subnet. Особенностью NAT Gateway является то, что ресурсы с private subnet могут обращаться к интернету, а из интернета к ресурсам из private subnet обратиться не могут, так как NAT Gateway это делать запрещает. Согласно вопросу, нам дают некоторые факт, что есть часть инфраструктуры, которая хостится на локальном дата центре и дальше эта идея не развивается, ничего не упоминается о том, что в рамках выполнения задачи мы обращаемся в локальный дата центр, поэтому это больше похоже как ложная информация, которая должна запутать нас. Зная, что мы с интернетом не работаем, внешних подключений не происходит, все происходит внутри нашего VPC, мы этот вариант также можем исключить. Остается второй и четвертый вариант, которые являются верными. Теперь давайте подробнее остановимся на верных вариантах ответа и почему они являются верными. Когда лямда подключается к VPC и начинает работать с ресурсами внутри VPC, при настройке мы передаем некоторые данные для лямды, в результате которого лямда получает некоторый IP-адрес. Мы с вами помним, что при настройке VPC, при настройке сабнетов мы всегда указываем cedar-блок. Cedar-блок определяет, какие IP-адреса и какое количество IP-адресов помещается внутри cedar-блока. Таким образом, зная, что лямда в пиковой нагрузке может легко масштабироваться, а так как она масштабируется в рамках VPC, ему нужны новые IP-адреса. Если этих новых IP-адресов не хватает по тем или иным причинам, лямда не может отработать, не может масштабироваться. Таким образом, вариант, где утверждается, что не хватает anis, то есть IP-адресов внутри subnet, является верным. Другой вариант является также верным, так как в нем говорится следующее. Мы настроили лямда функцию для работы с одной availability-зоной. И если бы мы настроили несколько availability-зон, то при нехватке IP-адресов в одной availability-зоне, он бы попробовал создать instance лямды в другом subnet, в котором достаточное количество свободных IP-адресов. На следующих слайдах вы увидите более полное объяснение этого вопроса, с которым вы не спеша можете ознакомиться. На этом мы разобрали вопрос практистеста. Спасибо за внимание.
