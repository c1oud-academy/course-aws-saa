1
0:00:00.000 --> 0:00:03.160
Добрый день, уважаемые студенты.

2
0:00:03.160 --> 0:00:07.400
Мы с вами начинаем разбор вопроса Практист-теста.

3
0:00:07.400 --> 0:00:10.460
Согласно вопросу, компания обслуживает клиентов по

4
0:00:10.460 --> 0:00:12.200
всему миру.

5
0:00:12.200 --> 0:00:18.580
Эти клиенты обращаются к данным компании, хранящейся

6
0:00:18.580 --> 0:00:20.680
на нескольких s3-бакетах.

7
0:00:20.680 --> 0:00:26.400
У каждого s3-бакета настроен CloudFront веб-дистрибьюшн и

8
0:00:26.400 --> 0:00:32.320
на текущий момент необходимо доставлять контент для

9
0:00:32.320 --> 0:00:38.160
специфичного клиента, чтобы только этот клиент мог

10
0:00:38.160 --> 0:00:42.320
добираться до данных компаний.

11
0:00:42.320 --> 0:00:47.340
На текущий момент все клиенты могут обращаться к данным

12
0:00:47.340 --> 0:00:53.680
через s3-юрл, а также через CloudFront-дистрибьюшн.

13
0:00:53.680 --> 0:00:58.440
Два отдельных urelle ссылки, по которым они могут обращаться

14
0:00:58.440 --> 0:01:01.480
и загружать данные.

15
0:01:01.480 --> 0:01:07.000
Вам необходимо как solution-архитекту настроить следующую архитектуру.

16
0:01:07.000 --> 0:01:14.240
Приватные данные должны передаваться только через

17
0:01:14.240 --> 0:01:18.320
CloudFront, так чтобы защитить распространение ваших

18
0:01:18.320 --> 0:01:19.320
файлов.

19
0:01:19.320 --> 0:01:23.680
С учетом этих ограничений, вам нужно из предложенных

20
0:01:23.680 --> 0:01:26.640
вариантов выбрать два варианта, которые помогают

21
0:01:26.640 --> 0:01:30.880
это все имплементировать.

22
0:01:30.880 --> 0:01:33.700
На этом слайде вы видите варианты ответов, также

23
0:01:33.700 --> 0:01:36.720
видите, что второй и третий являются верными.

24
0:01:36.720 --> 0:01:41.320
Давайте посмотрим на объяснение.

25
0:01:41.320 --> 0:01:46.160
Вы видите на картинке, что есть у нас с одной стороны

26
0:01:46.160 --> 0:01:49.480
наши пользователи, есть у нас данные в s3-бакете

27
0:01:49.480 --> 0:01:51.440
и есть промежуточный CloudFront.

28
0:01:51.440 --> 0:01:56.080
Это наш CDN, Content Delivery Network, который позволяет доставлять

29
0:01:56.080 --> 0:02:00.400
ваши данные из s3-бакета до ваших клиентов по всему

30
0:02:00.400 --> 0:02:02.240
миру с меньшими задержками.

31
0:02:02.240 --> 0:02:09.040
Таким образом, у пользователей есть возможность обращаться

32
0:02:09.040 --> 0:02:12.720
напрямую к s3, это будет медленнее, но есть такая возможность,

33
0:02:12.720 --> 0:02:15.440
а также есть возможность обращаться через CloudFront,

34
0:02:15.440 --> 0:02:16.440
это будет быстрее.

35
0:02:16.440 --> 0:02:24.840
�  что необходимо вам сделать в рамках задания, это дать

36
0:02:24.840 --> 0:02:31.160
возможность только специфичному клиенту обращаться через

37
0:02:31.160 --> 0:02:35.280
CloudFront к вашим данным в s3 и запретить пользователю

38
0:02:35.280 --> 0:02:38.760
обращаться к данным в s3 напрямую.

39
0:02:38.760 --> 0:02:49.080
Для этого существует два отдельных функционала.

40
0:02:49.080 --> 0:02:55.120
Для того, чтобы запретить прямой доступ к s3, необходимо

41
0:02:55.120 --> 0:03:01.560
настроить Origin Access Identity, OAE, так чтобы только у CloudFront

42
0:03:01.560 --> 0:03:04.440
Distribution была возможность обращаться к данным в

43
0:03:04.440 --> 0:03:09.520
s3, для всех остальных внешних обращений к s3 данным доступ

44
0:03:09.520 --> 0:03:10.520
будет запрещен.

45
0:03:10.520 --> 0:03:14.320
Это первый вариант, правильный вариант ответа.

46
0:03:14.320 --> 0:03:17.720
Если мы говорим про второй, необходимо на уровне CloudFront

47
0:03:17.720 --> 0:03:22.280
настроить так называемые Signed Urals или Signed Cookies,

48
0:03:22.280 --> 0:03:27.200
которые предоставляют выборочный доступ для клиентов, пользователей

49
0:03:27.200 --> 0:03:28.200
вашего приложения.

50
0:03:28.200 --> 0:03:33.640
�  в первом случае, когда мы говорим про Signed URL, генерируется

51
0:03:33.640 --> 0:03:40.920
специальная ссылка, у нее есть время жизни, есть полиси,

52
0:03:40.920 --> 0:03:44.360
которым прописано кому и как вы предоставляете доступ.

53
0:03:44.360 --> 0:03:49.640
Передав эту ссылку, все ваши клиенты и пользователи

54
0:03:49.640 --> 0:03:53.560
с этой ссылкой могут без каких-либо препятствий обращаться

55
0:03:53.560 --> 0:03:54.560
к вашим данным.

56
0:03:54.560 --> 0:03:58.480
У всех других, у которых есть старая ссылка, но

57
0:03:58.480 --> 0:04:03.000
при этом не прописаны некоторые данные, касающиеся Signed

58
0:04:03.000 --> 0:04:05.360
URL, доступ будет запрещен.

59
0:04:05.360 --> 0:04:08.840
То же самое относится к Signed Cookies, работает немного

60
0:04:08.840 --> 0:04:09.840
по-другому.

61
0:04:09.840 --> 0:04:18.800
� дея в том, что вы при обращении к странице для ваших пользователей

62
0:04:18.800 --> 0:04:23.680
в их браузерах для вашего сайта, прописываете некоторые

63
0:04:23.680 --> 0:04:28.240
куки и в момент обращения проверяете есть ли нужные

64
0:04:28.240 --> 0:04:32.600
вам куки и есть ли необходимые правильные значения у

65
0:04:32.600 --> 0:04:33.600
этих куки.

66
0:04:33.600 --> 0:04:37.240
Если все совпадает все отлично, доступ предоставляется

67
0:04:37.240 --> 0:04:41.440
и по прямой ссылке пользователи могут дальше продолжать

68
0:04:41.440 --> 0:04:43.080
обращаться к вашим данным.

69
0:04:43.080 --> 0:04:47.400
Для всех других пользователей, у которых нет необходимых

70
0:04:47.400 --> 0:04:50.960
куки файлов, они получат сообщение об ошибке, что

71
0:04:50.960 --> 0:04:51.960
доступ запрещен.

72
0:04:51.960 --> 0:04:58.560
Давайте теперь подробнее остановимся на неверных

73
0:04:58.560 --> 0:04:59.560
вариантах.

74
0:04:59.560 --> 0:05:03.280
Первый неверный вариант упоминает сервис AWS App Mesh.

75
0:05:03.280 --> 0:05:08.280
В этом случае он нам не подходит, так как App Mesh это тот сервис,

76
0:05:08.280 --> 0:05:14.160
который предоставляет нам возможность удобного

77
0:05:14.160 --> 0:05:17.960
нетверкинга на уровне наших приложений.

78
0:05:17.960 --> 0:05:22.120
Когда мы говорим про AWS Cloud Map, аналогичный сервис.

79
0:05:22.120 --> 0:05:27.800
� дея в том, что в Cloud Map мы храним название и расположение

80
0:05:27.800 --> 0:05:30.800
наших приложений, ресурсов, компонентов.

81
0:05:30.800 --> 0:05:33.920
�  таким образом это центральное место, куда другие ваши

82
0:05:33.920 --> 0:05:37.480
приложения, компоненты могут обращаться для поиска

83
0:05:37.480 --> 0:05:40.000
других частей вашей IT инфраструктуры.

84
0:05:40.000 --> 0:05:43.920
Если мы говорим про третий неверный вариант, он в теории

85
0:05:43.920 --> 0:05:47.560
мог бы быть верным, если бы не ограничение в вопросе.

86
0:05:47.560 --> 0:05:51.440
В вопросе сказано, что мы должны передавать приватный

87
0:05:51.440 --> 0:05:55.440
контент через CloudFront для того, чтобы обезопасить

88
0:05:55.440 --> 0:05:57.520
распространение наших данных.

89
0:05:57.520 --> 0:05:59.720
Поэтому этот вариант не подходит.

90
0:05:59.720 --> 0:06:02.080
Давайте подробнее расскажу о нем.

91
0:06:02.080 --> 0:06:05.880
Здесь упоминается, что мы могли бы настроить S3 Presigned

92
0:06:05.880 --> 0:06:09.440
URL и через нее предоставлять доступ клиентам, а также

93
0:06:09.440 --> 0:06:17.120
для S3 запретить доступ ко всем остальным источникам.

94
0:06:17.120 --> 0:06:20.000
В этом случае запрещается в том числе доступ для CloudFront

95
0:06:20.000 --> 0:06:25.200
и через CloudFront уже обслуживать трафик к S3 не получится.

96
0:06:25.200 --> 0:06:33.040
Более того, у вас может начать путаница, что здесь

97
0:06:33.040 --> 0:06:37.360
Presigned URL чуть выше на уровне CloudFront.

98
0:06:37.360 --> 0:06:38.360
Да, так и есть.

99
0:06:38.360 --> 0:06:43.480
Presigned URL доступен как для S3, так и для CloudFront.

100
0:06:43.480 --> 0:06:46.120
На стороне CloudFront это более продвинутое решение.

101
0:06:46.120 --> 0:06:49.800
Более того, на стороне CloudFront можно настроить Signed Cookies

102
0:06:49.800 --> 0:06:58.640
и в целом функционал при работе с CloudFront намного

103
0:06:58.640 --> 0:06:59.640
продвинутый.

104
0:06:59.640 --> 0:07:07.200
� сходя из ограничений вопроса, таким образом мы говорим

105
0:07:07.200 --> 0:07:08.200
вопрос.

106
0:07:08.200 --> 0:07:13.200
Этот вариант ответа является неверным.

107
0:07:13.200 --> 0:07:15.720
На этом мы разобрали вопрос Практиз Теста.

108
0:07:15.720 --> 0:07:22.720
Спасибо за внимание.
