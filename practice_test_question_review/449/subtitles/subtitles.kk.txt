Қайырлы күн, құрметті студенттер! Біз Practice Test сұрағын талдауды бастаймыз. Сұрақтың шарты бойынша, компания өзінің қосымшасын EC2 инстанстарында орналастырады. Бұл автоматы масштабтау үшін Auto Scaling group пайдаланады. Application Load Balancer жүктемені бөлу үшін пайдаланылады және мұның барлығы бірнеше availability zone-да жұмыс істейді. Қолданба жұмыс істеп тұрғанда, health check «Сәтті емес» деп жауап бергендіктен, Application Load Balancer бірнеше инстансты автоматты түрде тоқтатты. Сондықтан инстанстар дереу жойылды. Сондай-ақ, CloudWatch Logs-қа жүктелуге үлгермеген қалған журналдар да инстанспен бірге жойылды. Ұсынылған нұсқалардың ішінен ең оңай жолды таңдау қажет, ол EC2 инстансын жою алдында барлық log-тарды жүктеп алуға мүмкіндік береді. Бұл слайдта сіз жауап нұсқаларын көресіз, олар өте ауқымды. Бұл сұраққа дұрыс жауап төртінші нұсқа екенін де көресіз. Дегенмен, жауап нұсқаларын талдап көрейік. Ауқымды жауап нұсқалары бар сұрақ келген кезде, мен әр нұсқаны бөлек оқымай, бірден жауап нұсқаларын салыстыруды ұсынамын. Салыстыра отырып, логикалық тұрғыдан сәйкес келмейтін немесе сенімді емес кейбір нұсқаларды бірте-бірте алып тастайтын боласыз. Бұл сұраққа нақты AWS емтиханында болғандай жауап беруге тырысайық. Барлық нұсқалардың бірінші сөйлемін оқысақ, олардың екінші нұсқадан басқасының барлығы ұқсас екенін көреміз, екінші нұсқа Auto Scaling group үшін инстанстарды Terminating күйінен Pending:Wait күйіне ауыстыратын lifecycle hook жасауды ұсынады. Барлық басқа нұсқаларда ол Terminating күйінен Terminating:Wait күйіне өзгертеді. Бұл жерде логикалық тұрғыдан анықтауға болады, Pending:Wait қате жауап, өйткені сұрақ авторларының міндеті дұрыс жауапты мүмкіндігінше тереңірек жасыру. Сондықтан біз екінші жауапты алып тастай аламыз. Сонымен қатар, егер логикалық тұрғыдан ойласақ, қолданба жұмысын тоқтатып, оны Terminating күйіне көшірсек, оны Pending:Wait күйіне көшіргенде келесі күй Running болады. Ал егер ол жұмыс істемесе, оны қайта іске қосудың қажеті жоқ. Сондықтан, нақты өшірілудің алдында біраз уақыт бөлу үшін Terminating күйінен Terminating: Wait күйіне көшу дұрысырақ. Бізге бірінші, үшінші және төртінші жауап нұсқалары қалды. Екінші сөйлем бізге CloudWatch Events Rule баптау керектігін айтады. Ол EC2 Instance-terminate Lifecycle Action, немесе EC2 Instance Terminate Successful оқиғасына байланыстырылуы керек. Үшінші жауап CloudWatch Events Rule орнатпай-ақ, бірден Step Functions орнатуды ұсынады. Біз үшінші нұсқаны алып тастай аламыз, өйткені Step Functions өзі EC2 инстансы Terminating: Wait күйіне өтіп жатқанын түсінбейді және онымен бірдеңе істеу керек. Сондықтан біз бұл нұсқаны алып тастаймыз. Сонымен қатар, Step Functions өзі ешқандай әрекеттерді орындамайды, ол үшін сіз Step Functions аясында Lambda жасайсыз. Егер сіз Lambda бірінші және төртінші нұсқада айтылғанын байқасаңыз, бірақ төртінші жағдайда ол Step Functions пайдаланбайды, яғни ол әлдеқайда қарапайым. Step Functions іске асыруға күрделілік қосады. Сұрақ аясында біз ең қарапайым шешімді таңдауымыз керек еді, сондықтан үшінші жауап нұсқасын да алып тастадық. Бірінші және төртінші жауап нұсқалары қалады. Енді оқиғаның өзіне назар аударатын болсаңыз, төртіншісі EC2 Instance-terminate Lifecycle Action оқиғасына байланысты. Оқиға инстанстың Terminate күйіне өтіп жатқанын және осы сәтте онымен бірдеңе жасау керектігін көрсетеді. Ал бірінші жауапта оқиға басқаша. Онда EC2 инстансы сәтті өшкені және одан кейін event келгені айтылады. Логикалық тұрғыдан, бірінші нұсқаны алып тастауға болады, өйткені инстансты тоқтатқаннан кейін біз онымен ештеңе істей алмаймыз. Бізге оның іске қосулы болғаны қажет. Сондықтан жауап нұсқаларын толық оқымай, төртінші жауап нұсқасының дұрыс екенін анықтауға тырыстық. Егер сіз оны соңына дейін оқысаңыз, бізден Lambda баптауды ұсынады. Ол EC2 Instance-terminate Lifecycle Action оқиғасына байланысты және осы rule-дың target-і Lambda функциясы болып табылады. Lambda функциясы, өз кезегінде, EC2 инстансындағы CloudWatch Agent-ке қосылады. Және log-тардың келесі тобының жіберілуін күтпестен, ол қалған және әлі жіберілмеген log-тарды жіберу командасын іске қосуға мәжбүр болады. Барлық log-тар CloudWatch Logs-қа сәтті жіберілгеннен кейін, Lambda және EC2 инстансын тоқтатуға болады. Себебі барлық log-тар CloudWatch Logs-та жинақталған және бұл мәселенің не екенін анықтауға және оны шешуге жеткілікті. Келесі слайдтарда сіз осы мәселенің мәтіндік талдауын көресіз. Осымен Practice Test сұрағын талдауымыз аяқталды. Назарларыңызға рахмет.