Қайырлы күн, құрметті студенттер! Келесі «Зертханалық жұмысқа кіріспе» сессиясында көргеніме қуаныштымын. Бүгінгі зертхананың тақырыбы - Amazon Elastic File System немесе қысқаша Amazon EFS сервисіне кіріспе. Ендеше, бастайық. Зертханалық жұмысты AWS Academy Cloud Architecting курсының негізгі парақшасынан бастайық. Сол жақ шарлау мәзірінде Modules қойындысын таңдап, 4-ші Adding a Compute Layer басамыз және белсенділік ретінде Guided Lab – Introducing Amazon Elastic File System таңдаймыз. Зертханалық жұмыстың негізгі парақшасына өту үшін оны шертейік. Мұнда тапсырма толығымен бүкіл парақшаға көрсетілетіндей етіп Terminal терезесінен құсбелгіні алып тастау керек. Жалғастырайық. Зертханалық жұмысты 20 минутта орындау ұсынылады. Зертханалық жұмыстың аясында біз өзіміздің EFS жасаймыз. Әрі қарай, SSH арқылы EC2 инстансына, содан EFS-ке қосылып көреміз. Осыдан кейін құрылған EFS-тің кейбір өнімділік сынақтарын өткізетін боламыз. Естеріңізге сала кетейін, зертханалық жұмыстарға қатысы жоқ сервистерге кейбір шектеулер болады. Бұл қалыпты жағдай, өйткені біз AWS Academy құм жәшігінде жұмыс істейміз. Зертханалық жұмысты бастау үшін Start Lab батырмасын басу керек. Арнайы терезе ашылады. Бұл терезе AWS аккаунтының іске қосылу күйін көрсетеді. Бұл аккаунт дайын екендігі туралы хабарды көргенде, бұл қалқымалы терезені жаба аламыз. AWS Management Console негізгі парақшасына өту үшін AWS батырмасын басу керек. Сонымен, бірінші тапсырманың егжей-тегжейлерін зерттей бастаймыз. Мұнда EFS жүйесіне қол жеткізу үшін Security Group құруымыз керек. Атап айтқанда, 2049 порты арқылы Inbound TCP қосылымдарына рұқсат етілген Security Group жасаймыз. Бұл NFC пайдаланатын дәл сол порт. Мұны істеу үшін AWS Management Console іздеу жолағына EC2 деп теруді бастау керек. Іздеу нәтижелерінде қажетті сервисті көреміз және оны басыңыз. Немесе Services батырмасын пайдаланып, үлкен ашылмалы мәзірден EC2 сервисін тауып көруге болады. Сізге қайсысы ыңғайлы соны қолдана бересіз, екі нұсқа да дұрыс. EC2 сервисінің негізгі парақшасын ашқанда, сол жақ шарлау мәзірінде Security Groups қойындысын басу керек. Осы аккаунттағы бар Security Groups тізімін көресіз. Бізді EFS Client деп аталатын Security Group қызықтырады, оны таңдауымыз керек және мәліметтері бар терезе пайда болған кезде оның ID көшіріп алу керек. Мұны орындағаннан кейін жаңа Security Group құруға кірісеміз. Ол үшін Create Security Group батырмасын басу керек. Бұл ресурсты жасау үшін келесі мәндерді енгізуге болады. Security Group Name - EFS Mount Target болады. Description ретінде Inbound NFS Access from EFS Clients деп көрсетеміз. VPC ретінде ашылмалы тізімнен Lab VPC таңдау керек. Әрі қарай, аздап төмен айналдырыңыз, rules орнатуға арналған арнайы бөлім болады, Inbound rules және Outbound rules. Бізді Inbound rules қызықтырады. Add Rule батырмасын басу керек. Бір жол қосылады. Бұл жолда NFS параметрін таңдап, Source ретінде Custom таңдаңыз. Мұны істегеннен кейін, Custom Box жолағына бұрын көшірілген Security Group ID енгізіп, пайда болатын Security Group таңдау керек. Содан кейін Create Security Group батырмасын басыңыз. Енді келесі тапсырмаға көшеміз. Мұнда EFS файлдық жүйесін жасаймыз. Теориялық тұрғыдан бір-екі мәселе айтқым келеді. EFS әр түрлі availability zone-дарда, бірақ бір AWS аймағында орналасқан бірнеше EC2 инстанстарына байланыстырылуы мүмкін. Файлдық жүйені инстанстарға қосу үшін mount targets қолданылады. Бұл - әрбір availability zone-дарда жасалынатын ресурстар. Бұл NFC стандартының 4 нұсқасы аясында қажет. Сондай-ақ, EFS бір уақытта тек бір VPC-ге қосылуы мүмкін екенін есте ұстаған жөн. Егер сізге EFS-ті басқа VPC-де орналасқан инстанстарға қосу қажет болса, бірінші VPC-ден ажырату керек. Әрі қарай, екінші VPC инстанстарына қосыласыз. EFS файлдық жүйесі мен VPC арасындағы байланысты баптау үшін бір AWS аймағында болуы керек екенін тағы бір рет атап өткім келеді. Сонымен, тапсырманы бастаймыз. Ол үшін сервистерді іздеу жолағына EFS деп теруді бастау керек, нәтижелерден қажеттісін таңдап, сервиске өтіңіз. Ашылған парақшада файлдық жүйемізді құруды бірден бастай аламыз. Ол үшін Create File System батырмасын басыңыз. Ашылған парақшада Customize опциясын таңдап, бірінші қадамда кейбір мәндерді енгізуді бастаңыз. Enable automatic backups өрісінен құсбелгіні алып тастау керек. Әрі қарай, Lifecycle Management өрісінде None опциясын таңдау керек. Мұның бәрі зертханалық жұмысымыз аясында қажет емес. Болашақта бизнес мәселеңізге негізделесіз. Қажет болса, бұл параметрлерді енгізесіз. Key: Name; Value: My First EFS File System тегін қосу керек. Барлығын енгізгеннен кейін, қалған мәндерді әдепкі ретінде қалдырып, екінші параметрлер парақшасына өту үшін Next батырмасын басыңыз. Мұнда VPC үшін алдын ала жасалған Lab VPC таңдауыңыз қажет. Әрі қарай әрбір availability zone үшін default security group тағайындалғанын көресіз. Оларды жою үшін X батырмасын басу керек. Енді бұрын жасалған security group әрбір availability zone-ға байланыстырамыз. Ол үшін сәйкес өрістерде EFS Mount Target security group таңдау керек. Осының барлығын орындағаннан кейін парақшаның осы бөлігі қандай болуы керек екендігі туралы мысал ұсынылады. Егер ол сәйкес келсе, сіз бәрін дұрыс жасадыңыз және келесі, үшінші парақшаға өтуіңізге болады. Ол үшін Next батырмасын басыңыз. Үшінші парақшада ештеңені өзгертудің қажеті жоқ, сондықтан Next батырмасын қайтадан басып, төртінші парақшаға өтеміз. Біз енгізген барлық параметрлер осы жерде көрсетіледі. Зертханалық тапсырмада көрсетілгендей барлығының сәйкестігін тексереміз. Егер бәрі жақсы болса, Create батырмасын басыңыз. EFS жасау екі-үш минутқа дейін біраз уақытты қажет ететінін ескеріңіз. Сондықтан, біз барлық файлдық жүйелері бар парақшаны жаңартып, оның күйінің Available күйіне өзгеруін күтуіміз керек. Осыдан кейін келесі тапсырмаға көшуге болады. Енді үшінші тапсырмаға көшеміз. Мұнда EC2 инстансына SSH арқылы қосылуымыз керек. Бұл тапсырма екі тәуелсіз бөлікке бөлінген. Бірінші бөлімде Windows операциялық жүйесі бар пайдаланушыларға арналған нұсқаулар сипатталған. Екінші бөлім, егер сіздің құрылғыңыз, компьютеріңіз немесе ноутбук macOS немесе Linux операциялық жүйесінде жұмыс істесе. Олай болса, бірінші бөлімді өткізіп, екіншісіне өтуге болады. Сонымен, SSH арқылы EC2 инстансына қосылу үшін не істеу керек? Ең алдымен, private key жүктеп алуымыз керек. Ол үшін зертхана парақшасындағы Details батырмасын басыңыз. Ашылмалы мәзірде Show батырмасын басыңыз. Арнайы парақша ашылады. Мұнда Download PPK сілтемесі болады, оны басқанда private key жүктеліне бастайды. Ол labsuser.ppk деп аталады. Оны компьютеріңізге жергілікті түрде жүктеп алуыңыз керек. Әрі қарай, AWS Management Console оралуымыз керек. Жалғыз EC2 инстансын тауып, оның мәліметтерін ашып, жалпыға ортақ IP-адресін сақтаңыз. Мұны орындағаннан кейін арнайы PuTTY бағдарламасын аша аламыз. Егер сізде ол орнатылмаған болса, осы бағдарламаны табу, жүктеп алу және орнату үшін батырманы басуға немесе іздеу жүйесін пайдалануға болады. Бағдарлама стандартты орнатуды қажет етпейді. Әдетте, файлды іске қосқаннан кейін бағдарлама бірден ашылады және пайдалануға дайын болады. Файлды ашқан бойда кейбір параметрлерді енгізу керек, атап айтқанда Connection қойындысында сеанс ұзағырақ жұмыс істеуі үшін Seconds between keepalives өрісіне 30 мәнін енгізу керек. Әрі қарай Session қойындысына өту керек, бұл негізгі қойынды. Host Name or IP address өрісіне бұрын көшірген инстанстың IP-адресін қою керек. Әрі қарай, жеке кілтке жолды көрсету керек, мұны істеу үшін сол жақ шарлау мәзірінде Connection қойындысына өтеміз, оның ішінде SSH қойындысы, содан кейін Auth және соңғы Credentials болады. Оны басқаннан кейін осы параметрлерге байланысты негізгі парақша ашылады, Private key file for authentication өрісінде Browse батырмасын басып, labsuser.ppk файлын таңдауыңыз керек. Мұны істегеннен кейін Open батырмасын басуға болады, бұл файл таңдалады, Open батырмасын қайтадан басыңыз және оны басқаннан кейін қосылымы бар бөлек терезе ашылады, сіз осы серверге шынымен сенесіз бе деген хабарлама келеді, біздің жағдайда иә, сенеміз және Accept батырмасын басыңыз. Сізден пайдаланушы login енгізу сұралады, Linux OS негізіндегі барлық EC2 инстанстары үшін әдепкі пайдаланушы ec2-user болып табылады, оны енгізейік, Enter батырмасын басыңыз, содан кейін welcome хабары және prompt көрсетіледі, командаларыңызды енгізуге болады. Енді macOS, Linux операциялық жүйесі бар пайдаланушылар орындауы керек қадамдарды қарастырайық. Мұнда кілтті басқа форматта жүктеп алу керек, ол үшін зертханалық жұмыс парақшасындағы Details батырмасын басу керек, содан кейін Show батырмасын басыңыз, ашылған парақшада Download PEM батырмасы пайда болады, яғни бұл ppk емес, pem форматы, оны басқаннан кейін ол labsuser.pem файлын сақтауға арналған парақшаны ашады, оны компьютеріңізде жергілікті түрде сақтайық, содан кейін AWS Management Console-де EC2 сервисіне өтіп, сол жерден EC2PublicIP инстансын тауып, осы инстанстың егжей-тегжейіндегі жалпыға ортақ IP-адресін көшіруіміз керек. Бұл инстанстың IP-адресі жеке кілтті жүктеп алатын парақшада да болуы мүмкін, егер ол қолжетімді болса, оны сол жерден көшіруге болады. Кілтті жүктеп алғаннан кейін, пайдаланушының директорийінде cd ~/Downloads өтіп, labsuser.pem папкасы бар екеніне көз жеткізуге болады. Оны пайдалану үшін тиісті құқықтарды орнатуымыз керек, сондықтан келесі chmod 400 labsuser.pem командасын енгіземіз. Кейін қашықтағы серверге қосылу командасын енгізу керек болады, бұл команданы экранда көресіз ssh -i labsuser.pem, private key көрсетіп, ec2- user@ <public-ip> инстансымыздың IP-адресін енгізіңіз. Сондай-ақ, бұл қосылымға сенетіндігіңіз туралы ескерту хабары болса, біз Yes батырмасын басамыз, кейін EC2 инстансы бар парақшаға қайта бағытталып, командаларыңызды енгізуді бастай аласыз. Енді төртінші тапсырмаға көшеміз, жаңа директорий жасап, оған EFS файлдық жүйемізді тіркеу керек. Ең алдымен, SSH session-де sudo mkdir efs командасын енгізейік, бұл EFS папкасын жасайды, содан кейін AWS Management Console өту керек, сол жерден EFS сервисіне өтіп, пайда болған EFS файлдық жүйелерінің тізімінде біз бұрын жасағанды таңдаңыз, ол My first EFS file system деп аталады. Оны таңдаған бойда жоғарғы оң жақтағы Attach батырмасы белсенді болады, оны шертеміз, басқаннан кейін әртүрлі командалары бар қалқымалы терезе пайда болады. Бізді Using the NFS client бөлімі қызықтырады, бұл осы EFS үшін дайындалған арнайы команда, оны NFS client арқылы EC2 инстансына қосады, оны көшіріп, SSH сеансымызға енгізейік. Сондай-ақ, слайдта көрсетілген командаларды енгізу арқылы қосылымның сәтті болғанын тексере аламыз. Нәтижесінде сіз файлдық жүйелердің тізімін көресіз, олардың біреуінің атауында EFS бар, сіздің аймағыңыз amazonaws.com болып табылады, nfs4 түрін көресіз, ол тіркелген папканы көресіз. Ол /home/ec2-user/efs болуы керек, бұл біз бұрын жасаған папка. Біз зертханалық жұмысымыздың соңғы бөліміне жеттік, бұл бесінші тапсырма, мұнда EFS файлдық жүйесінің қаншалықты жақсы жұмыс істейтінін көру үшін жасанды сынақтарды, енгізу/шығару операцияларын, IO операцияларын жасаймыз. Бізге Flexible IO (fio) құралы көмектеседі, ол операциялық жүйеде бұрыннан бар және оны қосымша орнатудың қажеті жоқ. Сіз 10 гигабайт өлшемі бар файлды жасайтын дайын команданы көресіз, бұл файлды тікелей EFS ішінде жасаймыз және осылайша EC2 инстансы мен EFS файлдық жүйесі арасында деректерді қаншалықты жылдам тасымалдай алатынымызды көреміз. Команданы орындау біраз уақытты алуы мүмкін, орташа есеппен 5-10 минут, сондықтан команданы қосқаннан кейін қысқа үзіліс жасап, біраз уақыттан кейін қайта оралуға болады. Сіз оралған бойда осы сынақты іске қосудың егжей-тегжейлерін көресіз, бізді соңғы жол қызықтырады, ол WRITE деп басталады және мұнда io = 10,240 МБ көресіз, бұл бүкіл файлдың 10 гигабайтын, содан кейін aggrb көресіз, файлды жасау кезіндегі жазу жылдамдығы, біз оның секундына 20 мегабайттан аз жылдамдықпен жасалғанын көреміз, minb және maxb үшін де байланысты, жазу кезіндегі ең төменгі және максималды жылдамдық және сіз бұл файлды жазуға қанша уақыт кеткенін көре аласыз. Енді Amazon CloudWatch сервисінде қол жетімді көрсеткіштерді қарастырайық, ол үшін оны сервистер тізімінен немесе сервистерді іздеу жолағынан тауып, осы сервиске өтеміз. Сол жақ шарлау мәзіріне кірген бойда, Metrics қойындысына өту керек, парақша ашылады, ол жерде All metrics тармағын, EFS параметрін, содан кейін File system metrics тармағын таңдау керек. Көрсеткіштердің толық тізімі ашылады, PermittedThroughput параметрін таңдауымыз керек, оны басқаннан кейін экранның жоғарғы жағында график сызылады, ештеңе көрінбесе, біраз күтіңіз. Екі-үш минуттан кейін парақшаны жаңартып, график бар екенін көресіз. Тінтуірді осы графиктің кез келген жеріне апарсаңыз, 105 мегабайт мәнін көресіз, бұл біздің файлды жасау жылдамдығы. Бұл бос, жаңадан жасалған EFS үшін рұқсат етілген ең жоғары жазу жылдамдығы. EFS өлшемі ұлғайған сайын жазу мен оқуға рұқсат етілген жылдамдықтың да арта түсетінін ескеріңіз. EFS неғұрлым үлкен болса, соғұрлым оның өткізгіш қабілеті артады. All metrics tab қойындысына оралайық, PermittedThroughput көрсеткішінен құсбелгіні алып тастап, DataWriteIOBytes көрсеткішін таңдаңыз. Оны таңдағаннан кейін басқа диаграмманы көресіз. Кейбір нақтылауларды енгізейік, атап айтқанда, Graphed metrics tab қойындысына өтіңіз. Содан кейін, Statistics ретінде Sum таңдаңыз, Period ретінде 1 минутты көрсетіңіз және тінтуірді ең жоғары мәнге апарыңыз. Мысалда 6000 мәнін көруге болады. Бұл мәнді 60-қа бөлетін болсақ, онда шамамен SSH сессиясында сынақта көрсетілген мәнді аламыз. Осымен зертханалық жұмысымызды аяқтадық. Құттықтаймын. Енді тексерісті өткізіп көрейік және барлық тапсырмаларды дұрыс орындағанымызға көз жеткізейік. Ол үшін Submit батырмасын басып, растау хабарламасындағы Yes батырмасын басыңыз. Барлық тексерулер аяқталғаннан кейін біраз уақыттан кейін Grades қойындысы көрсетіледі. Онда барлық мәліметтерді көресіз. Егер максималды балл алмасаңыз және оны жақсартқыңыз келсе, тапсырмалардың қайсысы дұрыс орындалмағанын қарап, оны қайтадан орындаңыз. Ал егер максималды балл жинасаңыз, құттықтаймыз. Бәрін дұрыс жасап, өзіңіз үшін бәрін дұрыс түсіндіңіз және Amazon EFS сервисі туралы толық түсінік алдыңыз деп үміттенемін. Сондай-ақ, зертханалық жұмыстан дұрыс шығуды ұмытпаңыз. Бұл әрекетті орындау үшін End lab батырмасын басыңыз, хабарламадағы Yes батырмасын басу арқылы аяқтағымыз келетінін растауымыз керек және зертханалық жұмыстың парақшасын жабуға болатындығы туралы хабарлама шыққанша қалқымалы терезеде күтуіміз керек. Осымен зертханалық кіріспе сабағымыз аяқталды. Назар аударғаныңызға рахмет! Келесі белсенділіктерде кездескенше!