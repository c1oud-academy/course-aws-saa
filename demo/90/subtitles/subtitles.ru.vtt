WEBVTT

00:00:00.000 --> 00:00:06.000
Добрый день, уважаемые студенты!
Я рад вас видеть на очередном Демо сессии.

00:00:06.000 --> 00:00:11.271
Тема сегодняшнего Демо – это
разбор функционала автоматических

00:00:11.295 --> 00:00:17.000
бэкапов и read-реплик у сервиса 
Amazon RDS. Итак, давайте начнем.

00:00:17.000 --> 00:00:22.000
Начинаем мы это Демо с основной
страницы AWS Management Console.

00:00:22.000 --> 00:00:27.000
Теперь воспользуемся строкой
поиска сервисов и начнем вводить RDS.

00:00:27.000 --> 00:00:30.000
Первая ссылка – это та
ссылка, которая нам нужна.

00:00:30.000 --> 00:00:36.765
Как только мы оказываемся на основной
странице сервиса Amazon RDS, у нас есть

00:00:36.789 --> 00:00:44.000
две различные кнопки для создания инстанса
 RDS. Мы можем нажать на любую из них.

00:00:44.000 --> 00:00:51.000
Нас перенаправят на страницу с
входными данными для создания инстанса.

00:00:51.000 --> 00:00:57.000
Давайте выберем опцию Standard
Create и как движок выберем MySQL.

00:00:57.000 --> 00:01:05.000
Далее есть опция выбрать MySQL Community. В 
данном случае это единственный возможный вариант.

00:01:05.000 --> 00:01:12.000
Для других движков, возможно, есть несколько
вариантов. Остальные опции оставляем по умолчанию.

00:01:12.000 --> 00:01:21.000
Как Template выберем Free Tier, чтобы создать
этот инстанс в рамках Free Tier на 12 месяцев.

00:01:21.000 --> 00:01:27.000
Availability и Durability сразу
установилась опция и стало недоступны.

00:01:27.000 --> 00:01:34.000
Мы создаем единственный
инстанс без опции Multi-AZ.

00:01:34.000 --> 00:01:40.000
Как DB instance identifier
укажем c1oud-academy-demo-rds.

00:01:40.000 --> 00:01:48.000
Остальные входные данные оставляем по 
умолчанию. Как пароль укажем adminadmin.

00:01:48.000 --> 00:01:53.000
Мы этот инстанс удалим после Демо,
поэтому может быть любой пароль.

00:01:53.000 --> 00:01:58.000
Как тип инстанса
выберем Burstable classes.

00:01:58.000 --> 00:02:03.000
Оно будет выбрано по умолчанию,
а также будет выбран тип t3.micro.

00:02:03.000 --> 00:02:07.000
Это тот тип инстанса, который
доступен в рамках Free Tier.

00:02:07.000 --> 00:02:11.000
Для целей Демо этого
более чем достаточно.

00:02:11.000 --> 00:02:19.000
Для Storage по умолчанию будет 
введено 200 ГБ. 200 ГБ это очень много.

00:02:19.000 --> 00:02:29.000
Для целей Демо достаточно указать 20 ГБ. Это 
минимальное значение, которое мы можем указать.

00:02:29.000 --> 00:02:41.000
Все другие значения оставляем по умолчанию. Как VPC
мы выбираем VPC созданный ранее на предыдущем Демо.

00:02:41.000 --> 00:02:45.000
Как Security group выбираем
существующий дефолтовый.

00:02:45.000 --> 00:02:53.000
Далее как Availability zone необходимо
выбрать ту, на которой у нас активирован VPC.

00:02:53.000 --> 00:02:59.000
В нашем случае это us-east-1a. Все оставшиеся 
значения оставляем по умолчанию.

00:02:59.000 --> 00:03:03.488
Для секции Enhanced monitoring
необходимо флажок убрать,

00:03:03.512 --> 00:03:08.000
для того, чтобы инстанс
базы данных создался быстрее.

00:03:08.000 --> 00:03:13.000
Этот функционал мы не рассматриваем в
рамках Демо, поэтому мы можем его отключить.

00:03:13.000 --> 00:03:21.000
Прокручиваем в самый низ и мы видим здесь
информацию по примерной стоимости этого инстанса.

00:03:21.000 --> 00:03:28.000
Но так как эта настройка попадает в рамках
Free Tier, ничего конкретного здесь не сказано.

00:03:28.000 --> 00:03:33.488
В случае, когда вы будете создавать
инстанс, не входящий во Free Tier, у вас

00:03:33.512 --> 00:03:39.000
будет разбивка отдельная за инстанс
баз данных, отдельная за storage хранения.

00:03:39.000 --> 00:03:46.000
И вы увидите итоговую сумму к оплате в
месяц на конкретный инстанс баз данных.

00:03:46.000 --> 00:03:52.274
Отлично, мы ввели все необходимые настройки.
Необходимо нажать на кнопку Create Database,

00:03:52.298 --> 00:03:59.000
чтобы начать процесс создания базы данных. Оно 
займет некоторое время, от двух до трех минут.

00:03:59.000 --> 00:04:07.000
Необходимо на странице со списком баз данных
нажимать на кнопку Refresh, либо обновлять страницу.

00:04:07.000 --> 00:04:15.488
Через некоторое время статус поменяется на
Available и мы можем нажать на название баз

00:04:15.512 --> 00:04:25.000
данных, чтобы открыть основную страницу этого
инстанса и посмотреть детали нашей базы данных.

00:04:25.000 --> 00:04:29.188
Как только мы оказываемся на
основной странице нашей базы

00:04:29.212 --> 00:04:34.000
данных, мы можем здесь найти
любую необходимую нам информацию.

00:04:34.000 --> 00:04:41.000
В самом верху выведена самая основная
информация, это имя нашей базы данных.

00:04:41.000 --> 00:04:47.000
В нашем случае это c1oud-academy-demo-rds.
Далее как Role мы видим, что это Instance.

00:04:47.000 --> 00:04:52.000
Есть еще опция Cluster, когда поднимаются
несколько инстансов и работают совместно.

00:04:52.000 --> 00:04:59.488
Мы видим также нагрузку на CPU, количество
connections, так как сейчас нет connections, так

00:04:59.512 --> 00:05:07.000
и написано 0 connections. Status - Available.
Видим информацию о движке, это MySQL Community.

00:05:07.000 --> 00:05:17.000
Class - это db.t3.micro и информация о Availability 
зоне, в которой находится база данных.

00:05:17.000 --> 00:05:26.000
В нашем случае, это us-east-1a. Ниже есть
несколько вкладок, сгруппированная информация.

00:05:26.000 --> 00:05:31.191
Первый - это Connectivity and Security.
Здесь вы видите информацию об Endpoint

00:05:31.215 --> 00:05:36.000
and Port, используя который мы можем
подключаться к нашей базе данных.

00:05:36.000 --> 00:05:40.000
Мы будем это делать в рамках
наших лабораторных работ.

00:05:40.000 --> 00:05:47.000
Далее есть информация по Networking. Это в 
какой VPC находится, к какому Subnet относится.

00:05:47.000 --> 00:05:54.000
Информация по безопасности.
Есть ссылка на Security группу.

00:05:54.000 --> 00:06:01.000
Мы видим также отдельно вынесено,
доступна эта база публично или нет и так далее.

00:06:01.000 --> 00:06:10.000
Если мы откроем вторую вкладку Monitoring, мы также
видим, у нас есть более шести страниц с дешбордами.

00:06:10.000 --> 00:06:15.000
Каждый дешборд показывает определенную 
метрику. Давайте посмотрим на первые два.

00:06:15.000 --> 00:06:20.000
Это CPU Utilization, то есть какая
нагрузка идет на наши процессоры.

00:06:20.000 --> 00:06:25.114
Вы видите, что недавно эта база
данных была создана и в момент

00:06:25.138 --> 00:06:30.000
включения, когда база
поднималась, была нагрузка на CPU.

00:06:30.000 --> 00:06:35.488
После этого, так как эта база
данных нигде не используется,

00:06:35.512 --> 00:06:41.000
не утилизируется, то нагрузка
на нее минимальна, менее 5%.

00:06:41.000 --> 00:06:47.189
Если вы посмотрите на количество подключений,
то с момента запуска не было ни одного

00:06:47.213 --> 00:06:54.000
подключения и метрика показывает, что на
текущий момент 0 подключений к этой базе данных.

00:06:54.000 --> 00:07:01.000
Третья вкладка - Logs and Events.
Здесь мы можем настраивать CloudWatch alarms.

00:07:01.000 --> 00:07:06.988
Также вы видите секцию Recent Events.
Это все события, которые произошли с

00:07:07.012 --> 00:07:13.000
этим инстансом баз данных. Вы видите 
время, когда произошло и какое событие.

00:07:13.000 --> 00:07:23.000
Мы видим, что оно поднялось, инстанс создался,
произошел автоматический бэкап нашего инстанса.

00:07:23.000 --> 00:07:31.000
И также есть события, что бэкап был успешно 
создан. Ниже есть секция с логами.

00:07:31.000 --> 00:07:35.000
Здесь сохраняются все
логи с привязкой ко времени.

00:07:35.000 --> 00:07:40.000
И вы можете на любой
интересующий вас день скачать логи.

00:07:40.000 --> 00:07:44.000
Есть различные виды логов.
О них мы поговорим чуть позже.

00:07:44.000 --> 00:07:48.844
У вас есть возможность
выбрать любой лог-файл, его

00:07:48.868 --> 00:07:55.000
посмотреть здесь в AWS
Management Console, либо его скачать.

00:07:55.000 --> 00:08:02.000
Следующая вкладка - это Configuration. Здесь 
мы видим информацию по железу, по движку.

00:08:02.000 --> 00:08:09.000
Из основных это вы видите
версию движка 8.0.28.

00:08:09.000 --> 00:08:14.000
Также видите, что у нас есть ARN,
который мы можем скопировать.

00:08:14.000 --> 00:08:20.000
Информация о том, когда
база данных была создана.

00:08:20.000 --> 00:08:25.000
Мы видим также информацию,
какой тип инстанса у нас, t3.micro.

00:08:25.000 --> 00:08:32.000
Количество ядер процессора - 2.
Количество оперативной памяти - 1 ГБ.

00:08:32.000 --> 00:08:37.000
Также видим информацию, что
основной пользователь называется admin.

00:08:37.000 --> 00:08:48.000
Multi-AZ функционал не включен. Шифрование 
включено. Мы используем AWS KMS key сервиса RDS.

00:08:48.000 --> 00:08:52.000
У нас storage это General
Purpose SSD на 20 гигабайтов.

00:08:52.000 --> 00:09:00.000
То есть вся необходимая информация
может быть найдена в AWS Management Console.

00:09:00.000 --> 00:09:03.000
Следующая вкладка - это
Maintenance and Backups.

00:09:03.000 --> 00:09:07.000
Здесь мы видим, что есть отдельная
секция maintenance, она включена.

00:09:07.000 --> 00:09:16.000
Она говорит о том, что мы можем указать
некоторый промежуток времени, расписание.

00:09:16.000 --> 00:09:23.198
И в рамках этого времени AWS самостоятельно
будет устанавливать обновление базы данных,

00:09:23.222 --> 00:09:30.000
патчи безопасности и так далее.
Это относится только к minor версии базы данных.

00:09:30.000 --> 00:09:36.488
Если мы говорим про major версию, то это
очень большое обновление, ее нужно будет

00:09:36.512 --> 00:09:43.000
проделывать отдельно. Здесь только
информация про апгрейд minor версий баз данных.

00:09:43.000 --> 00:09:49.000
Также мы видим в следующей секции
Pending maintenance ни одной записи.

00:09:49.000 --> 00:09:55.000
Это говорит о том, что мы сейчас используем
самую последнюю версию движка MySQL.

00:09:55.000 --> 00:09:59.000
Следующая секция -
это Backup and Snapshots.

00:09:59.000 --> 00:10:06.000
В секции Backup информация о
том включена ли у нас бэкапирование.

00:10:06.000 --> 00:10:12.000
Также информация когда,
как часто происходят бэкапы.

00:10:12.000 --> 00:10:18.000
И в секции Snapshots мы можем увидеть все
автоматически вручную созданные снапшоты.

00:10:18.000 --> 00:10:22.488
Сейчас у нас один единственный
снапшот, который был создан в момент

00:10:22.512 --> 00:10:27.000
создания базы данных, на который
мы в любой момент можем откатиться.

00:10:27.000 --> 00:10:33.628
Если вам необходимо изменить некоторые
настройки, в том числе и настройки расписания

00:10:33.652 --> 00:10:41.000
бэкапов, то вы это можете сделать используя
кнопку Modify в верхней правой части страницы.

00:10:41.000 --> 00:10:48.000
Откроется очень похожая страница, которую
мы вводили ранее при создании базы данных.

00:10:48.000 --> 00:10:51.939
И вам необходимо в случае
бэкапов спозиционироваться на

00:10:51.963 --> 00:10:57.000
соответствующей секции и ввести
необходимые для вас входные данные.

00:10:57.000 --> 00:11:01.000
Здесь вы видите мы можем
указать частоту создания бэкапов.

00:11:01.000 --> 00:11:05.000
На текущий момент это 7, то есть
каждые 7 дней мы создаем бэкап.

00:11:05.000 --> 00:11:16.000
Также мы видим, что у нас настроено временное
окно, когда может происходить создание бэкапов.

00:11:16.000 --> 00:11:22.585
Создание бэкапа не требует остановки
баз данных, но в момент создания

00:11:22.609 --> 00:11:29.000
вы можете почувствовать некоторую
замедленную работу баз данных.

00:11:29.000 --> 00:11:35.116
То есть создание бэкапов также дает
нагрузку на железо и не рекомендуется

00:11:35.140 --> 00:11:41.000
выставлять временное окно в то
время, когда у вас пиковые нагрузки.

00:11:41.000 --> 00:11:48.000
Здесь вы можете выбрать время начала,
а также длительность временного окна.

00:11:48.000 --> 00:11:53.988
Как только вы введете изменения,
вы увидите в соответствующей секции

00:11:54.012 --> 00:12:00.000
Summary of modifications все детали
того, какие изменения произошли.

00:12:00.000 --> 00:12:04.188
На примере изменения настроек
бэкапов мы видим, что у нас

00:12:04.212 --> 00:12:09.000
поменялся Backup window с
текущего значения на новое значение.

00:12:09.000 --> 00:12:14.000
И у нас есть два варианта
применения этих изменений.

00:12:14.000 --> 00:12:19.625
Первый вариант - это дождаться
следующего maintenance window, когда

00:12:19.649 --> 00:12:25.018
мы можем устанавливать минорные
версии обновления движка, либо

00:12:25.042 --> 00:12:30.791
использовать опцию Apply immediately,
что может быть нежелательно в

00:12:30.815 --> 00:12:37.000
production среде, но можно для dev
environment, чтобы не терять время.

00:12:37.000 --> 00:12:44.988
И так как мы знаем, что ничего критического не
произойдет, если мы применим изменения сразу,

00:12:45.012 --> 00:12:53.000
то мы можем воспользоваться опцией Apply
immediately и нажать на кнопку Modify DB instance.

00:12:53.000 --> 00:13:00.000
Мы с вами переходим ко второй части нашего
сегодняшнего Демо и будем создавать read replica.

00:13:00.000 --> 00:13:03.988
Для этого необходимо в верхней
правой части нажать на кнопку

00:13:04.012 --> 00:13:08.000
Actions в выпадающем списке
выбрать опцию Create read replica.

00:13:08.000 --> 00:13:16.000
Нас направит на такую же страницу для ввода
входных данных, отличается только первая секция.

00:13:16.000 --> 00:13:22.488
Здесь необходимо выбрать
основную базу данных, а также ввести

00:13:22.512 --> 00:13:29.000
название инстанса баз данных,
который является read replica.

00:13:29.000 --> 00:13:33.527
Все остальные настройки, они
точно такие же, как у основной

00:13:33.551 --> 00:13:38.000
базы данных, при необходимости
вы можете ввести правки.

00:13:38.000 --> 00:13:42.525
В самом конце будет кнопка
Create read replica, нам необходимо

00:13:42.549 --> 00:13:47.000
будет ее нажать и начнется
создание инстанса read реплики.

00:13:47.000 --> 00:13:53.988
Также вы увидите, что статус для основной
базы данных поменялся на Modifying, так как она

00:13:54.012 --> 00:14:01.000
уже становится кластером, у нас уже в кластере 
два инстанса, один Primary, другой Replica.

00:14:01.000 --> 00:14:07.000
Также вы в столбце Role видите,
что они соответствующе отмечены.

00:14:07.000 --> 00:14:12.488
Через некоторое время оба инстанса
переходят в состояние Available, давайте

00:14:12.512 --> 00:14:18.000
теперь выберем по очереди каждую
базу данных и посмотрим некоторые детали.

00:14:18.000 --> 00:14:23.488
Если вы выберете основную базу
данных, то Endpoint не поменялся, остается

00:14:23.512 --> 00:14:29.000
таким же, вы можете его использовать
для операции чтения, так и для записи.

00:14:29.000 --> 00:14:32.961
Если вы прокрутите чуть
ниже, отдельно есть секция

00:14:32.985 --> 00:14:38.000
Replication, где находятся
два инстанса, основной и replica.

00:14:38.000 --> 00:14:43.242
Также видите, что для реплики в
столбце Replication state указано

00:14:43.266 --> 00:14:49.000
Replicating, то есть он активирован
и репликация также активирована.

00:14:49.000 --> 00:14:56.988
Если мы выберем Instance read replica,
то в секции Endpoint мы видим, что URL

00:14:57.012 --> 00:15:05.000
отличается, таким образом вы можете ее
использовать для ваших операций чтения.

00:15:05.000 --> 00:15:12.000
И нагрузка уже пойдет на read replica и вы таким
образом сможете разгрузить вашу основную базу данных.

00:15:12.000 --> 00:15:17.988
На этом мы добрались до конца нашей
сегодняшней сессии. Я очень надеюсь,

00:15:18.012 --> 00:15:24.000
что вы получили более полное
представление о работе сервиса Amazon RDS.

00:15:24.000 --> 00:15:29.000
Спасибо за внимание, увидимся с
вами на следующих наших активностях.