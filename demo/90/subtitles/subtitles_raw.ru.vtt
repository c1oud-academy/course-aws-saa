WEBVTT

00:00:00.000 --> 00:00:03.000
Добрый день, уважаемые студенты!

00:00:03.000 --> 00:00:06.000
Я рад вас видеть на очередном демо.

00:00:06.000 --> 00:00:11.000
Тема сегодняшнего демо – это разбор функционала автоматических бэкапов

00:00:11.000 --> 00:00:14.000
и read-реплик у сервиса Amazon RDS.

00:00:14.000 --> 00:00:17.000
Итак, давайте начнем.

00:00:17.000 --> 00:00:22.000
Начинаем мы это демо с основной страницы AWS Management Console.

00:00:22.000 --> 00:00:27.000
Теперь воспользуемся строкой поиска сервисов и начнем вводить RDS.

00:00:27.000 --> 00:00:30.000
Первая ссылка – это та ссылка, которая нам нужна.

00:00:30.000 --> 00:00:33.000
Как только мы оказываемся на основной странице сервиса Amazon RDS,

00:00:33.000 --> 00:00:41.000
у нас есть две различные кнопки для создания инстенса RDS.

00:00:41.000 --> 00:00:44.000
Мы можем нажать любую из них.

00:00:44.000 --> 00:00:51.000
Нас перенаправят на страницу с входными данными для создания инстенса.

00:00:51.000 --> 00:00:57.000
Давайте выберем опцию Standard Create и как движок выберем MySQL.

00:00:57.000 --> 00:01:02.000
Далее у нас есть опция выбрать MySQL Community.

00:01:02.000 --> 00:01:05.000
В данном случае это единственный возможный вариант.

00:01:05.000 --> 00:01:09.000
Для других движков, возможно, есть несколько вариантов.

00:01:09.000 --> 00:01:12.000
Остальные опции оставляем по умолчанию.

00:01:12.000 --> 00:01:21.000
Как template выберем Free Tier, чтобы создать этот инстенс в рамках Free Tier на 12 месяцев.

00:01:21.000 --> 00:01:27.000
Availability и Durability сразу установились опция и стало недоступны.

00:01:27.000 --> 00:01:34.000
Мы создаем единственный инстенс без опции Multi-AZ.

00:01:34.000 --> 00:01:40.000
Как тебе инстенс Identifier укажем Cloud Academy demo RDS.

00:01:40.000 --> 00:01:45.000
Остальные входные данные оставляем по умолчанию.

00:01:45.000 --> 00:01:48.000
Как пароль укажем admin-admin.

00:01:48.000 --> 00:01:53.000
Мы этот инстенс удалим после демо, поэтому может быть любой пароль.

00:01:53.000 --> 00:01:58.000
Как тип инстенса выберем burstable classes.

00:01:58.000 --> 00:02:03.000
Оно будет выбрано по умолчанию, а также будет выбран тип T3-MICRO.

00:02:03.000 --> 00:02:07.000
Это тот тип инстенса, который доступен в рамках Free Tier.

00:02:07.000 --> 00:02:11.000
Для целей демо этого более чем достаточно.

00:02:11.000 --> 00:02:15.000
Для storage по умолчанию будет введено 200 ГБ.

00:02:15.000 --> 00:02:19.000
200 ГБ это очень много.

00:02:19.000 --> 00:02:23.000
Для целей демо достаточно указать 20 ГБ.

00:02:23.000 --> 00:02:29.000
Это минимальное значение, которым мы можем указать.

00:02:29.000 --> 00:02:32.000
Все другие значения оставляем по умолчанию.

00:02:32.000 --> 00:02:41.000
Как VPC мы выбираем VPC созданный ранее на предыдущем демо.

00:02:41.000 --> 00:02:45.000
Как security group выбираем существующий дефолтовый.

00:02:45.000 --> 00:02:53.000
Далее как availability zone необходимо выбрать ту, на которой у нас активирован VPC.

00:02:53.000 --> 00:02:56.000
В нашем случае это USE1A.

00:02:56.000 --> 00:02:59.000
Все оставшиеся значения оставляем по умолчанию.

00:02:59.000 --> 00:03:04.000
Для секции enhanced monitoring необходимо флажок убрать.

00:03:04.000 --> 00:03:08.000
Для того, чтобы инстанс базы данных создался быстрее.

00:03:08.000 --> 00:03:13.000
Этот функционал мы не рассматриваем в рамках демо, поэтому мы можем его отключить.

00:03:13.000 --> 00:03:21.000
Прокручиваем самый низ и мы видим здесь информацию по примерно стоимости этого инстанца.

00:03:21.000 --> 00:03:28.000
Но так как эта настройка подпадает в рамках Free Tier, ничего конкретного здесь не сказано.

00:03:28.000 --> 00:03:39.000
В случае, когда вы будете создавать инстанс, не входящий во Free Tier, у вас будет разбивка отдельная за инстанс баз данных, отдельная за storage хранения.

00:03:39.000 --> 00:03:46.000
И вы увидите итоговую сумму к оплате в месяц на конкретный инстанс баз данных.

00:03:46.000 --> 00:03:49.000
Отлично, мы закончили и ввели все необходимые настройки.

00:03:49.000 --> 00:03:55.000
Сейчас необходимо нажать на кнопку Create Database, чтобы начать процесс создания баз данных.

00:03:55.000 --> 00:03:59.000
Оно займет некоторое время, от двух до трех минут.

00:03:59.000 --> 00:04:07.000
Необходимо будет на странице со списком баз данных нажать на кнопку Refresh, либо обновлять страницу.

00:04:07.000 --> 00:04:16.000
Через некоторое время статус поменяется на Available и мы можем нажать на название баз данных,

00:04:16.000 --> 00:04:25.000
чтобы провалиться на основную страницу этого инстанца и посмотреть детали нашей базы данных.

00:04:25.000 --> 00:04:34.000
Как только мы оказываемся на основной странице нашей базы данных, мы можем здесь найти любую необходимую нам информацию.

00:04:34.000 --> 00:04:41.000
В самом верху выведена самая основная информация, это имя нашей базы данных.

00:04:41.000 --> 00:04:44.000
В нашем случае это Cloud Academy Demo RDS.

00:04:44.000 --> 00:04:47.000
Далее как роль мы видим, что это Инстанс.

00:04:47.000 --> 00:04:52.000
Есть еще опция Cluster, когда поднимаются несколько инстансов и работают совместно.

00:04:52.000 --> 00:04:56.000
Мы видим также нагрузку на CPU.

00:04:56.000 --> 00:05:02.000
Видим количество коннекшенов, так как сейчас нет коннекшенов, так и написано 0 connections.

00:05:02.000 --> 00:05:04.000
Status Available.

00:05:04.000 --> 00:05:07.000
Видим информацию о движке, это MySQL Community.

00:05:07.000 --> 00:05:17.000
Class это T3 Micro и информация о Availability зоне, в которой находится база данных.

00:05:17.000 --> 00:05:20.000
В нашем случае это US East 1A.

00:05:20.000 --> 00:05:26.000
Ниже есть несколько вкладок, сгруппированная информация.

00:05:26.000 --> 00:05:28.000
Первый это Connectivity and Security.

00:05:28.000 --> 00:05:36.000
Здесь вы видите информацию о Endpoint и по порту, используя который мы можем подключаться к нашей базе данных.

00:05:36.000 --> 00:05:40.000
Мы будем это делать в рамках наших лабораторных работ.

00:05:40.000 --> 00:05:43.000
Далее есть информация по Networking.

00:05:43.000 --> 00:05:47.000
Это в какой VPC находится, к какому Subnet относится.

00:05:47.000 --> 00:05:51.000
Информация по безопасности.

00:05:51.000 --> 00:05:54.000
Есть ссылка на Security группу.

00:05:54.000 --> 00:06:01.000
Мы видим также отдельно вынесено, доступна эта база публично или нет и так далее.

00:06:01.000 --> 00:06:10.000
Если мы откроем вторую вкладку Monitoring, мы также видим, у нас есть более шести страниц с дешбордами.

00:06:10.000 --> 00:06:13.000
Каждый дешборд показывает определенную метрику.

00:06:13.000 --> 00:06:15.000
Давайте посмотрим на первые два.

00:06:15.000 --> 00:06:20.000
Это CPU Utilization, то есть какая нагрузка идет на наши процессоры.

00:06:20.000 --> 00:06:30.000
Вы видите, что недавно эта база данных была создана и в момент включения, когда база поднималась, была нагрузка на CPU.

00:06:30.000 --> 00:06:41.000
После этого, так как эта база данных нигде не используется, не утилизируется, то нагрузка на нее минимальна, менее 5%.

00:06:41.000 --> 00:06:54.000
Если вы посмотрите на количество подключений, то с момента запуска не было ни одного подключения и метрика показывает, что на текущий момент ноль подключений к этой базе данных.

00:06:54.000 --> 00:06:58.000
Третья вкладка Locks and Events.

00:06:58.000 --> 00:07:01.000
Здесь мы можем настраивать клад-вотч алармы.

00:07:01.000 --> 00:07:04.000
Также вы видите секцию Recent Events.

00:07:04.000 --> 00:07:09.000
Это все события, которые произошли с этим инстанцем баз данных.

00:07:09.000 --> 00:07:13.000
Вы видите время, когда произошло и какое событие.

00:07:13.000 --> 00:07:23.000
Мы видим, что оно поднялось, инстанц создался, произошел автоматический бэкап нашего инстанца.

00:07:23.000 --> 00:07:28.000
И также есть события, что бэкап был успешно создан.

00:07:28.000 --> 00:07:31.000
Ниже есть секция с логами.

00:07:31.000 --> 00:07:35.000
Здесь сохраняются все логи привязки ко времени.

00:07:35.000 --> 00:07:40.000
И вы можете на любой интересующий вас день скачать логи.

00:07:40.000 --> 00:07:42.000
Есть различные виды логов.

00:07:42.000 --> 00:07:44.000
О них мы поговорим чуть позже.

00:07:44.000 --> 00:07:55.000
У вас есть возможность выбрать любой лог-файл, его посмотреть здесь в AWS Management Console либо его скачать.

00:07:55.000 --> 00:07:58.000
Следующая вкладка это Configuration.

00:07:58.000 --> 00:08:02.000
Здесь мы видим информацию по железу, по движку.

00:08:02.000 --> 00:08:09.000
Из основных это вы видите версию движка 8.0.28.

00:08:09.000 --> 00:08:14.000
Также видите, что у нас есть REN, который мы можем скопировать.

00:08:14.000 --> 00:08:20.000
Информация о том, когда база данных была создана.

00:08:20.000 --> 00:08:25.000
Мы видим также информацию, какой тип инстанца у нас, T3 micro.

00:08:25.000 --> 00:08:29.000
Количество ядер процессора 2.

00:08:29.000 --> 00:08:32.000
Количество оперативной памяти 1 гигабайт.

00:08:32.000 --> 00:08:37.000
Также видим информацию, что основной пользователь называется admin.

00:08:37.000 --> 00:08:41.000
Что multi-AZ функционал не включен.

00:08:41.000 --> 00:08:43.000
Шифрование включено.

00:08:43.000 --> 00:08:48.000
Мы используем AWS KMS key сервиса RDS.

00:08:48.000 --> 00:08:52.000
У нас storage это General Purpose SSD на 20 гигабайтов.

00:08:52.000 --> 00:09:00.000
То есть вся необходимая информация, она может быть найдена в AWS Management Console.

00:09:00.000 --> 00:09:03.000
Следующая вкладка это Maintenance and Backups.

00:09:03.000 --> 00:09:07.000
Здесь мы видим, что есть отдельная секция maintenance, она включена.

00:09:07.000 --> 00:09:12.000
Она говорит о том, что мы можем указать некоторый промежуток времени.

00:09:12.000 --> 00:09:16.000
Указать расписание.

00:09:16.000 --> 00:09:23.000
И в рамках этого времени AWS самостоятельно будет устанавливать обновление базы данных.

00:09:23.000 --> 00:09:26.000
Патчи безопасности и так далее.

00:09:26.000 --> 00:09:30.000
Это относится только к минорной версии базы данных.

00:09:30.000 --> 00:09:33.000
Если мы говорим про мажорную версию, то это очень большое обновление.

00:09:33.000 --> 00:09:37.000
Ее нужно будет проделывать отдельно.

00:09:37.000 --> 00:09:43.000
Здесь только информация про апгрейд минорных версий баз данных.

00:09:43.000 --> 00:09:49.000
Также мы видим в следующей секции pending maintenance не одной записи.

00:09:49.000 --> 00:09:55.000
Это говорит о том, что мы сейчас используем самую последнюю версию движка MySQL.

00:09:55.000 --> 00:09:59.000
Следующая секция это Backup and Snapshots.

00:09:59.000 --> 00:10:06.000
В секции Backup информация включена ли у нас выкопирование.

00:10:06.000 --> 00:10:12.000
Также информация когда, как часто происходят бэкапы.

00:10:12.000 --> 00:10:18.000
И в секции Snapshots мы можем увидеть все автоматически вручную созданные бэкапы.

00:10:18.000 --> 00:10:24.000
Сейчас у нас один единственный снапшот, который был создан в момент создания базы данных.

00:10:24.000 --> 00:10:27.000
На который мы в любой момент можем откатиться.

00:10:27.000 --> 00:10:35.000
Если вам необходимо изменить некоторые настройки, в том числе и настройки расписания бэкапов,

00:10:35.000 --> 00:10:41.000
то вы это можете сделать используя кнопку modify в верхней правой части страницы.

00:10:41.000 --> 00:10:48.000
Откроется очень похожая страница, которую мы вводили ранее при создании базы данных.

00:10:48.000 --> 00:10:57.000
И вам необходимо в случае бэкапов спозиционироваться на соответствующую секцию и ввести необходимые для вас входные данные.

00:10:57.000 --> 00:11:01.000
Здесь вы видите мы можем указать частоту создания бэкапов.

00:11:01.000 --> 00:11:05.000
На текущий момент это 7, то есть каждые 7 дней мы создаем бэкап.

00:11:05.000 --> 00:11:16.000
Также мы видим, что у нас настроено временное окно, когда может происходить создание бэкапов.

00:11:16.000 --> 00:11:29.000
Создание бэкапа не требует остановки баз данных, но в момент создания вы можете почувствовать некоторую замедленную работу баз данных.

00:11:29.000 --> 00:11:41.000
То есть создание бэкапов также дает нагрузку на железо и не рекомендуется выставлять временное окно в то время, когда у вас пиковые нагрузки.

00:11:41.000 --> 00:11:48.000
Здесь вы можете выбрать время начала, а также длительность временного окна.

00:11:48.000 --> 00:12:00.000
Как только вы введете изменения, вы увидите в соответствующей секции summary of modification все детали того, какие изменения произошли.

00:12:00.000 --> 00:12:09.000
На примере изменения настроек бэкапов мы видим, что у нас поменялся backup window с текущего значения на новое значение.

00:12:09.000 --> 00:12:14.000
И у нас есть два варианта применения этих изменений.

00:12:14.000 --> 00:12:26.000
Первый вариант это дождаться следующего maintenance window, когда мы можем устанавливать минорные версии обновления движка,

00:12:26.000 --> 00:12:37.000
либо использовать опцию apply immediately, что может быть нежелательно в продакшн среде, но для dev environment, чтобы не терять время.

00:12:37.000 --> 00:12:53.000
И так как мы знаем, что ничего критического не произойдет, если мы применим изменения сразу, то мы можем воспользоваться опцией apply immediately и нажать на кнопку modify db instance.

00:12:53.000 --> 00:13:00.000
Мы с вами переходим ко второй части нашего сегодняшнего демо и будем создавать ретре-плико.

00:13:00.000 --> 00:13:08.000
Для этого необходимо в верхней правой части нажать на кнопку actions в выпадающем списке выбрать опцию create read replica.

00:13:08.000 --> 00:13:16.000
У нас направлено такую же страницу для ввода входных данных, отличается только первая секция.

00:13:16.000 --> 00:13:29.000
Здесь необходимо выбрать основной баз данных, а также ввести название инстенса баз данных, который является read-репликой.

00:13:29.000 --> 00:13:38.000
Все остальные настройки, они точно такие же, как у основной базы данных, при необходимости вы можете ввести правки.

00:13:38.000 --> 00:13:47.000
Сам в конце будет кнопка create read replica, нам необходимо будет ее нажать и начнется создание инстенса read-реплики.

00:13:47.000 --> 00:14:01.000
Также вы увидите, что статус для основной базы данных поменялся на modifying, так как она уже становится кластером, у нас уже в кластере два инстенса, один primary, другой replica.

00:14:01.000 --> 00:14:07.000
Также вы в столбце роль видите, что они соответствующие отмечены.

00:14:07.000 --> 00:14:18.000
Через некоторое время оба инстенса переходят в состояние available, давайте теперь выберем по очереди каждую базу данных и посмотрим некоторые детали.

00:14:18.000 --> 00:14:29.000
Если вы выберете основную базу данных, то endpoint не поменялся, остается таким же, вы можете его использовать для операции чтения, так и для записи.

00:14:29.000 --> 00:14:38.000
Если вы прокрутите чуть ниже, отдельно есть секция replication, где находятся два инстенса, основной и replica.

00:14:38.000 --> 00:14:49.000
Также видите, что для реплики в столбце replication state указано replicating, то есть он активирован и репликация также активирована.

00:14:49.000 --> 00:15:05.000
Если мы выберем instance read replicas, то в секции endpoint мы видим, что URL отличается, таким образом вы можете ее использовать для ваших операций чтения.

00:15:05.000 --> 00:15:12.000
И нагрузка уже пойдет на read replicas и вы таким образом сможете разгрузить вашу основную базу данных.

00:15:12.000 --> 00:15:24.000
На этом мы добрались до конца нашей сегодняшней сессии, я очень надеюсь, что вы получили более полное представление о работе сервиса Amazon RDS.

00:15:24.000 --> 00:15:43.000
Спасибо за внимание, увидимся с вами на следующих наших активностях.