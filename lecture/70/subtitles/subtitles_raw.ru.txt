 Добрый день, уважаемые студенты! Я рад вас всех видеть на очередной лекции. Это продолжение предыдущей темы недели, а именно Compute Layer. Проговорим про сервисы, связанные с вычислениями. Это вторая и заключительная часть. Итак, давайте начнем. В сегодняшней лекции мы разберем оставшиеся две части, связанные с сервисом Amazon EC2. Первая, она относится к существующим моделям оплаты, а вторая часть это про Placement Groups. Это то, как мы можем управлять физическим расположением серверов, которые мы запрашиваем в рамках EC2. Далее мы поближе познакомимся с spot-инстанциями нашей демо-активности и будет у нас лабораторная работа. Это Challenge Lab, в котором вы получите минимальное количество инструкции и по большей части будете самостоятельно решать данную вам задачу. То есть, есть бизнес-задача и вы технически пытаетесь ее решить. Тема лабораторной работы это создание динамического веб-сайта для нашего кафе. Будет отдельные две активности, Lab Intro и Lab Review. Начинаем с вами седьмую секцию. Седьмая, потому что в рамках одной большой темы у нас идет сквозная номерация секции. Сейчас мы поговорим про доступные модели оплаты для сервиса Amazon EC2. Существует пять различных моделей оплаты. Мы сейчас остановимся на каждой из них и подробнее разберем. Самое первое это on-demand instances используется для нагрузок непостоянных, временных или кратковременных. Торификация идет по секундной или по часовой, в зависимости от типа вашего инстанца. Приведу пример. Например вам необходимо произвести некоторые ресурсоемкие расчеты. Вам требуется 100 инстанцев определенного типа на три часа. В сумме 300 часов. Благодаря тому, что троификация идет по часовой либо по секундной, у вас есть возможность эту операцию эти расчеты провести максимально выгодно. Вы даете запрос на API AWS, поднимаете 100 инстанцев, запускаете ваше задание. После того как они отрабатывают вы можете вернуть через сколько-то часов ваши арендованные инстанции обратно и в конце месяца придет счет на оплату только на эти 300 часов для определенного типа инстанца согласно тарифу. Это максимально выгодная модель оплаты в случае если у вас ничего не известно по вашим нагрузкам. Более того вы ничего не оплачиваете наперед, вы оплачиваете только пост фактум то что вы использовали. Следующая модель оплаты это Reserved Instances. Идея в том что вы на один год либо на три года садитесь на договор с AWS о том что вы на этот период арендуете некоторый объем вычислительных мощностей. Таким образом, зная что вы целый год либо три года обязались арендовать и соответственно оплачивать эти инстанции AWS может легче планировать развитие своих дата центров, своей глобальной инфраструктуры и соответственно за эту помощь готова давать значительные скидки. Давайте теперь рассмотрим пример когда есть смысл покупать Reserved Instances. Представим что вы онлайн магазин продаете одежду и в течение дня в обычные дни нагрузка требует 10 EC2 инстанцев рабочих поднятых. Ночью когда все спят тем не менее у вас есть определенная нагрузка и три инстанца всегда задействованы как минимум. Таким образом вы знаете что 24 на 7 как минимум три инстанца всегда у вас работают. Эти три инстанца идеально подходят под модель Reserved Instances так как вы в любом случае оплачиваете эти три инстанца 24 на 7. Если бы это были Reserved Instances, то тогда вы бы еще получили значительные скидки за это. Я бы хотел также здесь отметить такие понятия как Auri, Puri и Nuri. Что же это такое? Это различные варианты оплаты ваших Reserved Instances. Auri это All Up Front Reserved Instances. Идея в том что вы все то что должны оплатить в рамках времени год или три года на указанное количество инстанцев всю сумму оплачиваете сразу. В случае с Puri согласно названию Partial Up Front Reserved Instances вы оплачиваете 50 процентов сразу, а оставшиеся 50 процентов оплачиваете ежемесячно. И самое последнее это Nuri No Up Front Reserved Instances. Идея в том что вы ничего не оплачиваете заранее вы лишь только садитесь на контракт и ежемесячно также как и On Demand Instances оплачиваете выделенный объем вычислительных мощностей. В этом случае минимальная скидка. Максимальная скидка дается в случае если вы выбираете All Up Front Reserved Instances на три года и обратная самая минимальная скидка получается когда вы берете No Up Front Reserved Instances на один год. Третья модель оплаты это Savings Plans. Она относительно новая. Идея в том что вы также садитесь на контракт на один год либо на три года, но есть некоторые особенности работы Savings Plans которые делают ее более гибким решением нежели Reserved Instances. Здесь участвуют такие сервисы как Amazon EC2 AWS Lambda и AWS Fargate. Если вы используете один или несколько этих сервисов то можете посмотреть в сторону Savings Plans. Идея ее в том что вы привязываетесь к соотношению доллар на час. Таким образом есть возможность с легкостью менять типы инстанцев. Что является достаточно хорошим преимуществом при планировании на год либо на три года вперед. Четвертая модель оплаты это Spot Instances. Это та модель оплаты которая дает максимальную скидку до 90 процентов скидки. Идея в том что в больших дата-центрах AWS не всегда все железо утилизируется. То есть используется клиентами AWS. Поэтому они зря простаивают. AWS чтобы они зря не простаивали дает со значительной скидкой вам в использовании. Но есть определенный нюанс. Так как вы запускаете с очень большой скидкой то при необходимости этих инстанцев для on-demand использования вам для каждого инстанца персонально придет за две минуты нотификация о том что через две минуты этот Spot Instances будет отключен. Так как ее передадут другому клиенту в рамках on-demand прайсинга. И соответственно вам нужно в рамках этих двух минут ваши любые работы отключить либо заменить ее на другой тип инстанца. Если подобное поведение инстанцев нормально для вас или вы можете подготовить ваше решение таким образом чтобы не влияло на бизнес то вы можете запускать ваши ввечислительные мощности со значительными скидками. Оплата происходит с по секундной тарификации с минимум 60 секунд для инстанцев Amazon Linux или Ubuntu. Для всех других операционных систем тарификация происходит по часовой и округление происходит к ближайшему часу то есть если вы запустили только что она округлиться до одного часа. Есть также еще одна разновидность Spot это Spot Blocks. Идея ее в том что вы можете запросить некоторое количество инстанцев также со скидкой это не 90 процентов это в районе 40-50 процентов что тоже хорошо вы можете указать конкретное количество времени которое вам необходимо от одного до шести часов после чего они автоматически отключится при необходимости большего времени вам нужно запросить еще раз. В этом случае вы заранее определяете время жизни и эти инстанции не могут быть отключены или затребованы AWS до окончания этого времени но вы также видите что вы не можете 24 на 7 использовать Spot Block инстанции так как по характеру они также считаются кратковременными с небольшой продолжительностью жизни. Идея этих Spot Blocks также заключается в том что есть инстанции которые простаивают и в случае если все инстанции запрошены по другим моделям оплаты то запрос по Spot даст вам ошибку о том что на текущий момент свободных Spot Инстанций нет в наличии поэтому при использовании любых Spot Инстанций будь это Spot Инстанции либо Spot Block вам необходимо планировать дополнительно что делать в случае если эти инстанции недоступны. Следующее и последняя модель оплаты это Dedicated Hosts это тот случай когда вам физически нужно единолично владеть EC2 машиной то есть нельзя чтобы другие AWS клиенты совместно использовали физически один сервер в дата центре AWS. Какие же это требования могут быть? Самые популярные это требования лицензирования если вы используете какое-то уникальное ПО также это могут быть регуляторные требования либо любые другие требования в рамках той сферы в которой вы работаете. Вы видите что даже в этом случае AWS предлагает от себя решение это Dedicated Hosts так как при реализации Dedicated Hosts AWS на единицу пространства в дата центре располагает менее мощные инстанции чем она могла бы расположить и поделить виртуально между несколькими AWS клиентами то очевидно модель оплаты Dedicated Hosts она дороже чем On Demand Инстанции но у некоторых компаний есть эти требования и она никак не может ее по-другому переиграть и для того чтобы не нарушать свои требования она вынуждена использовать Dedicated Hosts. В рамках Dedicated Instances есть два варианта это Dedicated Instances и Dedicated Hosts. Dedicated Hosts отличается тем что предоставляет больше контроль над вашими инстанциями и более того с Dedicated Hosts вы можете использовать модель оплаты Reserved Instances. В Dedicated Instances этой возможности нет но тем не менее она также предоставляет вам изолированный единоличный доступ к серверам AWS. Для достижения максимальной выгоды использования сервиса Amazon EC2 рекомендуется комбинировать модели оплаты. Для тех ваших нагрузок которые не меняются 24 на 7 и постоянные рекомендуется использовать Reserved Instances или Savings Plans. Для других нагрузок которые можно запланировать которые не часто появляются например это предпраздничные дни когда люди больше делают покупок в этом случае на все сайты которые продают одежду, бытовую технику и так далее растет нагрузка и все компании знают что эта нагрузка там растет на определенный процент. Зная это на все нагрузки поверх которые временные кратковременные вы можете запустить с On Demand моделью оплаты. После того как пройдет эта нагрузка вы останетесь с теми инстанциями которые взяли с большой скидкой через Reserved Instances или Savings Plans. Есть также другой тип расходов которые можно легко прервать, которые можно легко восстановить. Для таких нагрузок рекомендуется использовать Spot Instances. На этом мы подробнее разобрали различные модели оплаты в рамках сервиса Amazon EC2. Мы двигаемся к следующей секции. Мы с вами добрались до восьмой секции и сейчас поговорим про Placement Groups. Это та возможность которая дает вам контроль определять как будут расположены физически ваши инстанции в Availability зоне. Существует три различных стратегии. Cluster это одна крайность, Partition, Strategy это некоторая золотая середина и Spread это другая крайность расположения ваших инстанций. Давайте подробнее остановимся на каждой стратегии. Итак Cluster Placement Group это та стратегия которая помогает расположить ваши инстанции максимально близко друг к другу. В этом случае у них общая сеть по сети они расположены максимально близко таким образом и канал шире и задержки при передаче данных минимальны. Для некоторых типов приложения это необходимо поэтому вы будете использовать Cluster Placement Group. Нюанс который нужно помнить это некоторые компоненты инфраструктуры дата центра они будут общими для всех этих инстанций и в случае выхода из строя этого железа часть или все ваши инстанции могут быть недоступными. В этом случае вам нужно будет поднимать эти инстанции в другой availability зоне. Следующая стратегия это Partition Placement Group является некоторой золотой середины. Идея в том что мы по сравнению с предыдущей стратегией пытаемся распределить риск того что приложение станет недоступным из-за какого-то общего железа и определяем некоторое количество партий и в каждой партий находятся определенное количество инстанций. Более того эти партий они могут быть расположены в нескольких availability зонах таким образом часть инстанцев могут эффективно взаимодействовать между собой так как находятся близко. Но есть также другая партий которая никак физически не связана с другой партий и в случае падения одной партий всех ее инстанцев или части другие партий не пострадают. Следующая стратегия это Spread Placement Group это другая крайность расположения ваших инстанцев. Идея ее в том что каждый инстанц строго располагается в отдельной стойке серверов таким образом поломка определенного железа она маловероятно повлияет на несколько инстанцев. Эта placement группа также может быть распространена на несколько availability зон. Таким образом мы завершаем последнюю нашу секцию и мы разобрали какие стратегии распределения инстанцев в рамках availability зон существует и в каких случаях нужно использовать тот или ту или иную стратегию. Перед тем как мы закончим сегодняшнюю лекцию я бы хотел пару слов сказать о Challenge Lab. В рамках лабораторной работы мы будем создавать динамический веб-сайт для нашего кафе. Согласно кейсу после запуска статического веб-сайта все было отлично все клиенты были рады теперь они попросили добавить возможность онлайн заказа на нашем веб-сайте. Это требует некоторых серьезных доработок так как до этого был сайт статический сейчас он должен быть динамический внутри какая-то логика и требует написание некоторого приложения. В рамках лабораторной работы само приложение мы писать не будем она предварительно была приготовлена для нас но все что касается инфраструктуру VWS мы будем проделывать вместе с вами. Вы здесь видите краткое описание семи заданий которые мы будем выполнять в рамках Challenge Lab а также видите ту инфраструктуру которую мы в итоге получим. Если вкратце то у нас будет instance приложение запущены на EC2 сервере будет отдельная база данных также мы будем создавать дополнительные ресурсы такие как VPC, Public Subnet, Security группы для успешного запуска нашего приложения и вся эта инфраструктура находится на одном регионе. В рамках задания нам также нужно будет склонировать нашу инфраструктуру в другом регионе и в будущем согласно кейсу мы будем использовать первый регион как Dev environment, а второй регион как Prot environment. Таким образом на Dev environment будем разрабатывать новый функционал, тестировать и после передавать на Prot environment. На Prot environment будет запускаться самая корректная актуальная версия сайта также будет отдельно храниться база реальных клиентов пекарни. На этом мы завершаем серию лекций посвященных вычислениям. Мы достаточно подробно разобрали сервис Amazon EC2 это один из самых основных сервисов связанных с вычислениями. Надеюсь вы получили более полное представление. На этом слайде вы видите полезные ссылки отдельно ссылку вбивать не нужно достаточно ключевые слова которые вы видите вбить в поисковик и нужная страница будет в выдаче первая нерекламная ссылка. На этом мы завершаем нашу сегодняшнюю лекцию. Спасибо за внимание увидимся с вами на следующих наших активностях.
